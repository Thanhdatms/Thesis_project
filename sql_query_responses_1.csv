question,sql,answer,friendly_response,hardness_level
"Which products have an average review rating of 8 or higher, and what is their average rating?","SELECT p.product_id,
       p.product_name,
       AVG(r.review_rating) AS avg_rating
FROM products AS p
JOIN reviews AS r
    ON r.review_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING AVG(r.review_rating) >= 8
ORDER BY avg_rating DESC;","[{'product_id': 24, 'product_name': 'Comic', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 164, 'product_name': 'Lantern', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 55, 'product_name': 'Hair Dryer', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 38, 'product_name': 'Tennis Racket', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 105, 'product_name': 'Baby Monitor', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 174, 'product_name': 'Respirator', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 182, 'product_name': 'Anchors', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 92, 'product_name': 'Blender', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 154, 'product_name': 'Thermostat', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 129, 'product_name': 'Smartphone', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 19, 'product_name': 'Jeans', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 199, 'product_name': 'Product 199', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 192, 'product_name': 'Product 192', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 200, 'product_name': 'Product 200', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 149, 'product_name': 'Monitor Arm', 'avg_rating': Decimal('9.6666666666666667')}, {'product_id': 46, 'product_name': 'Board Game', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 88, 'product_name': 'Tent', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 63, 'product_name': 'Pasta', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 20, 'product_name': 'Socks', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 96, 'product_name': 'Cookware', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 137, 'product_name': 'Switch', 'avg_rating': Decimal('9.3333333333333333')}, {'product_id': 56, 'product_name': 'Car Battery', 'avg_rating': Decimal('9.2500000000000000')}, {'product_id': 150, 'product_name': 'LED Strip', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 75, 'product_name': 'Thermometer', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 99, 'product_name': 'Bed Frame', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 114, 'product_name': 'Handbag', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 106, 'product_name': 'Necklace', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 112, 'product_name': 'Sandals', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 197, 'product_name': 'Product 197', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 42, 'product_name': 'Skateboard', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 130, 'product_name': 'Laptop Stand', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 140, 'product_name': 'Phone Case', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 54, 'product_name': 'Makeup Kit', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 62, 'product_name': 'Snacks', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 136, 'product_name': 'Router', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 90, 'product_name': 'Cooler', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 45, 'product_name': 'Puzzle', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 100, 'product_name': 'Dresser', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 109, 'product_name': 'Earrings', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 2, 'product_name': 'Phone', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 157, 'product_name': 'Fan', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 128, 'product_name': 'Safety Vest', 'avg_rating': Decimal('8.7500000000000000')}, {'product_id': 107, 'product_name': 'Ring', 'avg_rating': Decimal('8.6666666666666667')}, {'product_id': 34, 'product_name': 'Mirror', 'avg_rating': Decimal('8.6666666666666667')}, {'product_id': 48, 'product_name': 'LEGO Set', 'avg_rating': Decimal('8.6666666666666667')}, {'product_id': 8, 'product_name': 'TV', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 9, 'product_name': 'Monitor', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 57, 'product_name': 'Oil Filter', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 31, 'product_name': 'Curtains', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 66, 'product_name': 'Cat Toy', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 41, 'product_name': 'Bike', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 193, 'product_name': 'Product 193', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 78, 'product_name': 'Drum Set', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 49, 'product_name': 'RC Car', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 33, 'product_name': 'Vase', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 4, 'product_name': 'Headphones', 'avg_rating': Decimal('8.3333333333333333')}, {'product_id': 95, 'product_name': 'Knife Set', 'avg_rating': Decimal('8.3333333333333333')}, {'product_id': 10, 'product_name': 'Keyboard', 'avg_rating': Decimal('8.3333333333333333')}, {'product_id': 97, 'product_name': 'Desk', 'avg_rating': Decimal('8.2500000000000000')}, {'product_id': 116, 'product_name': 'Wallet', 'avg_rating': Decimal('8.2000000000000000')}, {'product_id': 21, 'product_name': 'Novel', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 77, 'product_name': 'Microphone', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 191, 'product_name': 'Product 191', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 58, 'product_name': 'Tire', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 177, 'product_name': 'Paintbrush', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 153, 'product_name': 'Doorbell', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 108, 'product_name': 'Bracelet', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 185, 'product_name': 'Product 185', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 152, 'product_name': 'Security Camera', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 101, 'product_name': 'Nightstand', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 16, 'product_name': 'Hat', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 93, 'product_name': 'Toaster', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 67, 'product_name': 'Leash', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 104, 'product_name': 'Car Seat', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 52, 'product_name': 'Shampoo', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 131, 'product_name': 'USB Cable', 'avg_rating': Decimal('8.0000000000000000')}]",,MEDIUM
Which vendors supply more than 5 distinct products?,"SELECT v.vendor_id,
       v.vendor_name,
       COUNT(DISTINCT pv.product_vendor_product_id) AS product_count
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
GROUP BY v.vendor_id, v.vendor_name
HAVING COUNT(DISTINCT pv.product_vendor_product_id) > 5;","[{'vendor_id': 1, 'vendor_name': 'Vendor Corp 1', 'product_count': 8}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2', 'product_count': 7}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3', 'product_count': 6}, {'vendor_id': 4, 'vendor_name': 'Vendor LLC 4', 'product_count': 6}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5', 'product_count': 8}, {'vendor_id': 6, 'vendor_name': 'Vendor LLC 6', 'product_count': 6}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7', 'product_count': 6}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8', 'product_count': 7}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12', 'product_count': 9}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17', 'product_count': 6}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19', 'product_count': 9}, {'vendor_id': 20, 'vendor_name': 'Vendor Enterprises 20', 'product_count': 8}, {'vendor_id': 22, 'vendor_name': 'Vendor Industries 22', 'product_count': 8}, {'vendor_id': 26, 'vendor_name': 'Vendor LLC 26', 'product_count': 7}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30', 'product_count': 9}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36', 'product_count': 7}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39', 'product_count': 10}, {'vendor_id': 40, 'vendor_name': 'Vendor Group 40', 'product_count': 8}, {'vendor_id': 45, 'vendor_name': 'Vendor Industries 45', 'product_count': 8}, {'vendor_id': 47, 'vendor_name': 'Vendor Supply Co 47', 'product_count': 6}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50', 'product_count': 6}]",,HARD
What are the total quantities of each product purchased in delivered orders?,"SELECT p.product_id,
       p.product_name,
       SUM(oi.order_item_quantity) AS total_quantity
FROM order_items AS oi
JOIN orders AS o
    ON oi.order_item_order_id = o.order_id
JOIN products AS p
    ON oi.order_item_product_id = p.product_id
WHERE o.order_status = 'delivered'
GROUP BY p.product_id, p.product_name
ORDER BY total_quantity DESC;","[{'product_id': 33, 'product_name': 'Vase', 'total_quantity': 17}, {'product_id': 90, 'product_name': 'Cooler', 'total_quantity': 15}, {'product_id': 1, 'product_name': 'Laptop', 'total_quantity': 14}, {'product_id': 91, 'product_name': 'Backpack', 'total_quantity': 14}, {'product_id': 162, 'product_name': 'Solar Panel', 'total_quantity': 14}, {'product_id': 56, 'product_name': 'Car Battery', 'total_quantity': 13}, {'product_id': 101, 'product_name': 'Nightstand', 'total_quantity': 13}, {'product_id': 94, 'product_name': 'Coffee Maker', 'total_quantity': 13}, {'product_id': 169, 'product_name': 'Pliers', 'total_quantity': 13}, {'product_id': 42, 'product_name': 'Skateboard', 'total_quantity': 13}, {'product_id': 73, 'product_name': 'Vitamins', 'total_quantity': 12}, {'product_id': 19, 'product_name': 'Jeans', 'total_quantity': 12}, {'product_id': 89, 'product_name': 'Sleeping Bag', 'total_quantity': 12}, {'product_id': 182, 'product_name': 'Anchors', 'total_quantity': 12}, {'product_id': 196, 'product_name': 'Product 196', 'total_quantity': 12}, {'product_id': 46, 'product_name': 'Board Game', 'total_quantity': 11}, {'product_id': 95, 'product_name': 'Knife Set', 'total_quantity': 11}, {'product_id': 155, 'product_name': 'Air Purifier', 'total_quantity': 11}, {'product_id': 200, 'product_name': 'Product 200', 'total_quantity': 11}, {'product_id': 25, 'product_name': 'Journal', 'total_quantity': 11}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'total_quantity': 11}, {'product_id': 157, 'product_name': 'Fan', 'total_quantity': 11}, {'product_id': 79, 'product_name': 'DVD', 'total_quantity': 10}, {'product_id': 53, 'product_name': 'Lotion', 'total_quantity': 10}, {'product_id': 22, 'product_name': 'Textbook', 'total_quantity': 10}, {'product_id': 123, 'product_name': 'Paint Set', 'total_quantity': 10}, {'product_id': 173, 'product_name': 'Ear Protection', 'total_quantity': 10}, {'product_id': 111, 'product_name': 'Boots', 'total_quantity': 10}, {'product_id': 10, 'product_name': 'Keyboard', 'total_quantity': 10}, {'product_id': 96, 'product_name': 'Cookware', 'total_quantity': 10}, {'product_id': 43, 'product_name': 'Helmet', 'total_quantity': 10}, {'product_id': 5, 'product_name': 'Speaker', 'total_quantity': 10}, {'product_id': 179, 'product_name': 'Wood Glue', 'total_quantity': 9}, {'product_id': 75, 'product_name': 'Thermometer', 'total_quantity': 9}, {'product_id': 76, 'product_name': 'Guitar', 'total_quantity': 9}, {'product_id': 47, 'product_name': 'Doll', 'total_quantity': 9}, {'product_id': 31, 'product_name': 'Curtains', 'total_quantity': 9}, {'product_id': 39, 'product_name': 'Yoga Mat', 'total_quantity': 9}, {'product_id': 35, 'product_name': 'Clock', 'total_quantity': 9}, {'product_id': 177, 'product_name': 'Paintbrush', 'total_quantity': 9}, {'product_id': 40, 'product_name': 'Dumbbell', 'total_quantity': 9}, {'product_id': 120, 'product_name': 'Wall Art', 'total_quantity': 9}, {'product_id': 97, 'product_name': 'Desk', 'total_quantity': 9}, {'product_id': 100, 'product_name': 'Dresser', 'total_quantity': 9}, {'product_id': 128, 'product_name': 'Safety Vest', 'total_quantity': 9}, {'product_id': 137, 'product_name': 'Switch', 'total_quantity': 9}, {'product_id': 9, 'product_name': 'Monitor', 'total_quantity': 9}, {'product_id': 154, 'product_name': 'Thermostat', 'total_quantity': 8}, {'product_id': 18, 'product_name': 'Sweater', 'total_quantity': 8}, {'product_id': 21, 'product_name': 'Novel', 'total_quantity': 8}, {'product_id': 109, 'product_name': 'Earrings', 'total_quantity': 8}, {'product_id': 20, 'product_name': 'Socks', 'total_quantity': 8}, {'product_id': 66, 'product_name': 'Cat Toy', 'total_quantity': 8}, {'product_id': 164, 'product_name': 'Lantern', 'total_quantity': 8}, {'product_id': 132, 'product_name': 'Power Bank', 'total_quantity': 8}, {'product_id': 68, 'product_name': 'Pet Bed', 'total_quantity': 8}, {'product_id': 82, 'product_name': 'Console', 'total_quantity': 8}, {'product_id': 57, 'product_name': 'Oil Filter', 'total_quantity': 8}, {'product_id': 41, 'product_name': 'Bike', 'total_quantity': 7}, {'product_id': 8, 'product_name': 'TV', 'total_quantity': 7}, {'product_id': 116, 'product_name': 'Wallet', 'total_quantity': 7}, {'product_id': 69, 'product_name': 'Notebook', 'total_quantity': 7}, {'product_id': 135, 'product_name': 'Webcam', 'total_quantity': 7}, {'product_id': 187, 'product_name': 'Product 187', 'total_quantity': 7}, {'product_id': 77, 'product_name': 'Microphone', 'total_quantity': 7}, {'product_id': 104, 'product_name': 'Car Seat', 'total_quantity': 7}, {'product_id': 4, 'product_name': 'Headphones', 'total_quantity': 7}, {'product_id': 174, 'product_name': 'Respirator', 'total_quantity': 7}, {'product_id': 144, 'product_name': 'RAM', 'total_quantity': 7}, {'product_id': 36, 'product_name': 'Basketball', 'total_quantity': 7}, {'product_id': 167, 'product_name': 'Level', 'total_quantity': 7}, {'product_id': 2, 'product_name': 'Phone', 'total_quantity': 7}, {'product_id': 152, 'product_name': 'Security Camera', 'total_quantity': 7}, {'product_id': 38, 'product_name': 'Tennis Racket', 'total_quantity': 7}, {'product_id': 139, 'product_name': 'Screen Protector', 'total_quantity': 7}, {'product_id': 14, 'product_name': 'Jacket', 'total_quantity': 6}, {'product_id': 102, 'product_name': 'Crib', 'total_quantity': 6}, {'product_id': 186, 'product_name': 'Product 186', 'total_quantity': 6}, {'product_id': 55, 'product_name': 'Hair Dryer', 'total_quantity': 6}, {'product_id': 15, 'product_name': 'Shoes', 'total_quantity': 6}, {'product_id': 115, 'product_name': 'Backpack', 'total_quantity': 6}, {'product_id': 23, 'product_name': 'Magazine', 'total_quantity': 6}, {'product_id': 6, 'product_name': 'Camera', 'total_quantity': 6}, {'product_id': 86, 'product_name': 'Saw', 'total_quantity': 6}, {'product_id': 28, 'product_name': 'Table', 'total_quantity': 6}, {'product_id': 153, 'product_name': 'Doorbell', 'total_quantity': 6}, {'product_id': 183, 'product_name': 'Hinges', 'total_quantity': 6}, {'product_id': 7, 'product_name': 'Watch', 'total_quantity': 6}, {'product_id': 71, 'product_name': 'Stapler', 'total_quantity': 6}, {'product_id': 171, 'product_name': 'Work Gloves', 'total_quantity': 6}, {'product_id': 148, 'product_name': 'Desk Mat', 'total_quantity': 6}, {'product_id': 119, 'product_name': 'Fitness Tracker', 'total_quantity': 6}, {'product_id': 199, 'product_name': 'Product 199', 'total_quantity': 6}, {'product_id': 118, 'product_name': 'Smartwatch', 'total_quantity': 6}, {'product_id': 185, 'product_name': 'Product 185', 'total_quantity': 5}, {'product_id': 26, 'product_name': 'Sofa', 'total_quantity': 5}, {'product_id': 74, 'product_name': 'First Aid Kit', 'total_quantity': 5}, {'product_id': 17, 'product_name': 'Dress', 'total_quantity': 5}, {'product_id': 34, 'product_name': 'Mirror', 'total_quantity': 5}, {'product_id': 113, 'product_name': 'Loafers', 'total_quantity': 5}, {'product_id': 188, 'product_name': 'Product 188', 'total_quantity': 5}, {'product_id': 110, 'product_name': 'Sneakers', 'total_quantity': 5}, {'product_id': 45, 'product_name': 'Puzzle', 'total_quantity': 5}, {'product_id': 134, 'product_name': 'Gaming Mouse', 'total_quantity': 5}, {'product_id': 178, 'product_name': 'Sandpaper', 'total_quantity': 5}, {'product_id': 88, 'product_name': 'Tent', 'total_quantity': 5}, {'product_id': 189, 'product_name': 'Product 189', 'total_quantity': 5}, {'product_id': 11, 'product_name': 'Mouse', 'total_quantity': 5}, {'product_id': 44, 'product_name': 'Action Figure', 'total_quantity': 5}, {'product_id': 62, 'product_name': 'Snacks', 'total_quantity': 5}, {'product_id': 98, 'product_name': 'Bookshelf', 'total_quantity': 5}, {'product_id': 126, 'product_name': 'Wrapping Paper', 'total_quantity': 5}, {'product_id': 58, 'product_name': 'Tire', 'total_quantity': 5}, {'product_id': 60, 'product_name': 'Coffee', 'total_quantity': 5}, {'product_id': 136, 'product_name': 'Router', 'total_quantity': 5}, {'product_id': 129, 'product_name': 'Smartphone', 'total_quantity': 5}, {'product_id': 84, 'product_name': 'Drill', 'total_quantity': 5}, {'product_id': 125, 'product_name': 'Party Decorations', 'total_quantity': 4}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'total_quantity': 4}, {'product_id': 180, 'product_name': 'Nails', 'total_quantity': 4}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'total_quantity': 4}, {'product_id': 172, 'product_name': 'Safety Glasses', 'total_quantity': 4}, {'product_id': 159, 'product_name': 'Extension Cord', 'total_quantity': 4}, {'product_id': 156, 'product_name': 'Humidifier', 'total_quantity': 4}, {'product_id': 190, 'product_name': 'Product 190', 'total_quantity': 4}, {'product_id': 192, 'product_name': 'Product 192', 'total_quantity': 4}, {'product_id': 78, 'product_name': 'Drum Set', 'total_quantity': 4}, {'product_id': 13, 'product_name': 'Pants', 'total_quantity': 4}, {'product_id': 29, 'product_name': 'Lamp', 'total_quantity': 4}, {'product_id': 107, 'product_name': 'Ring', 'total_quantity': 4}, {'product_id': 145, 'product_name': 'SSD', 'total_quantity': 4}, {'product_id': 92, 'product_name': 'Blender', 'total_quantity': 4}, {'product_id': 197, 'product_name': 'Product 197', 'total_quantity': 4}, {'product_id': 163, 'product_name': 'Flashlight', 'total_quantity': 3}, {'product_id': 67, 'product_name': 'Leash', 'total_quantity': 3}, {'product_id': 133, 'product_name': 'External Hard Drive', 'total_quantity': 3}, {'product_id': 103, 'product_name': 'Stroller', 'total_quantity': 3}, {'product_id': 83, 'product_name': 'Controller', 'total_quantity': 3}, {'product_id': 85, 'product_name': 'Hammer', 'total_quantity': 3}, {'product_id': 149, 'product_name': 'Monitor Arm', 'total_quantity': 3}, {'product_id': 106, 'product_name': 'Necklace', 'total_quantity': 3}, {'product_id': 194, 'product_name': 'Product 194', 'total_quantity': 3}, {'product_id': 108, 'product_name': 'Bracelet', 'total_quantity': 3}, {'product_id': 32, 'product_name': 'Plant', 'total_quantity': 3}, {'product_id': 54, 'product_name': 'Makeup Kit', 'total_quantity': 3}, {'product_id': 30, 'product_name': 'Rug', 'total_quantity': 3}, {'product_id': 48, 'product_name': 'LEGO Set', 'total_quantity': 3}, {'product_id': 131, 'product_name': 'USB Cable', 'total_quantity': 3}, {'product_id': 147, 'product_name': 'Mousepad', 'total_quantity': 3}, {'product_id': 193, 'product_name': 'Product 193', 'total_quantity': 3}, {'product_id': 122, 'product_name': 'Canvas', 'total_quantity': 3}, {'product_id': 165, 'product_name': 'Multi-tool', 'total_quantity': 3}, {'product_id': 184, 'product_name': 'Product 184', 'total_quantity': 3}, {'product_id': 105, 'product_name': 'Baby Monitor', 'total_quantity': 3}, {'product_id': 161, 'product_name': 'Battery Pack', 'total_quantity': 3}, {'product_id': 24, 'product_name': 'Comic', 'total_quantity': 2}, {'product_id': 3, 'product_name': 'Tablet', 'total_quantity': 2}, {'product_id': 27, 'product_name': 'Chair', 'total_quantity': 2}, {'product_id': 146, 'product_name': 'Cooling Fan', 'total_quantity': 2}, {'product_id': 61, 'product_name': 'Tea', 'total_quantity': 2}, {'product_id': 158, 'product_name': 'Heater', 'total_quantity': 2}, {'product_id': 117, 'product_name': 'Suitcase', 'total_quantity': 2}, {'product_id': 150, 'product_name': 'LED Strip', 'total_quantity': 2}, {'product_id': 93, 'product_name': 'Toaster', 'total_quantity': 2}, {'product_id': 114, 'product_name': 'Handbag', 'total_quantity': 2}, {'product_id': 112, 'product_name': 'Sandals', 'total_quantity': 2}, {'product_id': 138, 'product_name': 'Cable Organizer', 'total_quantity': 2}, {'product_id': 160, 'product_name': 'Surge Protector', 'total_quantity': 2}, {'product_id': 81, 'product_name': 'Video Game', 'total_quantity': 2}, {'product_id': 16, 'product_name': 'Hat', 'total_quantity': 2}, {'product_id': 72, 'product_name': 'Filing Cabinet', 'total_quantity': 2}, {'product_id': 49, 'product_name': 'RC Car', 'total_quantity': 2}, {'product_id': 191, 'product_name': 'Product 191', 'total_quantity': 1}, {'product_id': 63, 'product_name': 'Pasta', 'total_quantity': 1}, {'product_id': 166, 'product_name': 'Tape Measure', 'total_quantity': 1}, {'product_id': 140, 'product_name': 'Phone Case', 'total_quantity': 1}, {'product_id': 51, 'product_name': 'Perfume', 'total_quantity': 1}, {'product_id': 175, 'product_name': 'Ladder', 'total_quantity': 1}, {'product_id': 50, 'product_name': 'Lipstick', 'total_quantity': 1}, {'product_id': 151, 'product_name': 'Smart Bulb', 'total_quantity': 1}, {'product_id': 176, 'product_name': 'Paint Roller', 'total_quantity': 1}, {'product_id': 168, 'product_name': 'Wrench Set', 'total_quantity': 1}]",,HARD
Which users have placed more than 3 orders that include at least one applied coupon?,"SELECT u.user_id,
       u.user_name,
       COUNT(DISTINCT o.order_id) AS coupon_order_count
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN order_coupons AS oc
    ON oc.order_coupon_order_id = o.order_id
GROUP BY u.user_id, u.user_name
HAVING COUNT(DISTINCT o.order_id) > 3;","[{'user_id': 40, 'user_name': 'Sandra Garcia', 'coupon_order_count': 4}]",,HARD
List all active carts containing more than 2 items in total quantity.,"SELECT c.cart_id,
       c.cart_user_id,
       SUM(ci.cart_item_quantity) AS total_items
FROM cart AS c
JOIN cart_items AS ci
    ON ci.cart_item_cart_id = c.cart_id
WHERE c.cart_status = 'active'
GROUP BY c.cart_id, c.cart_user_id
HAVING SUM(ci.cart_item_quantity) > 2;","[{'cart_id': 54, 'cart_user_id': 90, 'total_items': 8}, {'cart_id': 29, 'cart_user_id': 14, 'total_items': 4}, {'cart_id': 4, 'cart_user_id': 73, 'total_items': 8}, {'cart_id': 34, 'cart_user_id': 90, 'total_items': 3}, {'cart_id': 52, 'cart_user_id': 54, 'total_items': 7}, {'cart_id': 10, 'cart_user_id': 56, 'total_items': 5}, {'cart_id': 35, 'cart_user_id': 67, 'total_items': 9}, {'cart_id': 45, 'cart_user_id': 94, 'total_items': 6}, {'cart_id': 6, 'cart_user_id': 62, 'total_items': 3}, {'cart_id': 60, 'cart_user_id': 82, 'total_items': 4}, {'cart_id': 14, 'cart_user_id': 25, 'total_items': 9}, {'cart_id': 22, 'cart_user_id': 96, 'total_items': 8}, {'cart_id': 59, 'cart_user_id': 99, 'total_items': 5}, {'cart_id': 13, 'cart_user_id': 78, 'total_items': 6}, {'cart_id': 16, 'cart_user_id': 29, 'total_items': 6}, {'cart_id': 44, 'cart_user_id': 63, 'total_items': 3}, {'cart_id': 11, 'cart_user_id': 40, 'total_items': 5}, {'cart_id': 42, 'cart_user_id': 39, 'total_items': 6}, {'cart_id': 41, 'cart_user_id': 5, 'total_items': 4}, {'cart_id': 46, 'cart_user_id': 18, 'total_items': 7}, {'cart_id': 40, 'cart_user_id': 5, 'total_items': 9}, {'cart_id': 43, 'cart_user_id': 12, 'total_items': 6}, {'cart_id': 53, 'cart_user_id': 50, 'total_items': 11}, {'cart_id': 32, 'cart_user_id': 58, 'total_items': 10}, {'cart_id': 9, 'cart_user_id': 74, 'total_items': 3}, {'cart_id': 7, 'cart_user_id': 27, 'total_items': 8}, {'cart_id': 38, 'cart_user_id': 59, 'total_items': 3}, {'cart_id': 15, 'cart_user_id': 46, 'total_items': 7}, {'cart_id': 48, 'cart_user_id': 61, 'total_items': 4}, {'cart_id': 26, 'cart_user_id': 76, 'total_items': 9}, {'cart_id': 12, 'cart_user_id': 47, 'total_items': 4}, {'cart_id': 25, 'cart_user_id': 100, 'total_items': 4}, {'cart_id': 30, 'cart_user_id': 77, 'total_items': 7}, {'cart_id': 21, 'cart_user_id': 50, 'total_items': 7}, {'cart_id': 49, 'cart_user_id': 94, 'total_items': 8}, {'cart_id': 47, 'cart_user_id': 47, 'total_items': 3}, {'cart_id': 17, 'cart_user_id': 14, 'total_items': 6}, {'cart_id': 37, 'cart_user_id': 61, 'total_items': 8}, {'cart_id': 28, 'cart_user_id': 7, 'total_items': 3}, {'cart_id': 20, 'cart_user_id': 92, 'total_items': 4}, {'cart_id': 33, 'cart_user_id': 86, 'total_items': 7}, {'cart_id': 5, 'cart_user_id': 45, 'total_items': 6}, {'cart_id': 18, 'cart_user_id': 29, 'total_items': 7}, {'cart_id': 27, 'cart_user_id': 96, 'total_items': 7}, {'cart_id': 23, 'cart_user_id': 14, 'total_items': 7}, {'cart_id': 58, 'cart_user_id': 16, 'total_items': 5}, {'cart_id': 8, 'cart_user_id': 30, 'total_items': 3}]",,HARD
What are the top 5 most-reviewed products created before 2024-01-01?,"SELECT p.product_id,
       p.product_name,
       COUNT(r.review_id) AS review_count
FROM products AS p
JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE p.product_created_at < '2024-01-01'
GROUP BY p.product_id, p.product_name
ORDER BY review_count DESC
LIMIT 5;",[],,HARD
"For each category, what is the average price of the products assigned to it?","SELECT c.category_id,
       c.category_name,
       AVG(p.product_price) AS avg_price
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
JOIN products AS p
    ON p.product_id = cp.category_product_product_id
GROUP BY c.category_id, c.category_name
ORDER BY c.category_name;","[{'category_id': 25, 'category_name': 'Art', 'avg_price': Decimal('247.2590909090909091')}, {'category_id': 8, 'category_name': 'Automotive', 'avg_price': Decimal('230.5885714285714286')}, {'category_id': 20, 'category_name': 'Baby', 'avg_price': Decimal('228.6471428571428571')}, {'category_id': 23, 'category_name': 'Bags', 'avg_price': Decimal('221.9820000000000000')}, {'category_id': 7, 'category_name': 'Beauty', 'avg_price': Decimal('267.0327272727272727')}, {'category_id': 3, 'category_name': 'Books', 'avg_price': Decimal('227.1293750000000000')}, {'category_id': 2, 'category_name': 'Clothing', 'avg_price': Decimal('262.4231250000000000')}, {'category_id': 30, 'category_name': 'Computers', 'avg_price': Decimal('260.7016666666666667')}, {'category_id': 26, 'category_name': 'Crafts', 'avg_price': Decimal('234.8700000000000000')}, {'category_id': 1, 'category_name': 'Electronics', 'avg_price': Decimal('267.8560000000000000')}, {'category_id': 9, 'category_name': 'Food', 'avg_price': Decimal('265.1688888888888889')}, {'category_id': 19, 'category_name': 'Furniture', 'avg_price': Decimal('198.1857894736842105')}, {'category_id': 15, 'category_name': 'Games', 'avg_price': Decimal('257.7650000000000000')}, {'category_id': 12, 'category_name': 'Health', 'avg_price': Decimal('248.1486666666666667')}, {'category_id': 4, 'category_name': 'Home & Garden', 'avg_price': Decimal('249.5569230769230769')}, {'category_id': 28, 'category_name': 'Industrial', 'avg_price': Decimal('275.2245454545454545')}, {'category_id': 21, 'category_name': 'Jewelry', 'avg_price': Decimal('276.1950000000000000')}, {'category_id': 18, 'category_name': 'Kitchen', 'avg_price': Decimal('242.6438888888888889')}, {'category_id': 14, 'category_name': 'Movies', 'avg_price': Decimal('320.4381818181818182')}, {'category_id': 13, 'category_name': 'Music', 'avg_price': Decimal('216.7809090909090909')}, {'category_id': 11, 'category_name': 'Office', 'avg_price': Decimal('222.4428571428571429')}, {'category_id': 17, 'category_name': 'Outdoor', 'avg_price': Decimal('215.6441666666666667')}, {'category_id': 27, 'category_name': 'Party Supplies', 'avg_price': Decimal('298.1022222222222222')}, {'category_id': 10, 'category_name': 'Pet Supplies', 'avg_price': Decimal('278.3883333333333333')}, {'category_id': 29, 'category_name': 'Phones', 'avg_price': Decimal('261.5911764705882353')}, {'category_id': 22, 'category_name': 'Shoes', 'avg_price': Decimal('265.8900000000000000')}, {'category_id': 5, 'category_name': 'Sports', 'avg_price': Decimal('233.3935000000000000')}, {'category_id': 16, 'category_name': 'Tools', 'avg_price': Decimal('241.6133333333333333')}, {'category_id': 6, 'category_name': 'Toys', 'avg_price': Decimal('206.0855555555555556')}, {'category_id': 24, 'category_name': 'Watches', 'avg_price': Decimal('218.7925000000000000')}]",,HARD
Which shipments are currently in transit and going to addresses in California?,"SELECT s.shipment_id,
       s.shipment_order_id,
       a.address_city,
       a.address_state
FROM shipments AS s
JOIN addresses AS a
    ON s.shipment_address_id = a.address_id
WHERE s.shipment_status = 'in_transit'
  AND a.address_state = 'California';","[{'shipment_id': 105, 'shipment_order_id': 105, 'address_city': 'Ybl', 'address_state': 'California'}, {'shipment_id': 141, 'shipment_order_id': 141, 'address_city': 'Ybl', 'address_state': 'California'}, {'shipment_id': 194, 'shipment_order_id': 194, 'address_city': 'San Diego', 'address_state': 'California'}, {'shipment_id': 231, 'shipment_order_id': 231, 'address_city': 'Ybl', 'address_state': 'California'}, {'shipment_id': 237, 'shipment_order_id': 237, 'address_city': 'San Diego', 'address_state': 'California'}, {'shipment_id': 253, 'shipment_order_id': 253, 'address_city': 'San Diego', 'address_state': 'California'}, {'shipment_id': 272, 'shipment_order_id': 272, 'address_city': 'San Diego', 'address_state': 'California'}]",,EASY
"Which products have active discounts on 2025-01-01, and what are the discount percentages?","SELECT p.product_id,
       p.product_name,
       d.discount_percentage
FROM products AS p
JOIN product_discounts AS pd
    ON pd.product_discount_product_id = p.product_id
JOIN discounts AS d
    ON d.discount_id = pd.product_discount_discount_id
WHERE '2025-01-01' BETWEEN d.discount_start_date AND d.discount_end_date;","[{'product_id': 87, 'product_name': 'Screwdriver Set', 'discount_percentage': Decimal('15.00')}, {'product_id': 149, 'product_name': 'Monitor Arm', 'discount_percentage': Decimal('10.00')}, {'product_id': 116, 'product_name': 'Wallet', 'discount_percentage': Decimal('40.00')}, {'product_id': 24, 'product_name': 'Comic', 'discount_percentage': Decimal('10.00')}, {'product_id': 97, 'product_name': 'Desk', 'discount_percentage': Decimal('35.00')}, {'product_id': 147, 'product_name': 'Mousepad', 'discount_percentage': Decimal('35.00')}, {'product_id': 81, 'product_name': 'Video Game', 'discount_percentage': Decimal('35.00')}, {'product_id': 4, 'product_name': 'Headphones', 'discount_percentage': Decimal('20.00')}, {'product_id': 43, 'product_name': 'Helmet', 'discount_percentage': Decimal('15.00')}, {'product_id': 139, 'product_name': 'Screen Protector', 'discount_percentage': Decimal('40.00')}, {'product_id': 50, 'product_name': 'Lipstick', 'discount_percentage': Decimal('10.00')}, {'product_id': 193, 'product_name': 'Product 193', 'discount_percentage': Decimal('10.00')}, {'product_id': 14, 'product_name': 'Jacket', 'discount_percentage': Decimal('25.00')}, {'product_id': 191, 'product_name': 'Product 191', 'discount_percentage': Decimal('40.00')}, {'product_id': 197, 'product_name': 'Product 197', 'discount_percentage': Decimal('30.00')}, {'product_id': 15, 'product_name': 'Shoes', 'discount_percentage': Decimal('10.00')}, {'product_id': 86, 'product_name': 'Saw', 'discount_percentage': Decimal('30.00')}, {'product_id': 16, 'product_name': 'Hat', 'discount_percentage': Decimal('15.00')}, {'product_id': 75, 'product_name': 'Thermometer', 'discount_percentage': Decimal('10.00')}, {'product_id': 39, 'product_name': 'Yoga Mat', 'discount_percentage': Decimal('15.00')}, {'product_id': 131, 'product_name': 'USB Cable', 'discount_percentage': Decimal('15.00')}, {'product_id': 137, 'product_name': 'Switch', 'discount_percentage': Decimal('35.00')}, {'product_id': 91, 'product_name': 'Backpack', 'discount_percentage': Decimal('40.00')}, {'product_id': 40, 'product_name': 'Dumbbell', 'discount_percentage': Decimal('10.00')}, {'product_id': 198, 'product_name': 'Product 198', 'discount_percentage': Decimal('10.00')}, {'product_id': 195, 'product_name': 'Product 195', 'discount_percentage': Decimal('35.00')}, {'product_id': 94, 'product_name': 'Coffee Maker', 'discount_percentage': Decimal('15.00')}, {'product_id': 200, 'product_name': 'Product 200', 'discount_percentage': Decimal('30.00')}, {'product_id': 46, 'product_name': 'Board Game', 'discount_percentage': Decimal('15.00')}, {'product_id': 124, 'product_name': 'Balloons', 'discount_percentage': Decimal('40.00')}, {'product_id': 54, 'product_name': 'Makeup Kit', 'discount_percentage': Decimal('35.00')}, {'product_id': 164, 'product_name': 'Lantern', 'discount_percentage': Decimal('30.00')}, {'product_id': 185, 'product_name': 'Product 185', 'discount_percentage': Decimal('25.00')}, {'product_id': 28, 'product_name': 'Table', 'discount_percentage': Decimal('30.00')}, {'product_id': 125, 'product_name': 'Party Decorations', 'discount_percentage': Decimal('15.00')}, {'product_id': 196, 'product_name': 'Product 196', 'discount_percentage': Decimal('25.00')}, {'product_id': 3, 'product_name': 'Tablet', 'discount_percentage': Decimal('20.00')}, {'product_id': 115, 'product_name': 'Backpack', 'discount_percentage': Decimal('40.00')}, {'product_id': 105, 'product_name': 'Baby Monitor', 'discount_percentage': Decimal('10.00')}, {'product_id': 1, 'product_name': 'Laptop', 'discount_percentage': Decimal('40.00')}, {'product_id': 158, 'product_name': 'Heater', 'discount_percentage': Decimal('35.00')}, {'product_id': 109, 'product_name': 'Earrings', 'discount_percentage': Decimal('35.00')}, {'product_id': 101, 'product_name': 'Nightstand', 'discount_percentage': Decimal('10.00')}, {'product_id': 83, 'product_name': 'Controller', 'discount_percentage': Decimal('20.00')}, {'product_id': 59, 'product_name': 'Wiper Blades', 'discount_percentage': Decimal('20.00')}, {'product_id': 172, 'product_name': 'Safety Glasses', 'discount_percentage': Decimal('10.00')}, {'product_id': 128, 'product_name': 'Safety Vest', 'discount_percentage': Decimal('30.00')}]",,MEDIUM
Which users submitted more than one return request in 2024?,"SELECT u.user_id,
       u.user_name,
       COUNT(r.return_id) AS return_count
FROM users AS u
JOIN returns AS r
    ON r.return_user_id = u.user_id
WHERE r.return_created_at >= '2024-01-01'
  AND r.return_created_at < '2025-01-01'
GROUP BY u.user_id, u.user_name
HAVING COUNT(r.return_id) > 1;",[],,HARD
Which products have never received any reviews?,"SELECT p.product_id,
       p.product_name
FROM products AS p
LEFT JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE r.review_id IS NULL;","[{'product_id': 151, 'product_name': 'Smart Bulb'}, {'product_id': 119, 'product_name': 'Fitness Tracker'}, {'product_id': 26, 'product_name': 'Sofa'}, {'product_id': 168, 'product_name': 'Wrench Set'}, {'product_id': 27, 'product_name': 'Chair'}, {'product_id': 135, 'product_name': 'Webcam'}, {'product_id': 160, 'product_name': 'Surge Protector'}, {'product_id': 12, 'product_name': 'Shirt'}, {'product_id': 98, 'product_name': 'Bookshelf'}, {'product_id': 167, 'product_name': 'Level'}, {'product_id': 64, 'product_name': 'Sauce'}, {'product_id': 198, 'product_name': 'Product 198'}, {'product_id': 163, 'product_name': 'Flashlight'}, {'product_id': 71, 'product_name': 'Stapler'}, {'product_id': 72, 'product_name': 'Filing Cabinet'}, {'product_id': 15, 'product_name': 'Shoes'}, {'product_id': 189, 'product_name': 'Product 189'}, {'product_id': 165, 'product_name': 'Multi-tool'}, {'product_id': 181, 'product_name': 'Screws'}, {'product_id': 65, 'product_name': 'Dog Food'}, {'product_id': 37, 'product_name': 'Football'}, {'product_id': 32, 'product_name': 'Plant'}, {'product_id': 172, 'product_name': 'Safety Glasses'}, {'product_id': 113, 'product_name': 'Loafers'}, {'product_id': 184, 'product_name': 'Product 184'}, {'product_id': 195, 'product_name': 'Product 195'}, {'product_id': 175, 'product_name': 'Ladder'}, {'product_id': 94, 'product_name': 'Coffee Maker'}, {'product_id': 126, 'product_name': 'Wrapping Paper'}, {'product_id': 81, 'product_name': 'Video Game'}, {'product_id': 134, 'product_name': 'Gaming Mouse'}, {'product_id': 29, 'product_name': 'Lamp'}, {'product_id': 141, 'product_name': 'Charging Dock'}, {'product_id': 138, 'product_name': 'Cable Organizer'}, {'product_id': 103, 'product_name': 'Stroller'}, {'product_id': 44, 'product_name': 'Action Figure'}, {'product_id': 70, 'product_name': 'Pen Set'}, {'product_id': 60, 'product_name': 'Coffee'}, {'product_id': 124, 'product_name': 'Balloons'}, {'product_id': 166, 'product_name': 'Tape Measure'}, {'product_id': 3, 'product_name': 'Tablet'}, {'product_id': 147, 'product_name': 'Mousepad'}, {'product_id': 121, 'product_name': 'Sculpture'}]",,EASY
What are the top 5 vendors whose products have generated the highest total number of reviews?,"SELECT v.vendor_id,
       v.vendor_name,
       COUNT(r.review_id) AS total_reviews
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN products AS p
    ON p.product_id = pv.product_vendor_product_id
JOIN reviews AS r
    ON r.review_product_id = p.product_id
GROUP BY v.vendor_id, v.vendor_name
ORDER BY total_reviews DESC
LIMIT 5;","[{'vendor_id': 6, 'vendor_name': 'Vendor LLC 6', 'total_reviews': 19}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7', 'total_reviews': 18}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2', 'total_reviews': 17}, {'vendor_id': 26, 'vendor_name': 'Vendor LLC 26', 'total_reviews': 16}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12', 'total_reviews': 16}]",,HARD
"Which orders had a payment marked as failed, and what payment method was used?","SELECT o.order_id,
       o.order_user_id,
       p.payment_method,
       p.payment_status
FROM orders AS o
JOIN payments AS p
    ON p.payment_order_id = o.order_id
WHERE p.payment_status = 'failed';","[{'order_id': 13, 'order_user_id': 77, 'payment_method': 'debit_card', 'payment_status': 'failed'}, {'order_id': 57, 'order_user_id': 7, 'payment_method': 'paypal', 'payment_status': 'failed'}, {'order_id': 68, 'order_user_id': 62, 'payment_method': 'credit_card', 'payment_status': 'failed'}, {'order_id': 84, 'order_user_id': 33, 'payment_method': 'paypal', 'payment_status': 'failed'}, {'order_id': 164, 'order_user_id': 78, 'payment_method': 'paypal', 'payment_status': 'failed'}, {'order_id': 170, 'order_user_id': 61, 'payment_method': 'paypal', 'payment_status': 'failed'}, {'order_id': 197, 'order_user_id': 11, 'payment_method': 'credit_card', 'payment_status': 'failed'}, {'order_id': 201, 'order_user_id': 82, 'payment_method': 'debit_card', 'payment_status': 'failed'}, {'order_id': 210, 'order_user_id': 25, 'payment_method': 'google_pay', 'payment_status': 'failed'}, {'order_id': 224, 'order_user_id': 50, 'payment_method': 'debit_card', 'payment_status': 'failed'}, {'order_id': 233, 'order_user_id': 38, 'payment_method': 'apple_pay', 'payment_status': 'failed'}, {'order_id': 244, 'order_user_id': 26, 'payment_method': 'google_pay', 'payment_status': 'failed'}, {'order_id': 265, 'order_user_id': 56, 'payment_method': 'debit_card', 'payment_status': 'failed'}]",,EASY
"For each product, show the number of wishlists it appears in.","SELECT p.product_id,
       p.product_name,
       COUNT(wi.wishlist_item_id) AS wishlist_appearances
FROM products AS p
LEFT JOIN wishlist_items AS wi
    ON wi.wishlist_item_product_id = p.product_id
GROUP BY p.product_id, p.product_name
ORDER BY wishlist_appearances DESC;","[{'product_id': 125, 'product_name': 'Party Decorations', 'wishlist_appearances': 5}, {'product_id': 160, 'product_name': 'Surge Protector', 'wishlist_appearances': 4}, {'product_id': 97, 'product_name': 'Desk', 'wishlist_appearances': 4}, {'product_id': 165, 'product_name': 'Multi-tool', 'wishlist_appearances': 4}, {'product_id': 52, 'product_name': 'Shampoo', 'wishlist_appearances': 4}, {'product_id': 182, 'product_name': 'Anchors', 'wishlist_appearances': 4}, {'product_id': 68, 'product_name': 'Pet Bed', 'wishlist_appearances': 4}, {'product_id': 183, 'product_name': 'Hinges', 'wishlist_appearances': 3}, {'product_id': 114, 'product_name': 'Handbag', 'wishlist_appearances': 3}, {'product_id': 45, 'product_name': 'Puzzle', 'wishlist_appearances': 3}, {'product_id': 101, 'product_name': 'Nightstand', 'wishlist_appearances': 3}, {'product_id': 157, 'product_name': 'Fan', 'wishlist_appearances': 3}, {'product_id': 94, 'product_name': 'Coffee Maker', 'wishlist_appearances': 3}, {'product_id': 65, 'product_name': 'Dog Food', 'wishlist_appearances': 3}, {'product_id': 63, 'product_name': 'Pasta', 'wishlist_appearances': 3}, {'product_id': 199, 'product_name': 'Product 199', 'wishlist_appearances': 3}, {'product_id': 9, 'product_name': 'Monitor', 'wishlist_appearances': 3}, {'product_id': 86, 'product_name': 'Saw', 'wishlist_appearances': 3}, {'product_id': 15, 'product_name': 'Shoes', 'wishlist_appearances': 3}, {'product_id': 193, 'product_name': 'Product 193', 'wishlist_appearances': 3}, {'product_id': 26, 'product_name': 'Sofa', 'wishlist_appearances': 3}, {'product_id': 150, 'product_name': 'LED Strip', 'wishlist_appearances': 3}, {'product_id': 170, 'product_name': 'Toolbox', 'wishlist_appearances': 3}, {'product_id': 83, 'product_name': 'Controller', 'wishlist_appearances': 3}, {'product_id': 44, 'product_name': 'Action Figure', 'wishlist_appearances': 3}, {'product_id': 103, 'product_name': 'Stroller', 'wishlist_appearances': 3}, {'product_id': 91, 'product_name': 'Backpack', 'wishlist_appearances': 3}, {'product_id': 136, 'product_name': 'Router', 'wishlist_appearances': 2}, {'product_id': 161, 'product_name': 'Battery Pack', 'wishlist_appearances': 2}, {'product_id': 121, 'product_name': 'Sculpture', 'wishlist_appearances': 2}, {'product_id': 53, 'product_name': 'Lotion', 'wishlist_appearances': 2}, {'product_id': 58, 'product_name': 'Tire', 'wishlist_appearances': 2}, {'product_id': 145, 'product_name': 'SSD', 'wishlist_appearances': 2}, {'product_id': 32, 'product_name': 'Plant', 'wishlist_appearances': 2}, {'product_id': 40, 'product_name': 'Dumbbell', 'wishlist_appearances': 2}, {'product_id': 166, 'product_name': 'Tape Measure', 'wishlist_appearances': 2}, {'product_id': 129, 'product_name': 'Smartphone', 'wishlist_appearances': 2}, {'product_id': 2, 'product_name': 'Phone', 'wishlist_appearances': 2}, {'product_id': 120, 'product_name': 'Wall Art', 'wishlist_appearances': 2}, {'product_id': 111, 'product_name': 'Boots', 'wishlist_appearances': 2}, {'product_id': 118, 'product_name': 'Smartwatch', 'wishlist_appearances': 2}, {'product_id': 109, 'product_name': 'Earrings', 'wishlist_appearances': 2}, {'product_id': 72, 'product_name': 'Filing Cabinet', 'wishlist_appearances': 2}, {'product_id': 95, 'product_name': 'Knife Set', 'wishlist_appearances': 2}, {'product_id': 70, 'product_name': 'Pen Set', 'wishlist_appearances': 2}, {'product_id': 50, 'product_name': 'Lipstick', 'wishlist_appearances': 2}, {'product_id': 33, 'product_name': 'Vase', 'wishlist_appearances': 2}, {'product_id': 178, 'product_name': 'Sandpaper', 'wishlist_appearances': 2}, {'product_id': 175, 'product_name': 'Ladder', 'wishlist_appearances': 2}, {'product_id': 21, 'product_name': 'Novel', 'wishlist_appearances': 2}, {'product_id': 107, 'product_name': 'Ring', 'wishlist_appearances': 2}, {'product_id': 10, 'product_name': 'Keyboard', 'wishlist_appearances': 2}, {'product_id': 28, 'product_name': 'Table', 'wishlist_appearances': 2}, {'product_id': 90, 'product_name': 'Cooler', 'wishlist_appearances': 2}, {'product_id': 110, 'product_name': 'Sneakers', 'wishlist_appearances': 2}, {'product_id': 181, 'product_name': 'Screws', 'wishlist_appearances': 2}, {'product_id': 112, 'product_name': 'Sandals', 'wishlist_appearances': 2}, {'product_id': 29, 'product_name': 'Lamp', 'wishlist_appearances': 2}, {'product_id': 22, 'product_name': 'Textbook', 'wishlist_appearances': 2}, {'product_id': 154, 'product_name': 'Thermostat', 'wishlist_appearances': 2}, {'product_id': 122, 'product_name': 'Canvas', 'wishlist_appearances': 2}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'wishlist_appearances': 2}, {'product_id': 78, 'product_name': 'Drum Set', 'wishlist_appearances': 2}, {'product_id': 84, 'product_name': 'Drill', 'wishlist_appearances': 2}, {'product_id': 38, 'product_name': 'Tennis Racket', 'wishlist_appearances': 2}, {'product_id': 185, 'product_name': 'Product 185', 'wishlist_appearances': 2}, {'product_id': 23, 'product_name': 'Magazine', 'wishlist_appearances': 1}, {'product_id': 8, 'product_name': 'TV', 'wishlist_appearances': 1}, {'product_id': 184, 'product_name': 'Product 184', 'wishlist_appearances': 1}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'wishlist_appearances': 1}, {'product_id': 51, 'product_name': 'Perfume', 'wishlist_appearances': 1}, {'product_id': 80, 'product_name': 'Blu-ray', 'wishlist_appearances': 1}, {'product_id': 132, 'product_name': 'Power Bank', 'wishlist_appearances': 1}, {'product_id': 176, 'product_name': 'Paint Roller', 'wishlist_appearances': 1}, {'product_id': 169, 'product_name': 'Pliers', 'wishlist_appearances': 1}, {'product_id': 92, 'product_name': 'Blender', 'wishlist_appearances': 1}, {'product_id': 69, 'product_name': 'Notebook', 'wishlist_appearances': 1}, {'product_id': 180, 'product_name': 'Nails', 'wishlist_appearances': 1}, {'product_id': 60, 'product_name': 'Coffee', 'wishlist_appearances': 1}, {'product_id': 108, 'product_name': 'Bracelet', 'wishlist_appearances': 1}, {'product_id': 124, 'product_name': 'Balloons', 'wishlist_appearances': 1}, {'product_id': 73, 'product_name': 'Vitamins', 'wishlist_appearances': 1}, {'product_id': 200, 'product_name': 'Product 200', 'wishlist_appearances': 1}, {'product_id': 42, 'product_name': 'Skateboard', 'wishlist_appearances': 1}, {'product_id': 82, 'product_name': 'Console', 'wishlist_appearances': 1}, {'product_id': 188, 'product_name': 'Product 188', 'wishlist_appearances': 1}, {'product_id': 153, 'product_name': 'Doorbell', 'wishlist_appearances': 1}, {'product_id': 48, 'product_name': 'LEGO Set', 'wishlist_appearances': 1}, {'product_id': 57, 'product_name': 'Oil Filter', 'wishlist_appearances': 1}, {'product_id': 19, 'product_name': 'Jeans', 'wishlist_appearances': 1}, {'product_id': 81, 'product_name': 'Video Game', 'wishlist_appearances': 1}, {'product_id': 77, 'product_name': 'Microphone', 'wishlist_appearances': 1}, {'product_id': 172, 'product_name': 'Safety Glasses', 'wishlist_appearances': 1}, {'product_id': 3, 'product_name': 'Tablet', 'wishlist_appearances': 1}, {'product_id': 171, 'product_name': 'Work Gloves', 'wishlist_appearances': 1}, {'product_id': 74, 'product_name': 'First Aid Kit', 'wishlist_appearances': 1}, {'product_id': 179, 'product_name': 'Wood Glue', 'wishlist_appearances': 1}, {'product_id': 4, 'product_name': 'Headphones', 'wishlist_appearances': 1}, {'product_id': 34, 'product_name': 'Mirror', 'wishlist_appearances': 1}, {'product_id': 96, 'product_name': 'Cookware', 'wishlist_appearances': 1}, {'product_id': 35, 'product_name': 'Clock', 'wishlist_appearances': 1}, {'product_id': 105, 'product_name': 'Baby Monitor', 'wishlist_appearances': 1}, {'product_id': 174, 'product_name': 'Respirator', 'wishlist_appearances': 1}, {'product_id': 6, 'product_name': 'Camera', 'wishlist_appearances': 1}, {'product_id': 134, 'product_name': 'Gaming Mouse', 'wishlist_appearances': 1}, {'product_id': 144, 'product_name': 'RAM', 'wishlist_appearances': 1}, {'product_id': 39, 'product_name': 'Yoga Mat', 'wishlist_appearances': 1}, {'product_id': 168, 'product_name': 'Wrench Set', 'wishlist_appearances': 1}, {'product_id': 89, 'product_name': 'Sleeping Bag', 'wishlist_appearances': 1}, {'product_id': 167, 'product_name': 'Level', 'wishlist_appearances': 1}, {'product_id': 14, 'product_name': 'Jacket', 'wishlist_appearances': 1}, {'product_id': 66, 'product_name': 'Cat Toy', 'wishlist_appearances': 1}, {'product_id': 158, 'product_name': 'Heater', 'wishlist_appearances': 1}, {'product_id': 133, 'product_name': 'External Hard Drive', 'wishlist_appearances': 1}, {'product_id': 16, 'product_name': 'Hat', 'wishlist_appearances': 1}, {'product_id': 126, 'product_name': 'Wrapping Paper', 'wishlist_appearances': 1}, {'product_id': 41, 'product_name': 'Bike', 'wishlist_appearances': 1}, {'product_id': 152, 'product_name': 'Security Camera', 'wishlist_appearances': 1}, {'product_id': 46, 'product_name': 'Board Game', 'wishlist_appearances': 1}, {'product_id': 7, 'product_name': 'Watch', 'wishlist_appearances': 1}, {'product_id': 100, 'product_name': 'Dresser', 'wishlist_appearances': 1}, {'product_id': 12, 'product_name': 'Shirt', 'wishlist_appearances': 1}, {'product_id': 164, 'product_name': 'Lantern', 'wishlist_appearances': 1}, {'product_id': 49, 'product_name': 'RC Car', 'wishlist_appearances': 1}, {'product_id': 20, 'product_name': 'Socks', 'wishlist_appearances': 1}, {'product_id': 1, 'product_name': 'Laptop', 'wishlist_appearances': 1}, {'product_id': 106, 'product_name': 'Necklace', 'wishlist_appearances': 1}, {'product_id': 64, 'product_name': 'Sauce', 'wishlist_appearances': 1}, {'product_id': 55, 'product_name': 'Hair Dryer', 'wishlist_appearances': 1}, {'product_id': 143, 'product_name': 'Graphics Card', 'wishlist_appearances': 1}, {'product_id': 85, 'product_name': 'Hammer', 'wishlist_appearances': 0}, {'product_id': 156, 'product_name': 'Humidifier', 'wishlist_appearances': 0}, {'product_id': 155, 'product_name': 'Air Purifier', 'wishlist_appearances': 0}, {'product_id': 13, 'product_name': 'Pants', 'wishlist_appearances': 0}, {'product_id': 187, 'product_name': 'Product 187', 'wishlist_appearances': 0}, {'product_id': 115, 'product_name': 'Backpack', 'wishlist_appearances': 0}, {'product_id': 195, 'product_name': 'Product 195', 'wishlist_appearances': 0}, {'product_id': 79, 'product_name': 'DVD', 'wishlist_appearances': 0}, {'product_id': 196, 'product_name': 'Product 196', 'wishlist_appearances': 0}, {'product_id': 148, 'product_name': 'Desk Mat', 'wishlist_appearances': 0}, {'product_id': 62, 'product_name': 'Snacks', 'wishlist_appearances': 0}, {'product_id': 147, 'product_name': 'Mousepad', 'wishlist_appearances': 0}, {'product_id': 75, 'product_name': 'Thermometer', 'wishlist_appearances': 0}, {'product_id': 123, 'product_name': 'Paint Set', 'wishlist_appearances': 0}, {'product_id': 128, 'product_name': 'Safety Vest', 'wishlist_appearances': 0}, {'product_id': 76, 'product_name': 'Guitar', 'wishlist_appearances': 0}, {'product_id': 194, 'product_name': 'Product 194', 'wishlist_appearances': 0}, {'product_id': 43, 'product_name': 'Helmet', 'wishlist_appearances': 0}, {'product_id': 99, 'product_name': 'Bed Frame', 'wishlist_appearances': 0}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'wishlist_appearances': 0}, {'product_id': 27, 'product_name': 'Chair', 'wishlist_appearances': 0}, {'product_id': 18, 'product_name': 'Sweater', 'wishlist_appearances': 0}, {'product_id': 71, 'product_name': 'Stapler', 'wishlist_appearances': 0}, {'product_id': 119, 'product_name': 'Fitness Tracker', 'wishlist_appearances': 0}, {'product_id': 113, 'product_name': 'Loafers', 'wishlist_appearances': 0}, {'product_id': 88, 'product_name': 'Tent', 'wishlist_appearances': 0}, {'product_id': 192, 'product_name': 'Product 192', 'wishlist_appearances': 0}, {'product_id': 117, 'product_name': 'Suitcase', 'wishlist_appearances': 0}, {'product_id': 162, 'product_name': 'Solar Panel', 'wishlist_appearances': 0}, {'product_id': 189, 'product_name': 'Product 189', 'wishlist_appearances': 0}, {'product_id': 11, 'product_name': 'Mouse', 'wishlist_appearances': 0}, {'product_id': 149, 'product_name': 'Monitor Arm', 'wishlist_appearances': 0}, {'product_id': 140, 'product_name': 'Phone Case', 'wishlist_appearances': 0}, {'product_id': 139, 'product_name': 'Screen Protector', 'wishlist_appearances': 0}, {'product_id': 173, 'product_name': 'Ear Protection', 'wishlist_appearances': 0}, {'product_id': 190, 'product_name': 'Product 190', 'wishlist_appearances': 0}, {'product_id': 116, 'product_name': 'Wallet', 'wishlist_appearances': 0}, {'product_id': 54, 'product_name': 'Makeup Kit', 'wishlist_appearances': 0}, {'product_id': 137, 'product_name': 'Switch', 'wishlist_appearances': 0}, {'product_id': 138, 'product_name': 'Cable Organizer', 'wishlist_appearances': 0}, {'product_id': 98, 'product_name': 'Bookshelf', 'wishlist_appearances': 0}, {'product_id': 151, 'product_name': 'Smart Bulb', 'wishlist_appearances': 0}, {'product_id': 24, 'product_name': 'Comic', 'wishlist_appearances': 0}, {'product_id': 67, 'product_name': 'Leash', 'wishlist_appearances': 0}, {'product_id': 56, 'product_name': 'Car Battery', 'wishlist_appearances': 0}, {'product_id': 104, 'product_name': 'Car Seat', 'wishlist_appearances': 0}, {'product_id': 5, 'product_name': 'Speaker', 'wishlist_appearances': 0}, {'product_id': 37, 'product_name': 'Football', 'wishlist_appearances': 0}, {'product_id': 191, 'product_name': 'Product 191', 'wishlist_appearances': 0}, {'product_id': 159, 'product_name': 'Extension Cord', 'wishlist_appearances': 0}, {'product_id': 25, 'product_name': 'Journal', 'wishlist_appearances': 0}, {'product_id': 17, 'product_name': 'Dress', 'wishlist_appearances': 0}, {'product_id': 198, 'product_name': 'Product 198', 'wishlist_appearances': 0}, {'product_id': 141, 'product_name': 'Charging Dock', 'wishlist_appearances': 0}, {'product_id': 135, 'product_name': 'Webcam', 'wishlist_appearances': 0}, {'product_id': 131, 'product_name': 'USB Cable', 'wishlist_appearances': 0}, {'product_id': 197, 'product_name': 'Product 197', 'wishlist_appearances': 0}, {'product_id': 186, 'product_name': 'Product 186', 'wishlist_appearances': 0}, {'product_id': 163, 'product_name': 'Flashlight', 'wishlist_appearances': 0}, {'product_id': 59, 'product_name': 'Wiper Blades', 'wishlist_appearances': 0}, {'product_id': 93, 'product_name': 'Toaster', 'wishlist_appearances': 0}, {'product_id': 146, 'product_name': 'Cooling Fan', 'wishlist_appearances': 0}, {'product_id': 36, 'product_name': 'Basketball', 'wishlist_appearances': 0}, {'product_id': 30, 'product_name': 'Rug', 'wishlist_appearances': 0}, {'product_id': 31, 'product_name': 'Curtains', 'wishlist_appearances': 0}, {'product_id': 61, 'product_name': 'Tea', 'wishlist_appearances': 0}, {'product_id': 102, 'product_name': 'Crib', 'wishlist_appearances': 0}, {'product_id': 47, 'product_name': 'Doll', 'wishlist_appearances': 0}, {'product_id': 177, 'product_name': 'Paintbrush', 'wishlist_appearances': 0}, {'product_id': 130, 'product_name': 'Laptop Stand', 'wishlist_appearances': 0}]",,MEDIUM
List all tags associated with products priced above $100.,"SELECT DISTINCT t.tag_id,
       t.tag_name
FROM tags AS t
JOIN product_tags AS pt
    ON pt.product_tag_tag_id = t.tag_id
JOIN products AS p
    ON p.product_id = pt.product_tag_product_id
WHERE p.product_price > 100.00;","[{'tag_id': 50, 'tag_name': 'Bundle'}, {'tag_id': 13, 'tag_name': 'Holiday'}, {'tag_id': 17, 'tag_name': 'Vintage'}, {'tag_id': 15, 'tag_name': 'Eco-Friendly'}, {'tag_id': 12, 'tag_name': 'Seasonal'}, {'tag_id': 14, 'tag_name': 'Gift'}, {'tag_id': 43, 'tag_name': 'Retro'}, {'tag_id': 16, 'tag_name': 'Handmade'}, {'tag_id': 36, 'tag_name': 'Natural'}, {'tag_id': 21, 'tag_name': 'Affordable'}, {'tag_id': 9, 'tag_name': 'Budget'}, {'tag_id': 32, 'tag_name': 'Indoor'}, {'tag_id': 40, 'tag_name': 'Top Rated'}, {'tag_id': 1, 'tag_name': 'New'}, {'tag_id': 27, 'tag_name': 'Portable'}, {'tag_id': 44, 'tag_name': 'Contemporary'}, {'tag_id': 20, 'tag_name': 'Luxury'}, {'tag_id': 11, 'tag_name': 'Clearance'}, {'tag_id': 48, 'tag_name': 'Bulk'}, {'tag_id': 35, 'tag_name': 'Organic'}, {'tag_id': 8, 'tag_name': 'Premium'}, {'tag_id': 18, 'tag_name': 'Modern'}, {'tag_id': 47, 'tag_name': 'Personalized'}, {'tag_id': 49, 'tag_name': 'Sample'}, {'tag_id': 28, 'tag_name': 'Professional'}, {'tag_id': 46, 'tag_name': 'Custom'}, {'tag_id': 22, 'tag_name': 'Durable'}, {'tag_id': 33, 'tag_name': 'Waterproof'}, {'tag_id': 41, 'tag_name': 'Award Winning'}, {'tag_id': 26, 'tag_name': 'Smart'}, {'tag_id': 7, 'tag_name': 'Exclusive'}, {'tag_id': 45, 'tag_name': 'Designer'}, {'tag_id': 39, 'tag_name': 'Bestseller'}, {'tag_id': 37, 'tag_name': 'Imported'}, {'tag_id': 23, 'tag_name': 'Lightweight'}, {'tag_id': 3, 'tag_name': 'Popular'}, {'tag_id': 10, 'tag_name': 'Best Seller'}, {'tag_id': 38, 'tag_name': 'Domestic'}, {'tag_id': 24, 'tag_name': 'Compact'}, {'tag_id': 30, 'tag_name': 'Advanced'}, {'tag_id': 2, 'tag_name': 'Sale'}, {'tag_id': 6, 'tag_name': 'Limited'}, {'tag_id': 19, 'tag_name': 'Classic'}, {'tag_id': 34, 'tag_name': 'Rechargeable'}, {'tag_id': 29, 'tag_name': 'Beginner'}, {'tag_id': 31, 'tag_name': 'Outdoor'}, {'tag_id': 25, 'tag_name': 'Wireless'}, {'tag_id': 4, 'tag_name': 'Featured'}, {'tag_id': 42, 'tag_name': 'Innovative'}, {'tag_id': 5, 'tag_name': 'Trending'}]",,MEDIUM
Which categories contain more than 10 products?,"SELECT c.category_id,
       c.category_name,
       COUNT(cp.category_product_product_id) AS product_count
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
GROUP BY c.category_id, c.category_name
HAVING COUNT(cp.category_product_product_id) > 10;","[{'category_id': 22, 'category_name': 'Shoes', 'product_count': 11}, {'category_id': 15, 'category_name': 'Games', 'product_count': 12}, {'category_id': 19, 'category_name': 'Furniture', 'product_count': 19}, {'category_id': 30, 'category_name': 'Computers', 'product_count': 12}, {'category_id': 21, 'category_name': 'Jewelry', 'product_count': 14}, {'category_id': 3, 'category_name': 'Books', 'product_count': 16}, {'category_id': 17, 'category_name': 'Outdoor', 'product_count': 12}, {'category_id': 28, 'category_name': 'Industrial', 'product_count': 11}, {'category_id': 5, 'category_name': 'Sports', 'product_count': 20}, {'category_id': 29, 'category_name': 'Phones', 'product_count': 17}, {'category_id': 4, 'category_name': 'Home & Garden', 'product_count': 13}, {'category_id': 10, 'category_name': 'Pet Supplies', 'product_count': 18}, {'category_id': 6, 'category_name': 'Toys', 'product_count': 18}, {'category_id': 14, 'category_name': 'Movies', 'product_count': 11}, {'category_id': 13, 'category_name': 'Music', 'product_count': 11}, {'category_id': 2, 'category_name': 'Clothing', 'product_count': 16}, {'category_id': 16, 'category_name': 'Tools', 'product_count': 18}, {'category_id': 7, 'category_name': 'Beauty', 'product_count': 11}, {'category_id': 12, 'category_name': 'Health', 'product_count': 15}, {'category_id': 24, 'category_name': 'Watches', 'product_count': 16}, {'category_id': 25, 'category_name': 'Art', 'product_count': 11}, {'category_id': 18, 'category_name': 'Kitchen', 'product_count': 18}, {'category_id': 8, 'category_name': 'Automotive', 'product_count': 14}]",,HARD
What is the total revenue generated from orders created in January 2024?,"SELECT SUM(o.order_total) AS total_revenue
FROM orders AS o
WHERE o.order_created_at >= '2024-01-01'
  AND o.order_created_at < '2024-02-01';",[{'total_revenue': Decimal('39149.96')}],,EASY
Which users have at least one active cart that contains products with a total quantity greater than 5?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN cart AS c
    ON c.cart_user_id = u.user_id
JOIN cart_items AS ci
    ON ci.cart_item_cart_id = c.cart_id
WHERE c.cart_status = 'active'
GROUP BY u.user_id, u.user_name, c.cart_id
HAVING SUM(ci.cart_item_quantity) > 5;","[{'user_id': 58, 'user_name': 'Brenda Price'}, {'user_id': 73, 'user_name': 'Richard Reed'}, {'user_id': 90, 'user_name': 'John Ward'}, {'user_id': 94, 'user_name': 'Kevin Anderson'}, {'user_id': 77, 'user_name': 'Christine James'}, {'user_id': 45, 'user_name': 'Brian Martinez'}, {'user_id': 12, 'user_name': 'Sharon Carter'}, {'user_id': 5, 'user_name': 'Pamela Patel'}, {'user_id': 96, 'user_name': 'Ryan Kim'}, {'user_id': 54, 'user_name': 'Scott Howard'}, {'user_id': 67, 'user_name': 'Sandra Harris'}, {'user_id': 46, 'user_name': 'Brenda Diaz'}, {'user_id': 76, 'user_name': 'Emma Howard'}, {'user_id': 27, 'user_name': 'Justin Morgan'}, {'user_id': 39, 'user_name': 'Emma Hernandez'}, {'user_id': 50, 'user_name': 'Stephanie Lopez'}, {'user_id': 61, 'user_name': 'Michael Bailey'}, {'user_id': 25, 'user_name': 'Emily Robinson'}, {'user_id': 78, 'user_name': 'William Reed'}, {'user_id': 18, 'user_name': 'Karen Hernandez'}, {'user_id': 29, 'user_name': 'Jeffrey Davis'}, {'user_id': 86, 'user_name': 'Brenda King'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}]",,HARD
Which products were added to the system in 2023 and have at least one vendor?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN product_vendors AS pv
    ON pv.product_vendor_product_id = p.product_id
WHERE p.product_created_at >= '2023-01-01'
  AND p.product_created_at < '2024-01-01';",[],,MEDIUM
Which orders have shipments that were delivered after 2024-06-01?,"SELECT o.order_id,
       o.order_user_id,
       s.shipment_id,
       s.shipment_updated_at
FROM orders AS o
JOIN shipments AS s
    ON s.shipment_order_id = o.order_id
WHERE s.shipment_status = 'delivered'
  AND s.shipment_updated_at > '2024-06-01';","[{'order_id': 1, 'order_user_id': 21, 'shipment_id': 1, 'shipment_updated_at': datetime.datetime(2024, 10, 20, 16, 51, 19, 914000)}, {'order_id': 24, 'order_user_id': 37, 'shipment_id': 24, 'shipment_updated_at': datetime.datetime(2024, 11, 12, 8, 15, 12, 122000)}, {'order_id': 26, 'order_user_id': 6, 'shipment_id': 26, 'shipment_updated_at': datetime.datetime(2024, 7, 25, 7, 34, 16, 763000)}, {'order_id': 53, 'order_user_id': 10, 'shipment_id': 53, 'shipment_updated_at': datetime.datetime(2024, 10, 21, 16, 33, 25, 235000)}, {'order_id': 58, 'order_user_id': 46, 'shipment_id': 58, 'shipment_updated_at': datetime.datetime(2024, 8, 13, 19, 55, 52, 326000)}, {'order_id': 62, 'order_user_id': 13, 'shipment_id': 62, 'shipment_updated_at': datetime.datetime(2024, 10, 5, 16, 8, 52, 871000)}, {'order_id': 64, 'order_user_id': 72, 'shipment_id': 64, 'shipment_updated_at': datetime.datetime(2024, 6, 28, 17, 10, 35, 228000)}, {'order_id': 66, 'order_user_id': 57, 'shipment_id': 66, 'shipment_updated_at': datetime.datetime(2024, 8, 30, 19, 35, 21, 683000)}, {'order_id': 74, 'order_user_id': 78, 'shipment_id': 74, 'shipment_updated_at': datetime.datetime(2024, 7, 21, 12, 55, 56, 259000)}, {'order_id': 77, 'order_user_id': 57, 'shipment_id': 77, 'shipment_updated_at': datetime.datetime(2024, 8, 27, 16, 29, 20, 383000)}, {'order_id': 86, 'order_user_id': 13, 'shipment_id': 86, 'shipment_updated_at': datetime.datetime(2024, 6, 22, 23, 14, 36, 460000)}, {'order_id': 109, 'order_user_id': 64, 'shipment_id': 109, 'shipment_updated_at': datetime.datetime(2024, 10, 13, 19, 38, 50, 115000)}, {'order_id': 111, 'order_user_id': 63, 'shipment_id': 111, 'shipment_updated_at': datetime.datetime(2024, 9, 12, 5, 40, 40, 182000)}, {'order_id': 123, 'order_user_id': 66, 'shipment_id': 123, 'shipment_updated_at': datetime.datetime(2024, 11, 17, 13, 52, 23, 433000)}, {'order_id': 125, 'order_user_id': 69, 'shipment_id': 125, 'shipment_updated_at': datetime.datetime(2024, 7, 21, 3, 11, 32, 613000)}, {'order_id': 126, 'order_user_id': 5, 'shipment_id': 126, 'shipment_updated_at': datetime.datetime(2024, 7, 15, 7, 23, 23, 619000)}, {'order_id': 128, 'order_user_id': 44, 'shipment_id': 128, 'shipment_updated_at': datetime.datetime(2024, 8, 10, 19, 30, 4, 831000)}, {'order_id': 134, 'order_user_id': 45, 'shipment_id': 134, 'shipment_updated_at': datetime.datetime(2024, 10, 12, 0, 12, 1, 244000)}, {'order_id': 139, 'order_user_id': 84, 'shipment_id': 139, 'shipment_updated_at': datetime.datetime(2024, 8, 12, 20, 6, 17, 860000)}, {'order_id': 140, 'order_user_id': 21, 'shipment_id': 140, 'shipment_updated_at': datetime.datetime(2024, 10, 6, 12, 11, 46, 551000)}, {'order_id': 145, 'order_user_id': 78, 'shipment_id': 145, 'shipment_updated_at': datetime.datetime(2024, 11, 1, 7, 21, 59, 14000)}, {'order_id': 149, 'order_user_id': 68, 'shipment_id': 149, 'shipment_updated_at': datetime.datetime(2024, 10, 29, 1, 37, 30, 853000)}, {'order_id': 152, 'order_user_id': 50, 'shipment_id': 152, 'shipment_updated_at': datetime.datetime(2024, 7, 20, 23, 0, 49, 859000)}, {'order_id': 154, 'order_user_id': 76, 'shipment_id': 154, 'shipment_updated_at': datetime.datetime(2024, 6, 2, 11, 13, 47, 580000)}, {'order_id': 160, 'order_user_id': 73, 'shipment_id': 160, 'shipment_updated_at': datetime.datetime(2024, 7, 30, 9, 57, 17, 489000)}, {'order_id': 165, 'order_user_id': 25, 'shipment_id': 165, 'shipment_updated_at': datetime.datetime(2024, 6, 16, 11, 47, 49, 176000)}, {'order_id': 172, 'order_user_id': 48, 'shipment_id': 172, 'shipment_updated_at': datetime.datetime(2024, 11, 11, 16, 44, 24, 661000)}, {'order_id': 177, 'order_user_id': 22, 'shipment_id': 177, 'shipment_updated_at': datetime.datetime(2024, 7, 29, 20, 21, 32, 685000)}, {'order_id': 210, 'order_user_id': 25, 'shipment_id': 210, 'shipment_updated_at': datetime.datetime(2024, 6, 11, 3, 42, 37, 898000)}, {'order_id': 213, 'order_user_id': 26, 'shipment_id': 213, 'shipment_updated_at': datetime.datetime(2024, 8, 29, 14, 11, 17, 158000)}, {'order_id': 214, 'order_user_id': 64, 'shipment_id': 214, 'shipment_updated_at': datetime.datetime(2024, 9, 15, 14, 36, 12, 739000)}, {'order_id': 218, 'order_user_id': 13, 'shipment_id': 218, 'shipment_updated_at': datetime.datetime(2024, 11, 14, 13, 4, 36, 14000)}, {'order_id': 220, 'order_user_id': 4, 'shipment_id': 220, 'shipment_updated_at': datetime.datetime(2024, 11, 13, 10, 40, 39, 190000)}, {'order_id': 221, 'order_user_id': 38, 'shipment_id': 221, 'shipment_updated_at': datetime.datetime(2024, 6, 10, 14, 52, 6, 567000)}, {'order_id': 228, 'order_user_id': 23, 'shipment_id': 228, 'shipment_updated_at': datetime.datetime(2024, 9, 16, 6, 24, 18, 962000)}, {'order_id': 242, 'order_user_id': 8, 'shipment_id': 242, 'shipment_updated_at': datetime.datetime(2024, 6, 27, 11, 28, 7, 77000)}, {'order_id': 245, 'order_user_id': 77, 'shipment_id': 245, 'shipment_updated_at': datetime.datetime(2024, 7, 17, 19, 25, 59, 316000)}, {'order_id': 247, 'order_user_id': 89, 'shipment_id': 247, 'shipment_updated_at': datetime.datetime(2024, 7, 29, 20, 43, 29, 197000)}, {'order_id': 255, 'order_user_id': 48, 'shipment_id': 255, 'shipment_updated_at': datetime.datetime(2024, 8, 26, 17, 37, 33, 842000)}, {'order_id': 259, 'order_user_id': 47, 'shipment_id': 259, 'shipment_updated_at': datetime.datetime(2024, 7, 7, 14, 53, 29, 746000)}, {'order_id': 260, 'order_user_id': 68, 'shipment_id': 260, 'shipment_updated_at': datetime.datetime(2024, 11, 9, 22, 45, 13, 44000)}, {'order_id': 266, 'order_user_id': 15, 'shipment_id': 266, 'shipment_updated_at': datetime.datetime(2024, 7, 27, 15, 40, 17, 464000)}, {'order_id': 271, 'order_user_id': 37, 'shipment_id': 271, 'shipment_updated_at': datetime.datetime(2024, 10, 22, 18, 10, 36, 448000)}, {'order_id': 275, 'order_user_id': 26, 'shipment_id': 275, 'shipment_updated_at': datetime.datetime(2024, 8, 23, 16, 39, 33, 180000)}, {'order_id': 281, 'order_user_id': 67, 'shipment_id': 281, 'shipment_updated_at': datetime.datetime(2024, 10, 19, 19, 5, 46, 999000)}, {'order_id': 290, 'order_user_id': 65, 'shipment_id': 290, 'shipment_updated_at': datetime.datetime(2024, 11, 4, 20, 3, 19, 76000)}, {'order_id': 293, 'order_user_id': 37, 'shipment_id': 293, 'shipment_updated_at': datetime.datetime(2024, 10, 24, 1, 57, 10, 529000)}, {'order_id': 295, 'order_user_id': 40, 'shipment_id': 295, 'shipment_updated_at': datetime.datetime(2024, 10, 13, 2, 1, 41, 211000)}, {'order_id': 298, 'order_user_id': 13, 'shipment_id': 298, 'shipment_updated_at': datetime.datetime(2024, 6, 28, 21, 14, 12, 391000)}]",,EASY
Which users have written more than 5 total product reviews?,"SELECT u.user_id,
       u.user_name,
       COUNT(r.review_id) AS review_count
FROM users AS u
JOIN reviews AS r
    ON r.review_user_id = u.user_id
GROUP BY u.user_id, u.user_name
HAVING COUNT(r.review_id) > 5
ORDER BY review_count DESC;","[{'user_id': 37, 'user_name': 'Lisa Kim', 'review_count': 11}, {'user_id': 73, 'user_name': 'Richard Reed', 'review_count': 9}, {'user_id': 64, 'user_name': 'Samuel Peterson', 'review_count': 9}, {'user_id': 83, 'user_name': 'Sarah Foster', 'review_count': 8}, {'user_id': 26, 'user_name': 'Nicole Anderson', 'review_count': 8}, {'user_id': 13, 'user_name': 'Melissa Nelson', 'review_count': 7}, {'user_id': 77, 'user_name': 'Christine James', 'review_count': 7}, {'user_id': 47, 'user_name': 'Margaret Clark', 'review_count': 7}, {'user_id': 86, 'user_name': 'Brenda King', 'review_count': 7}, {'user_id': 46, 'user_name': 'Brenda Diaz', 'review_count': 7}, {'user_id': 41, 'user_name': 'Donald Hughes', 'review_count': 6}, {'user_id': 14, 'user_name': 'Joseph Sanders', 'review_count': 6}, {'user_id': 35, 'user_name': 'Carolyn Adams', 'review_count': 6}]",,HARD
Which products currently have no vendors and no tags associated with them?,"SELECT p.product_id,
       p.product_name
FROM products AS p
LEFT JOIN product_vendors AS pv
    ON pv.product_vendor_product_id = p.product_id
LEFT JOIN product_tags AS pt
    ON pt.product_tag_product_id = p.product_id
WHERE pv.product_vendor_id IS NULL
  AND pt.product_tag_id IS NULL;",[],,HARD
Which coupons were active on 2024-12-15 and used in at least one order?,"SELECT DISTINCT c.coupon_id,
       c.coupon_code,
       c.coupon_discount_percentage
FROM coupons AS c
JOIN order_coupons AS oc
    ON oc.order_coupon_coupon_id = c.coupon_id
WHERE '2024-12-15' BETWEEN c.coupon_start_date AND c.coupon_end_date;","[{'coupon_id': 1, 'coupon_code': 'COUPON1SALE', 'coupon_discount_percentage': Decimal('15.00')}, {'coupon_id': 2, 'coupon_code': 'COUPON2DEAL', 'coupon_discount_percentage': Decimal('10.00')}, {'coupon_id': 3, 'coupon_code': 'COUPON3SAVE', 'coupon_discount_percentage': Decimal('10.00')}, {'coupon_id': 4, 'coupon_code': 'COUPON4SALE', 'coupon_discount_percentage': Decimal('20.00')}, {'coupon_id': 5, 'coupon_code': 'COUPON5OFF', 'coupon_discount_percentage': Decimal('10.00')}, {'coupon_id': 6, 'coupon_code': 'COUPON6SAVE', 'coupon_discount_percentage': Decimal('15.00')}, {'coupon_id': 9, 'coupon_code': 'COUPON9SAVE', 'coupon_discount_percentage': Decimal('25.00')}, {'coupon_id': 10, 'coupon_code': 'COUPON10SAVE', 'coupon_discount_percentage': Decimal('15.00')}, {'coupon_id': 11, 'coupon_code': 'COUPON11DEAL', 'coupon_discount_percentage': Decimal('5.00')}, {'coupon_id': 14, 'coupon_code': 'COUPON14DEAL', 'coupon_discount_percentage': Decimal('10.00')}, {'coupon_id': 15, 'coupon_code': 'COUPON15DEAL', 'coupon_discount_percentage': Decimal('10.00')}, {'coupon_id': 16, 'coupon_code': 'COUPON16SALE', 'coupon_discount_percentage': Decimal('30.00')}, {'coupon_id': 17, 'coupon_code': 'COUPON17DEAL', 'coupon_discount_percentage': Decimal('20.00')}, {'coupon_id': 19, 'coupon_code': 'COUPON19OFF', 'coupon_discount_percentage': Decimal('25.00')}, {'coupon_id': 20, 'coupon_code': 'COUPON20SAVE', 'coupon_discount_percentage': Decimal('20.00')}, {'coupon_id': 21, 'coupon_code': 'COUPON21DEAL', 'coupon_discount_percentage': Decimal('5.00')}, {'coupon_id': 22, 'coupon_code': 'COUPON22OFF', 'coupon_discount_percentage': Decimal('10.00')}, {'coupon_id': 23, 'coupon_code': 'COUPON23OFF', 'coupon_discount_percentage': Decimal('20.00')}, {'coupon_id': 24, 'coupon_code': 'COUPON24OFF', 'coupon_discount_percentage': Decimal('5.00')}, {'coupon_id': 25, 'coupon_code': 'COUPON25SAVE', 'coupon_discount_percentage': Decimal('25.00')}, {'coupon_id': 26, 'coupon_code': 'COUPON26SALE', 'coupon_discount_percentage': Decimal('30.00')}, {'coupon_id': 27, 'coupon_code': 'COUPON27SAVE', 'coupon_discount_percentage': Decimal('30.00')}, {'coupon_id': 29, 'coupon_code': 'COUPON29OFF', 'coupon_discount_percentage': Decimal('25.00')}, {'coupon_id': 38, 'coupon_code': 'COUPON38SAVE', 'coupon_discount_percentage': Decimal('5.00')}, {'coupon_id': 47, 'coupon_code': 'COUPON47SAVE', 'coupon_discount_percentage': Decimal('25.00')}, {'coupon_id': 49, 'coupon_code': 'COUPON49SAVE', 'coupon_discount_percentage': Decimal('20.00')}]",,MEDIUM
"For each vendor, show the total number of categories their products belong to.","SELECT v.vendor_id,
       v.vendor_name,
       COUNT(DISTINCT cp.category_product_category_id) AS category_count
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN category_products AS cp
    ON cp.category_product_product_id = pv.product_vendor_product_id
GROUP BY v.vendor_id, v.vendor_name
ORDER BY category_count DESC;","[{'vendor_id': 39, 'vendor_name': 'Vendor Group 39', 'category_count': 15}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19', 'category_count': 14}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2', 'category_count': 13}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8', 'category_count': 13}, {'vendor_id': 26, 'vendor_name': 'Vendor LLC 26', 'category_count': 13}, {'vendor_id': 1, 'vendor_name': 'Vendor Corp 1', 'category_count': 13}, {'vendor_id': 22, 'vendor_name': 'Vendor Industries 22', 'category_count': 12}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5', 'category_count': 12}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36', 'category_count': 12}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12', 'category_count': 12}, {'vendor_id': 29, 'vendor_name': 'Vendor Corp 29', 'category_count': 11}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3', 'category_count': 11}, {'vendor_id': 45, 'vendor_name': 'Vendor Industries 45', 'category_count': 11}, {'vendor_id': 14, 'vendor_name': 'Vendor Corp 14', 'category_count': 11}, {'vendor_id': 40, 'vendor_name': 'Vendor Group 40', 'category_count': 11}, {'vendor_id': 49, 'vendor_name': 'Vendor LLC 49', 'category_count': 11}, {'vendor_id': 13, 'vendor_name': 'Vendor Corp 13', 'category_count': 10}, {'vendor_id': 18, 'vendor_name': 'Vendor Industries 18', 'category_count': 10}, {'vendor_id': 20, 'vendor_name': 'Vendor Enterprises 20', 'category_count': 10}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30', 'category_count': 10}, {'vendor_id': 16, 'vendor_name': 'Vendor LLC 16', 'category_count': 9}, {'vendor_id': 32, 'vendor_name': 'Vendor Industries 32', 'category_count': 9}, {'vendor_id': 23, 'vendor_name': 'Vendor Enterprises 23', 'category_count': 9}, {'vendor_id': 43, 'vendor_name': 'Vendor Enterprises 43', 'category_count': 9}, {'vendor_id': 47, 'vendor_name': 'Vendor Supply Co 47', 'category_count': 9}, {'vendor_id': 6, 'vendor_name': 'Vendor LLC 6', 'category_count': 9}, {'vendor_id': 15, 'vendor_name': 'Vendor LLC 15', 'category_count': 9}, {'vendor_id': 4, 'vendor_name': 'Vendor LLC 4', 'category_count': 9}, {'vendor_id': 37, 'vendor_name': 'Vendor LLC 37', 'category_count': 9}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50', 'category_count': 9}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17', 'category_count': 8}, {'vendor_id': 9, 'vendor_name': 'Vendor Group 9', 'category_count': 8}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7', 'category_count': 8}, {'vendor_id': 41, 'vendor_name': 'Vendor Group 41', 'category_count': 8}, {'vendor_id': 27, 'vendor_name': 'Vendor LLC 27', 'category_count': 8}, {'vendor_id': 48, 'vendor_name': 'Vendor Supply Co 48', 'category_count': 8}, {'vendor_id': 38, 'vendor_name': 'Vendor Corp 38', 'category_count': 7}, {'vendor_id': 10, 'vendor_name': 'Vendor Group 10', 'category_count': 6}, {'vendor_id': 24, 'vendor_name': 'Vendor LLC 24', 'category_count': 6}, {'vendor_id': 25, 'vendor_name': 'Vendor Group 25', 'category_count': 6}, {'vendor_id': 31, 'vendor_name': 'Vendor Enterprises 31', 'category_count': 6}, {'vendor_id': 33, 'vendor_name': 'Vendor LLC 33', 'category_count': 6}, {'vendor_id': 42, 'vendor_name': 'Vendor Supply Co 42', 'category_count': 6}, {'vendor_id': 44, 'vendor_name': 'Vendor Group 44', 'category_count': 6}, {'vendor_id': 28, 'vendor_name': 'Vendor Supply Co 28', 'category_count': 5}, {'vendor_id': 46, 'vendor_name': 'Vendor Supply Co 46', 'category_count': 3}, {'vendor_id': 35, 'vendor_name': 'Vendor Supply Co 35', 'category_count': 3}, {'vendor_id': 34, 'vendor_name': 'Vendor Corp 34', 'category_count': 3}, {'vendor_id': 11, 'vendor_name': 'Vendor Supply Co 11', 'category_count': 2}, {'vendor_id': 21, 'vendor_name': 'Vendor LLC 21', 'category_count': 1}]",,HARD
Which products appear in wishlists created after 2024-05-01?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN wishlist_items AS wi
    ON wi.wishlist_item_product_id = p.product_id
JOIN wishlist AS w
    ON w.wishlist_id = wi.wishlist_item_wishlist_id
WHERE w.wishlist_created_at > '2024-05-01';","[{'product_id': 181, 'product_name': 'Screws'}, {'product_id': 120, 'product_name': 'Wall Art'}, {'product_id': 154, 'product_name': 'Thermostat'}, {'product_id': 63, 'product_name': 'Pasta'}, {'product_id': 29, 'product_name': 'Lamp'}, {'product_id': 4, 'product_name': 'Headphones'}, {'product_id': 38, 'product_name': 'Tennis Racket'}, {'product_id': 200, 'product_name': 'Product 200'}, {'product_id': 127, 'product_name': 'Warehouse Shelving'}, {'product_id': 19, 'product_name': 'Jeans'}, {'product_id': 74, 'product_name': 'First Aid Kit'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 60, 'product_name': 'Coffee'}, {'product_id': 166, 'product_name': 'Tape Measure'}, {'product_id': 199, 'product_name': 'Product 199'}, {'product_id': 176, 'product_name': 'Paint Roller'}, {'product_id': 12, 'product_name': 'Shirt'}, {'product_id': 33, 'product_name': 'Vase'}, {'product_id': 78, 'product_name': 'Drum Set'}, {'product_id': 15, 'product_name': 'Shoes'}, {'product_id': 44, 'product_name': 'Action Figure'}, {'product_id': 91, 'product_name': 'Backpack'}, {'product_id': 32, 'product_name': 'Plant'}, {'product_id': 161, 'product_name': 'Battery Pack'}, {'product_id': 150, 'product_name': 'LED Strip'}, {'product_id': 23, 'product_name': 'Magazine'}, {'product_id': 68, 'product_name': 'Pet Bed'}, {'product_id': 28, 'product_name': 'Table'}, {'product_id': 165, 'product_name': 'Multi-tool'}, {'product_id': 114, 'product_name': 'Handbag'}, {'product_id': 14, 'product_name': 'Jacket'}, {'product_id': 184, 'product_name': 'Product 184'}, {'product_id': 66, 'product_name': 'Cat Toy'}, {'product_id': 112, 'product_name': 'Sandals'}, {'product_id': 160, 'product_name': 'Surge Protector'}, {'product_id': 9, 'product_name': 'Monitor'}, {'product_id': 20, 'product_name': 'Socks'}, {'product_id': 183, 'product_name': 'Hinges'}, {'product_id': 58, 'product_name': 'Tire'}, {'product_id': 107, 'product_name': 'Ring'}, {'product_id': 92, 'product_name': 'Blender'}, {'product_id': 153, 'product_name': 'Doorbell'}, {'product_id': 41, 'product_name': 'Bike'}, {'product_id': 124, 'product_name': 'Balloons'}, {'product_id': 46, 'product_name': 'Board Game'}, {'product_id': 185, 'product_name': 'Product 185'}, {'product_id': 84, 'product_name': 'Drill'}, {'product_id': 64, 'product_name': 'Sauce'}, {'product_id': 35, 'product_name': 'Clock'}, {'product_id': 2, 'product_name': 'Phone'}, {'product_id': 106, 'product_name': 'Necklace'}, {'product_id': 48, 'product_name': 'LEGO Set'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 7, 'product_name': 'Watch'}, {'product_id': 77, 'product_name': 'Microphone'}, {'product_id': 110, 'product_name': 'Sneakers'}, {'product_id': 129, 'product_name': 'Smartphone'}, {'product_id': 134, 'product_name': 'Gaming Mouse'}, {'product_id': 122, 'product_name': 'Canvas'}, {'product_id': 178, 'product_name': 'Sandpaper'}, {'product_id': 168, 'product_name': 'Wrench Set'}, {'product_id': 53, 'product_name': 'Lotion'}, {'product_id': 152, 'product_name': 'Security Camera'}, {'product_id': 169, 'product_name': 'Pliers'}, {'product_id': 105, 'product_name': 'Baby Monitor'}, {'product_id': 95, 'product_name': 'Knife Set'}, {'product_id': 73, 'product_name': 'Vitamins'}, {'product_id': 164, 'product_name': 'Lantern'}, {'product_id': 80, 'product_name': 'Blu-ray'}, {'product_id': 8, 'product_name': 'TV'}, {'product_id': 100, 'product_name': 'Dresser'}, {'product_id': 193, 'product_name': 'Product 193'}, {'product_id': 103, 'product_name': 'Stroller'}, {'product_id': 97, 'product_name': 'Desk'}, {'product_id': 170, 'product_name': 'Toolbox'}, {'product_id': 96, 'product_name': 'Cookware'}, {'product_id': 90, 'product_name': 'Cooler'}, {'product_id': 175, 'product_name': 'Ladder'}, {'product_id': 50, 'product_name': 'Lipstick'}, {'product_id': 157, 'product_name': 'Fan'}, {'product_id': 158, 'product_name': 'Heater'}, {'product_id': 72, 'product_name': 'Filing Cabinet'}, {'product_id': 45, 'product_name': 'Puzzle'}, {'product_id': 182, 'product_name': 'Anchors'}, {'product_id': 108, 'product_name': 'Bracelet'}, {'product_id': 26, 'product_name': 'Sofa'}, {'product_id': 86, 'product_name': 'Saw'}, {'product_id': 70, 'product_name': 'Pen Set'}, {'product_id': 145, 'product_name': 'SSD'}, {'product_id': 83, 'product_name': 'Controller'}, {'product_id': 39, 'product_name': 'Yoga Mat'}, {'product_id': 101, 'product_name': 'Nightstand'}, {'product_id': 10, 'product_name': 'Keyboard'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 180, 'product_name': 'Nails'}, {'product_id': 65, 'product_name': 'Dog Food'}, {'product_id': 21, 'product_name': 'Novel'}, {'product_id': 52, 'product_name': 'Shampoo'}]",,HARD
What is the total value of items purchased per user for delivered orders only?,"SELECT u.user_id,
       u.user_name,
       SUM(oi.order_item_price * oi.order_item_quantity) AS total_spent
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
WHERE o.order_status = 'delivered'
GROUP BY u.user_id, u.user_name
ORDER BY total_spent DESC;","[{'user_id': 33, 'user_name': 'Jonathan Chavez', 'total_spent': Decimal('10249.92')}, {'user_id': 64, 'user_name': 'Samuel Peterson', 'total_spent': Decimal('8835.67')}, {'user_id': 37, 'user_name': 'Lisa Kim', 'total_spent': Decimal('8768.31')}, {'user_id': 81, 'user_name': 'Jennifer Morales', 'total_spent': Decimal('8528.71')}, {'user_id': 35, 'user_name': 'Carolyn Adams', 'total_spent': Decimal('8511.88')}, {'user_id': 13, 'user_name': 'Melissa Nelson', 'total_spent': Decimal('8175.89')}, {'user_id': 15, 'user_name': 'Lisa Lopez', 'total_spent': Decimal('7932.59')}, {'user_id': 6, 'user_name': 'Heather Murphy', 'total_spent': Decimal('7915.77')}, {'user_id': 46, 'user_name': 'Brenda Diaz', 'total_spent': Decimal('7855.01')}, {'user_id': 47, 'user_name': 'Margaret Clark', 'total_spent': Decimal('7156.32')}, {'user_id': 73, 'user_name': 'Richard Reed', 'total_spent': Decimal('7066.61')}, {'user_id': 40, 'user_name': 'Sandra Garcia', 'total_spent': Decimal('7062.74')}, {'user_id': 61, 'user_name': 'Michael Bailey', 'total_spent': Decimal('6959.29')}, {'user_id': 21, 'user_name': 'Richard Scott', 'total_spent': Decimal('6769.49')}, {'user_id': 71, 'user_name': 'Kathleen Baker', 'total_spent': Decimal('6075.65')}, {'user_id': 3, 'user_name': 'Ashley Green', 'total_spent': Decimal('5515.08')}, {'user_id': 24, 'user_name': 'Emily James', 'total_spent': Decimal('5320.64')}, {'user_id': 22, 'user_name': 'Frank Martin', 'total_spent': Decimal('5043.35')}, {'user_id': 67, 'user_name': 'Sandra Harris', 'total_spent': Decimal('4945.33')}, {'user_id': 78, 'user_name': 'William Reed', 'total_spent': Decimal('4925.85')}, {'user_id': 83, 'user_name': 'Sarah Foster', 'total_spent': Decimal('4692.38')}, {'user_id': 41, 'user_name': 'Donald Hughes', 'total_spent': Decimal('4589.85')}, {'user_id': 45, 'user_name': 'Brian Martinez', 'total_spent': Decimal('4284.96')}, {'user_id': 26, 'user_name': 'Nicole Anderson', 'total_spent': Decimal('4244.86')}, {'user_id': 69, 'user_name': 'Gary Kim', 'total_spent': Decimal('4077.38')}, {'user_id': 38, 'user_name': 'Rebecca Lopez', 'total_spent': Decimal('3823.18')}, {'user_id': 16, 'user_name': 'Raymond Ruiz', 'total_spent': Decimal('3429.37')}, {'user_id': 54, 'user_name': 'Scott Howard', 'total_spent': Decimal('3412.29')}, {'user_id': 66, 'user_name': 'Timothy Wood', 'total_spent': Decimal('3219.28')}, {'user_id': 50, 'user_name': 'Stephanie Lopez', 'total_spent': Decimal('3212.18')}, {'user_id': 36, 'user_name': 'Michael Cooper', 'total_spent': Decimal('3113.20')}, {'user_id': 20, 'user_name': 'Carolyn Torres', 'total_spent': Decimal('2937.68')}, {'user_id': 89, 'user_name': 'Rebecca Moore', 'total_spent': Decimal('2915.90')}, {'user_id': 77, 'user_name': 'Christine James', 'total_spent': Decimal('2589.14')}, {'user_id': 55, 'user_name': 'Christine Hughes', 'total_spent': Decimal('2488.60')}, {'user_id': 19, 'user_name': 'Andrew Torres', 'total_spent': Decimal('2436.57')}, {'user_id': 48, 'user_name': 'Elizabeth Richardson', 'total_spent': Decimal('2432.40')}, {'user_id': 4, 'user_name': 'Kenneth Castillo', 'total_spent': Decimal('2402.16')}, {'user_id': 68, 'user_name': 'Larry Stewart', 'total_spent': Decimal('2357.80')}, {'user_id': 27, 'user_name': 'Justin Morgan', 'total_spent': Decimal('2282.07')}, {'user_id': 49, 'user_name': 'Jason Hill', 'total_spent': Decimal('2196.16')}, {'user_id': 70, 'user_name': 'Scott Brooks', 'total_spent': Decimal('2182.37')}, {'user_id': 82, 'user_name': 'Edward Diaz', 'total_spent': Decimal('2168.67')}, {'user_id': 30, 'user_name': 'Amanda Morales', 'total_spent': Decimal('2141.65')}, {'user_id': 12, 'user_name': 'Sharon Carter', 'total_spent': Decimal('2124.00')}, {'user_id': 14, 'user_name': 'Joseph Sanders', 'total_spent': Decimal('2036.05')}, {'user_id': 79, 'user_name': 'Mark Evans', 'total_spent': Decimal('2027.83')}, {'user_id': 43, 'user_name': 'Donna White', 'total_spent': Decimal('2018.86')}, {'user_id': 25, 'user_name': 'Emily Robinson', 'total_spent': Decimal('1930.15')}, {'user_id': 8, 'user_name': 'Anthony Foster', 'total_spent': Decimal('1862.46')}, {'user_id': 63, 'user_name': 'Jeffrey Davis', 'total_spent': Decimal('1853.81')}, {'user_id': 53, 'user_name': 'Stephanie Anderson', 'total_spent': Decimal('1720.55')}, {'user_id': 75, 'user_name': 'Joseph Allen', 'total_spent': Decimal('1698.21')}, {'user_id': 18, 'user_name': 'Karen Hernandez', 'total_spent': Decimal('1647.01')}, {'user_id': 42, 'user_name': 'Emma Allen', 'total_spent': Decimal('1636.99')}, {'user_id': 88, 'user_name': 'Emily Sanders', 'total_spent': Decimal('1605.56')}, {'user_id': 60, 'user_name': 'Thomas Kelly', 'total_spent': Decimal('1577.76')}, {'user_id': 59, 'user_name': 'Amanda Martin', 'total_spent': Decimal('1518.10')}, {'user_id': 86, 'user_name': 'Brenda King', 'total_spent': Decimal('1452.79')}, {'user_id': 52, 'user_name': 'David Young', 'total_spent': Decimal('1432.14')}, {'user_id': 10, 'user_name': 'Jeffrey Torres', 'total_spent': Decimal('1419.98')}, {'user_id': 56, 'user_name': 'Jacob Brown', 'total_spent': Decimal('1392.73')}, {'user_id': 84, 'user_name': 'Dorothy Richardson', 'total_spent': Decimal('1205.16')}, {'user_id': 34, 'user_name': 'Timothy Murphy', 'total_spent': Decimal('1178.43')}, {'user_id': 62, 'user_name': 'Kathleen Wright', 'total_spent': Decimal('1139.72')}, {'user_id': 57, 'user_name': 'Mark Sanchez', 'total_spent': Decimal('1130.40')}, {'user_id': 51, 'user_name': 'Barbara Gonzalez', 'total_spent': Decimal('1064.15')}, {'user_id': 7, 'user_name': 'Elizabeth Bailey', 'total_spent': Decimal('1036.23')}, {'user_id': 11, 'user_name': 'William Green', 'total_spent': Decimal('1006.84')}, {'user_id': 80, 'user_name': 'Angela Collins', 'total_spent': Decimal('953.42')}, {'user_id': 65, 'user_name': 'Ronald Ross', 'total_spent': Decimal('928.57')}, {'user_id': 17, 'user_name': 'Dennis Kelly', 'total_spent': Decimal('804.74')}, {'user_id': 9, 'user_name': 'Andrew Reyes', 'total_spent': Decimal('559.03')}, {'user_id': 5, 'user_name': 'Pamela Patel', 'total_spent': Decimal('378.50')}, {'user_id': 23, 'user_name': 'Matthew Brown', 'total_spent': Decimal('364.87')}, {'user_id': 44, 'user_name': 'Lisa Robinson', 'total_spent': Decimal('246.24')}, {'user_id': 72, 'user_name': 'Michelle Nelson', 'total_spent': Decimal('110.36')}]",,EXTRA
"Which shipments are still in the ""preparing"" status for orders created before 2024-03-01?","SELECT s.shipment_id,
       s.shipment_order_id,
       s.shipment_status
FROM shipments AS s
JOIN orders AS o
    ON s.shipment_order_id = o.order_id
WHERE s.shipment_status = 'preparing'
  AND o.order_created_at < '2024-03-01';","[{'shipment_id': 13, 'shipment_order_id': 13, 'shipment_status': 'preparing'}, {'shipment_id': 34, 'shipment_order_id': 34, 'shipment_status': 'preparing'}, {'shipment_id': 43, 'shipment_order_id': 43, 'shipment_status': 'preparing'}, {'shipment_id': 72, 'shipment_order_id': 72, 'shipment_status': 'preparing'}, {'shipment_id': 127, 'shipment_order_id': 127, 'shipment_status': 'preparing'}, {'shipment_id': 204, 'shipment_order_id': 204, 'shipment_status': 'preparing'}, {'shipment_id': 226, 'shipment_order_id': 226, 'shipment_status': 'preparing'}, {'shipment_id': 240, 'shipment_order_id': 240, 'shipment_status': 'preparing'}]",,MEDIUM
List all products that have both tags and at least one review rating below 5.,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN product_tags AS pt
    ON pt.product_tag_product_id = p.product_id
JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE r.review_rating < 5;","[{'product_id': 159, 'product_name': 'Extension Cord'}, {'product_id': 118, 'product_name': 'Smartwatch'}, {'product_id': 176, 'product_name': 'Paint Roller'}, {'product_id': 188, 'product_name': 'Product 188'}, {'product_id': 148, 'product_name': 'Desk Mat'}, {'product_id': 28, 'product_name': 'Table'}, {'product_id': 14, 'product_name': 'Jacket'}, {'product_id': 133, 'product_name': 'External Hard Drive'}, {'product_id': 11, 'product_name': 'Mouse'}, {'product_id': 196, 'product_name': 'Product 196'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 13, 'product_name': 'Pants'}, {'product_id': 186, 'product_name': 'Product 186'}, {'product_id': 139, 'product_name': 'Screen Protector'}, {'product_id': 145, 'product_name': 'SSD'}, {'product_id': 83, 'product_name': 'Controller'}, {'product_id': 143, 'product_name': 'Graphics Card'}, {'product_id': 180, 'product_name': 'Nails'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 194, 'product_name': 'Product 194'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 1, 'product_name': 'Laptop'}, {'product_id': 187, 'product_name': 'Product 187'}, {'product_id': 30, 'product_name': 'Rug'}, {'product_id': 183, 'product_name': 'Hinges'}, {'product_id': 179, 'product_name': 'Wood Glue'}, {'product_id': 115, 'product_name': 'Backpack'}, {'product_id': 110, 'product_name': 'Sneakers'}, {'product_id': 178, 'product_name': 'Sandpaper'}, {'product_id': 169, 'product_name': 'Pliers'}, {'product_id': 117, 'product_name': 'Suitcase'}, {'product_id': 17, 'product_name': 'Dress'}, {'product_id': 97, 'product_name': 'Desk'}, {'product_id': 79, 'product_name': 'DVD'}, {'product_id': 146, 'product_name': 'Cooling Fan'}]",,HARD
Which users have made a return request that was later approved?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN returns AS r
    ON r.return_user_id = u.user_id
WHERE r.return_status = 'approved';","[{'user_id': 12, 'user_name': 'Sharon Carter'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}, {'user_id': 78, 'user_name': 'William Reed'}]",,MEDIUM
Which products received reviews in 2024 with an average rating greater than 7?,"SELECT p.product_id,
       p.product_name,
       AVG(r.review_rating) AS avg_rating
FROM products AS p
JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE r.review_created_at >= '2024-01-01'
  AND r.review_created_at < '2025-01-01'
GROUP BY p.product_id, p.product_name
HAVING AVG(r.review_rating) > 7
ORDER BY avg_rating DESC;","[{'product_id': 200, 'product_name': 'Product 200', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 164, 'product_name': 'Lantern', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 105, 'product_name': 'Baby Monitor', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 55, 'product_name': 'Hair Dryer', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 192, 'product_name': 'Product 192', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 174, 'product_name': 'Respirator', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 92, 'product_name': 'Blender', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 182, 'product_name': 'Anchors', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 129, 'product_name': 'Smartphone', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 199, 'product_name': 'Product 199', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 154, 'product_name': 'Thermostat', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 24, 'product_name': 'Comic', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 19, 'product_name': 'Jeans', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 38, 'product_name': 'Tennis Racket', 'avg_rating': Decimal('10.0000000000000000')}, {'product_id': 149, 'product_name': 'Monitor Arm', 'avg_rating': Decimal('9.6666666666666667')}, {'product_id': 63, 'product_name': 'Pasta', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 20, 'product_name': 'Socks', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 88, 'product_name': 'Tent', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 46, 'product_name': 'Board Game', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 96, 'product_name': 'Cookware', 'avg_rating': Decimal('9.5000000000000000')}, {'product_id': 137, 'product_name': 'Switch', 'avg_rating': Decimal('9.3333333333333333')}, {'product_id': 56, 'product_name': 'Car Battery', 'avg_rating': Decimal('9.2500000000000000')}, {'product_id': 136, 'product_name': 'Router', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 100, 'product_name': 'Dresser', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 157, 'product_name': 'Fan', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 130, 'product_name': 'Laptop Stand', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 45, 'product_name': 'Puzzle', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 99, 'product_name': 'Bed Frame', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 112, 'product_name': 'Sandals', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 75, 'product_name': 'Thermometer', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 62, 'product_name': 'Snacks', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 114, 'product_name': 'Handbag', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 2, 'product_name': 'Phone', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 109, 'product_name': 'Earrings', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 42, 'product_name': 'Skateboard', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 90, 'product_name': 'Cooler', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 150, 'product_name': 'LED Strip', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 54, 'product_name': 'Makeup Kit', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 106, 'product_name': 'Necklace', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 197, 'product_name': 'Product 197', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 140, 'product_name': 'Phone Case', 'avg_rating': Decimal('9.0000000000000000')}, {'product_id': 128, 'product_name': 'Safety Vest', 'avg_rating': Decimal('8.7500000000000000')}, {'product_id': 107, 'product_name': 'Ring', 'avg_rating': Decimal('8.6666666666666667')}, {'product_id': 48, 'product_name': 'LEGO Set', 'avg_rating': Decimal('8.6666666666666667')}, {'product_id': 34, 'product_name': 'Mirror', 'avg_rating': Decimal('8.6666666666666667')}, {'product_id': 33, 'product_name': 'Vase', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 49, 'product_name': 'RC Car', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 57, 'product_name': 'Oil Filter', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 9, 'product_name': 'Monitor', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 78, 'product_name': 'Drum Set', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 193, 'product_name': 'Product 193', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 31, 'product_name': 'Curtains', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 66, 'product_name': 'Cat Toy', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 8, 'product_name': 'TV', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 41, 'product_name': 'Bike', 'avg_rating': Decimal('8.5000000000000000')}, {'product_id': 10, 'product_name': 'Keyboard', 'avg_rating': Decimal('8.3333333333333333')}, {'product_id': 4, 'product_name': 'Headphones', 'avg_rating': Decimal('8.3333333333333333')}, {'product_id': 95, 'product_name': 'Knife Set', 'avg_rating': Decimal('8.3333333333333333')}, {'product_id': 97, 'product_name': 'Desk', 'avg_rating': Decimal('8.2500000000000000')}, {'product_id': 116, 'product_name': 'Wallet', 'avg_rating': Decimal('8.2000000000000000')}, {'product_id': 185, 'product_name': 'Product 185', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 67, 'product_name': 'Leash', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 93, 'product_name': 'Toaster', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 104, 'product_name': 'Car Seat', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 16, 'product_name': 'Hat', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 131, 'product_name': 'USB Cable', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 21, 'product_name': 'Novel', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 77, 'product_name': 'Microphone', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 152, 'product_name': 'Security Camera', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 153, 'product_name': 'Doorbell', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 108, 'product_name': 'Bracelet', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 191, 'product_name': 'Product 191', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 177, 'product_name': 'Paintbrush', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 101, 'product_name': 'Nightstand', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 52, 'product_name': 'Shampoo', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 58, 'product_name': 'Tire', 'avg_rating': Decimal('8.0000000000000000')}, {'product_id': 22, 'product_name': 'Textbook', 'avg_rating': Decimal('7.8000000000000000')}, {'product_id': 176, 'product_name': 'Paint Roller', 'avg_rating': Decimal('7.7500000000000000')}, {'product_id': 61, 'product_name': 'Tea', 'avg_rating': Decimal('7.6666666666666667')}, {'product_id': 145, 'product_name': 'SSD', 'avg_rating': Decimal('7.6666666666666667')}, {'product_id': 120, 'product_name': 'Wall Art', 'avg_rating': Decimal('7.6666666666666667')}, {'product_id': 5, 'product_name': 'Speaker', 'avg_rating': Decimal('7.6666666666666667')}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'avg_rating': Decimal('7.6666666666666667')}, {'product_id': 6, 'product_name': 'Camera', 'avg_rating': Decimal('7.6666666666666667')}, {'product_id': 123, 'product_name': 'Paint Set', 'avg_rating': Decimal('7.5000000000000000')}, {'product_id': 68, 'product_name': 'Pet Bed', 'avg_rating': Decimal('7.5000000000000000')}, {'product_id': 18, 'product_name': 'Sweater', 'avg_rating': Decimal('7.5000000000000000')}, {'product_id': 73, 'product_name': 'Vitamins', 'avg_rating': Decimal('7.5000000000000000')}, {'product_id': 40, 'product_name': 'Dumbbell', 'avg_rating': Decimal('7.5000000000000000')}, {'product_id': 69, 'product_name': 'Notebook', 'avg_rating': Decimal('7.5000000000000000')}, {'product_id': 1, 'product_name': 'Laptop', 'avg_rating': Decimal('7.4285714285714286')}, {'product_id': 117, 'product_name': 'Suitcase', 'avg_rating': Decimal('7.3333333333333333')}, {'product_id': 50, 'product_name': 'Lipstick', 'avg_rating': Decimal('7.3333333333333333')}, {'product_id': 47, 'product_name': 'Doll', 'avg_rating': Decimal('7.3333333333333333')}, {'product_id': 76, 'product_name': 'Guitar', 'avg_rating': Decimal('7.2500000000000000')}]",,EXTRA
Which categories include products that have never been added to any wishlist?,"SELECT DISTINCT c.category_id,
       c.category_name
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
JOIN products AS p
    ON p.product_id = cp.category_product_product_id
LEFT JOIN wishlist_items AS wi
    ON wi.wishlist_item_product_id = p.product_id
WHERE wi.wishlist_item_id IS NULL;","[{'category_id': 1, 'category_name': 'Electronics'}, {'category_id': 2, 'category_name': 'Clothing'}, {'category_id': 3, 'category_name': 'Books'}, {'category_id': 4, 'category_name': 'Home & Garden'}, {'category_id': 5, 'category_name': 'Sports'}, {'category_id': 6, 'category_name': 'Toys'}, {'category_id': 7, 'category_name': 'Beauty'}, {'category_id': 8, 'category_name': 'Automotive'}, {'category_id': 9, 'category_name': 'Food'}, {'category_id': 10, 'category_name': 'Pet Supplies'}, {'category_id': 11, 'category_name': 'Office'}, {'category_id': 12, 'category_name': 'Health'}, {'category_id': 13, 'category_name': 'Music'}, {'category_id': 14, 'category_name': 'Movies'}, {'category_id': 15, 'category_name': 'Games'}, {'category_id': 16, 'category_name': 'Tools'}, {'category_id': 17, 'category_name': 'Outdoor'}, {'category_id': 18, 'category_name': 'Kitchen'}, {'category_id': 19, 'category_name': 'Furniture'}, {'category_id': 20, 'category_name': 'Baby'}, {'category_id': 21, 'category_name': 'Jewelry'}, {'category_id': 22, 'category_name': 'Shoes'}, {'category_id': 23, 'category_name': 'Bags'}, {'category_id': 24, 'category_name': 'Watches'}, {'category_id': 25, 'category_name': 'Art'}, {'category_id': 26, 'category_name': 'Crafts'}, {'category_id': 27, 'category_name': 'Party Supplies'}, {'category_id': 28, 'category_name': 'Industrial'}, {'category_id': 29, 'category_name': 'Phones'}, {'category_id': 30, 'category_name': 'Computers'}]",,HARD
Which users placed orders that used more than one coupon?,"SELECT u.user_id,
       u.user_name,
       o.order_id,
       COUNT(oc.order_coupon_id) AS coupon_count
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN order_coupons AS oc
    ON oc.order_coupon_order_id = o.order_id
GROUP BY u.user_id, u.user_name, o.order_id
HAVING COUNT(oc.order_coupon_id) > 1;",[],,HARD
Which vendors supply products that have received no reviews at all?,"SELECT DISTINCT v.vendor_id,
       v.vendor_name
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN products AS p
    ON p.product_id = pv.product_vendor_product_id
LEFT JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE r.review_id IS NULL;","[{'vendor_id': 1, 'vendor_name': 'Vendor Corp 1'}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2'}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3'}, {'vendor_id': 4, 'vendor_name': 'Vendor LLC 4'}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5'}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8'}, {'vendor_id': 9, 'vendor_name': 'Vendor Group 9'}, {'vendor_id': 10, 'vendor_name': 'Vendor Group 10'}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12'}, {'vendor_id': 13, 'vendor_name': 'Vendor Corp 13'}, {'vendor_id': 16, 'vendor_name': 'Vendor LLC 16'}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17'}, {'vendor_id': 18, 'vendor_name': 'Vendor Industries 18'}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19'}, {'vendor_id': 20, 'vendor_name': 'Vendor Enterprises 20'}, {'vendor_id': 22, 'vendor_name': 'Vendor Industries 22'}, {'vendor_id': 23, 'vendor_name': 'Vendor Enterprises 23'}, {'vendor_id': 24, 'vendor_name': 'Vendor LLC 24'}, {'vendor_id': 26, 'vendor_name': 'Vendor LLC 26'}, {'vendor_id': 28, 'vendor_name': 'Vendor Supply Co 28'}, {'vendor_id': 29, 'vendor_name': 'Vendor Corp 29'}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30'}, {'vendor_id': 31, 'vendor_name': 'Vendor Enterprises 31'}, {'vendor_id': 32, 'vendor_name': 'Vendor Industries 32'}, {'vendor_id': 35, 'vendor_name': 'Vendor Supply Co 35'}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36'}, {'vendor_id': 38, 'vendor_name': 'Vendor Corp 38'}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39'}, {'vendor_id': 41, 'vendor_name': 'Vendor Group 41'}, {'vendor_id': 42, 'vendor_name': 'Vendor Supply Co 42'}, {'vendor_id': 43, 'vendor_name': 'Vendor Enterprises 43'}, {'vendor_id': 44, 'vendor_name': 'Vendor Group 44'}, {'vendor_id': 45, 'vendor_name': 'Vendor Industries 45'}, {'vendor_id': 49, 'vendor_name': 'Vendor LLC 49'}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50'}]",,HARD
Which tags are used on more than 8 products?,"SELECT t.tag_id,
       t.tag_name,
       COUNT(pt.product_tag_product_id) AS product_count
FROM tags AS t
JOIN product_tags AS pt
    ON pt.product_tag_tag_id = t.tag_id
GROUP BY t.tag_id, t.tag_name
HAVING COUNT(pt.product_tag_product_id) > 8
ORDER BY product_count DESC;","[{'tag_id': 5, 'tag_name': 'Trending', 'product_count': 26}, {'tag_id': 32, 'tag_name': 'Indoor', 'product_count': 19}, {'tag_id': 19, 'tag_name': 'Classic', 'product_count': 19}, {'tag_id': 27, 'tag_name': 'Portable', 'product_count': 18}, {'tag_id': 31, 'tag_name': 'Outdoor', 'product_count': 18}, {'tag_id': 25, 'tag_name': 'Wireless', 'product_count': 18}, {'tag_id': 24, 'tag_name': 'Compact', 'product_count': 18}, {'tag_id': 35, 'tag_name': 'Organic', 'product_count': 18}, {'tag_id': 50, 'tag_name': 'Bundle', 'product_count': 18}, {'tag_id': 21, 'tag_name': 'Affordable', 'product_count': 17}, {'tag_id': 23, 'tag_name': 'Lightweight', 'product_count': 17}, {'tag_id': 18, 'tag_name': 'Modern', 'product_count': 17}, {'tag_id': 12, 'tag_name': 'Seasonal', 'product_count': 17}, {'tag_id': 37, 'tag_name': 'Imported', 'product_count': 17}, {'tag_id': 13, 'tag_name': 'Holiday', 'product_count': 17}, {'tag_id': 14, 'tag_name': 'Gift', 'product_count': 17}, {'tag_id': 34, 'tag_name': 'Rechargeable', 'product_count': 16}, {'tag_id': 28, 'tag_name': 'Professional', 'product_count': 16}, {'tag_id': 29, 'tag_name': 'Beginner', 'product_count': 15}, {'tag_id': 42, 'tag_name': 'Innovative', 'product_count': 15}, {'tag_id': 39, 'tag_name': 'Bestseller', 'product_count': 15}, {'tag_id': 44, 'tag_name': 'Contemporary', 'product_count': 15}, {'tag_id': 41, 'tag_name': 'Award Winning', 'product_count': 15}, {'tag_id': 38, 'tag_name': 'Domestic', 'product_count': 14}, {'tag_id': 40, 'tag_name': 'Top Rated', 'product_count': 14}, {'tag_id': 36, 'tag_name': 'Natural', 'product_count': 14}, {'tag_id': 15, 'tag_name': 'Eco-Friendly', 'product_count': 13}, {'tag_id': 47, 'tag_name': 'Personalized', 'product_count': 13}, {'tag_id': 9, 'tag_name': 'Budget', 'product_count': 13}, {'tag_id': 46, 'tag_name': 'Custom', 'product_count': 13}, {'tag_id': 3, 'tag_name': 'Popular', 'product_count': 13}, {'tag_id': 7, 'tag_name': 'Exclusive', 'product_count': 13}, {'tag_id': 6, 'tag_name': 'Limited', 'product_count': 13}, {'tag_id': 49, 'tag_name': 'Sample', 'product_count': 12}, {'tag_id': 43, 'tag_name': 'Retro', 'product_count': 12}, {'tag_id': 33, 'tag_name': 'Waterproof', 'product_count': 12}, {'tag_id': 16, 'tag_name': 'Handmade', 'product_count': 12}, {'tag_id': 4, 'tag_name': 'Featured', 'product_count': 12}, {'tag_id': 22, 'tag_name': 'Durable', 'product_count': 12}, {'tag_id': 30, 'tag_name': 'Advanced', 'product_count': 11}, {'tag_id': 26, 'tag_name': 'Smart', 'product_count': 11}, {'tag_id': 1, 'tag_name': 'New', 'product_count': 11}, {'tag_id': 11, 'tag_name': 'Clearance', 'product_count': 10}, {'tag_id': 2, 'tag_name': 'Sale', 'product_count': 10}, {'tag_id': 10, 'tag_name': 'Best Seller', 'product_count': 9}, {'tag_id': 45, 'tag_name': 'Designer', 'product_count': 9}]",,HARD
Which orders have at least one item priced above $200?,"SELECT DISTINCT o.order_id,
       o.order_user_id
FROM orders AS o
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
WHERE oi.order_item_price > 200.00;","[{'order_id': 91, 'order_user_id': 13}, {'order_id': 190, 'order_user_id': 33}, {'order_id': 84, 'order_user_id': 33}, {'order_id': 266, 'order_user_id': 15}, {'order_id': 254, 'order_user_id': 34}, {'order_id': 87, 'order_user_id': 51}, {'order_id': 140, 'order_user_id': 21}, {'order_id': 103, 'order_user_id': 26}, {'order_id': 70, 'order_user_id': 37}, {'order_id': 185, 'order_user_id': 89}, {'order_id': 149, 'order_user_id': 68}, {'order_id': 97, 'order_user_id': 12}, {'order_id': 173, 'order_user_id': 83}, {'order_id': 44, 'order_user_id': 46}, {'order_id': 284, 'order_user_id': 71}, {'order_id': 267, 'order_user_id': 51}, {'order_id': 202, 'order_user_id': 43}, {'order_id': 295, 'order_user_id': 40}, {'order_id': 269, 'order_user_id': 33}, {'order_id': 137, 'order_user_id': 88}, {'order_id': 112, 'order_user_id': 44}, {'order_id': 105, 'order_user_id': 15}, {'order_id': 209, 'order_user_id': 53}, {'order_id': 167, 'order_user_id': 29}, {'order_id': 250, 'order_user_id': 72}, {'order_id': 148, 'order_user_id': 11}, {'order_id': 89, 'order_user_id': 75}, {'order_id': 287, 'order_user_id': 25}, {'order_id': 30, 'order_user_id': 17}, {'order_id': 101, 'order_user_id': 52}, {'order_id': 85, 'order_user_id': 39}, {'order_id': 63, 'order_user_id': 10}, {'order_id': 244, 'order_user_id': 26}, {'order_id': 177, 'order_user_id': 22}, {'order_id': 201, 'order_user_id': 82}, {'order_id': 258, 'order_user_id': 57}, {'order_id': 111, 'order_user_id': 63}, {'order_id': 60, 'order_user_id': 65}, {'order_id': 249, 'order_user_id': 39}, {'order_id': 92, 'order_user_id': 45}, {'order_id': 3, 'order_user_id': 55}, {'order_id': 296, 'order_user_id': 55}, {'order_id': 2, 'order_user_id': 59}, {'order_id': 54, 'order_user_id': 10}, {'order_id': 219, 'order_user_id': 24}, {'order_id': 100, 'order_user_id': 1}, {'order_id': 65, 'order_user_id': 37}, {'order_id': 131, 'order_user_id': 32}, {'order_id': 289, 'order_user_id': 30}, {'order_id': 280, 'order_user_id': 47}, {'order_id': 174, 'order_user_id': 71}, {'order_id': 263, 'order_user_id': 35}, {'order_id': 96, 'order_user_id': 71}, {'order_id': 230, 'order_user_id': 15}, {'order_id': 117, 'order_user_id': 22}, {'order_id': 179, 'order_user_id': 16}, {'order_id': 217, 'order_user_id': 38}, {'order_id': 5, 'order_user_id': 46}, {'order_id': 31, 'order_user_id': 68}, {'order_id': 285, 'order_user_id': 81}, {'order_id': 171, 'order_user_id': 77}, {'order_id': 68, 'order_user_id': 62}, {'order_id': 83, 'order_user_id': 35}, {'order_id': 51, 'order_user_id': 71}, {'order_id': 12, 'order_user_id': 14}, {'order_id': 265, 'order_user_id': 56}, {'order_id': 291, 'order_user_id': 70}, {'order_id': 233, 'order_user_id': 38}, {'order_id': 160, 'order_user_id': 73}, {'order_id': 192, 'order_user_id': 20}, {'order_id': 207, 'order_user_id': 61}, {'order_id': 256, 'order_user_id': 47}, {'order_id': 109, 'order_user_id': 64}, {'order_id': 93, 'order_user_id': 41}, {'order_id': 239, 'order_user_id': 69}, {'order_id': 130, 'order_user_id': 59}, {'order_id': 75, 'order_user_id': 61}, {'order_id': 154, 'order_user_id': 76}, {'order_id': 116, 'order_user_id': 86}, {'order_id': 69, 'order_user_id': 50}, {'order_id': 46, 'order_user_id': 43}, {'order_id': 14, 'order_user_id': 40}, {'order_id': 272, 'order_user_id': 64}, {'order_id': 76, 'order_user_id': 50}, {'order_id': 282, 'order_user_id': 49}, {'order_id': 225, 'order_user_id': 67}, {'order_id': 242, 'order_user_id': 8}, {'order_id': 159, 'order_user_id': 79}, {'order_id': 110, 'order_user_id': 44}, {'order_id': 169, 'order_user_id': 66}, {'order_id': 221, 'order_user_id': 38}, {'order_id': 18, 'order_user_id': 65}, {'order_id': 214, 'order_user_id': 64}, {'order_id': 195, 'order_user_id': 24}, {'order_id': 43, 'order_user_id': 45}, {'order_id': 176, 'order_user_id': 64}, {'order_id': 74, 'order_user_id': 78}, {'order_id': 45, 'order_user_id': 14}, {'order_id': 227, 'order_user_id': 84}, {'order_id': 203, 'order_user_id': 52}, {'order_id': 248, 'order_user_id': 78}, {'order_id': 121, 'order_user_id': 67}, {'order_id': 165, 'order_user_id': 25}, {'order_id': 48, 'order_user_id': 35}, {'order_id': 220, 'order_user_id': 4}, {'order_id': 198, 'order_user_id': 21}, {'order_id': 199, 'order_user_id': 42}, {'order_id': 277, 'order_user_id': 46}, {'order_id': 157, 'order_user_id': 41}, {'order_id': 175, 'order_user_id': 9}, {'order_id': 170, 'order_user_id': 61}, {'order_id': 20, 'order_user_id': 15}, {'order_id': 42, 'order_user_id': 86}, {'order_id': 21, 'order_user_id': 22}, {'order_id': 210, 'order_user_id': 25}, {'order_id': 64, 'order_user_id': 72}, {'order_id': 106, 'order_user_id': 6}, {'order_id': 119, 'order_user_id': 89}, {'order_id': 36, 'order_user_id': 33}, {'order_id': 212, 'order_user_id': 3}, {'order_id': 61, 'order_user_id': 41}, {'order_id': 19, 'order_user_id': 60}, {'order_id': 235, 'order_user_id': 73}, {'order_id': 57, 'order_user_id': 7}, {'order_id': 123, 'order_user_id': 66}, {'order_id': 22, 'order_user_id': 46}, {'order_id': 241, 'order_user_id': 3}, {'order_id': 292, 'order_user_id': 60}, {'order_id': 246, 'order_user_id': 14}, {'order_id': 222, 'order_user_id': 66}, {'order_id': 134, 'order_user_id': 45}, {'order_id': 257, 'order_user_id': 52}, {'order_id': 125, 'order_user_id': 69}, {'order_id': 211, 'order_user_id': 6}, {'order_id': 107, 'order_user_id': 45}, {'order_id': 38, 'order_user_id': 44}, {'order_id': 156, 'order_user_id': 83}, {'order_id': 39, 'order_user_id': 35}, {'order_id': 122, 'order_user_id': 16}, {'order_id': 104, 'order_user_id': 21}, {'order_id': 270, 'order_user_id': 75}, {'order_id': 236, 'order_user_id': 54}, {'order_id': 23, 'order_user_id': 21}, {'order_id': 184, 'order_user_id': 61}, {'order_id': 32, 'order_user_id': 40}, {'order_id': 240, 'order_user_id': 4}, {'order_id': 153, 'order_user_id': 73}, {'order_id': 15, 'order_user_id': 19}, {'order_id': 299, 'order_user_id': 51}, {'order_id': 151, 'order_user_id': 34}, {'order_id': 247, 'order_user_id': 89}, {'order_id': 6, 'order_user_id': 19}, {'order_id': 180, 'order_user_id': 18}, {'order_id': 168, 'order_user_id': 88}, {'order_id': 90, 'order_user_id': 33}, {'order_id': 113, 'order_user_id': 67}, {'order_id': 28, 'order_user_id': 80}, {'order_id': 1, 'order_user_id': 21}, {'order_id': 67, 'order_user_id': 33}, {'order_id': 297, 'order_user_id': 13}, {'order_id': 294, 'order_user_id': 18}, {'order_id': 228, 'order_user_id': 23}, {'order_id': 200, 'order_user_id': 34}, {'order_id': 206, 'order_user_id': 1}, {'order_id': 55, 'order_user_id': 38}, {'order_id': 238, 'order_user_id': 72}, {'order_id': 208, 'order_user_id': 35}, {'order_id': 182, 'order_user_id': 17}, {'order_id': 127, 'order_user_id': 6}, {'order_id': 275, 'order_user_id': 26}, {'order_id': 245, 'order_user_id': 77}, {'order_id': 59, 'order_user_id': 14}, {'order_id': 49, 'order_user_id': 88}, {'order_id': 34, 'order_user_id': 61}, {'order_id': 191, 'order_user_id': 28}, {'order_id': 162, 'order_user_id': 42}, {'order_id': 253, 'order_user_id': 64}, {'order_id': 33, 'order_user_id': 24}, {'order_id': 183, 'order_user_id': 18}, {'order_id': 88, 'order_user_id': 78}, {'order_id': 26, 'order_user_id': 6}, {'order_id': 290, 'order_user_id': 65}, {'order_id': 58, 'order_user_id': 46}, {'order_id': 216, 'order_user_id': 15}, {'order_id': 24, 'order_user_id': 37}, {'order_id': 152, 'order_user_id': 50}, {'order_id': 158, 'order_user_id': 36}, {'order_id': 142, 'order_user_id': 47}, {'order_id': 25, 'order_user_id': 40}, {'order_id': 215, 'order_user_id': 83}, {'order_id': 136, 'order_user_id': 77}, {'order_id': 264, 'order_user_id': 33}, {'order_id': 213, 'order_user_id': 26}, {'order_id': 86, 'order_user_id': 13}, {'order_id': 82, 'order_user_id': 26}, {'order_id': 218, 'order_user_id': 13}, {'order_id': 188, 'order_user_id': 62}, {'order_id': 114, 'order_user_id': 79}, {'order_id': 62, 'order_user_id': 13}, {'order_id': 164, 'order_user_id': 78}, {'order_id': 161, 'order_user_id': 77}, {'order_id': 79, 'order_user_id': 7}, {'order_id': 40, 'order_user_id': 27}, {'order_id': 7, 'order_user_id': 54}, {'order_id': 271, 'order_user_id': 37}, {'order_id': 10, 'order_user_id': 35}, {'order_id': 186, 'order_user_id': 73}, {'order_id': 187, 'order_user_id': 37}, {'order_id': 286, 'order_user_id': 42}, {'order_id': 197, 'order_user_id': 11}, {'order_id': 138, 'order_user_id': 81}, {'order_id': 50, 'order_user_id': 54}, {'order_id': 9, 'order_user_id': 86}, {'order_id': 229, 'order_user_id': 60}, {'order_id': 181, 'order_user_id': 67}, {'order_id': 95, 'order_user_id': 70}, {'order_id': 226, 'order_user_id': 27}, {'order_id': 262, 'order_user_id': 82}, {'order_id': 255, 'order_user_id': 48}, {'order_id': 251, 'order_user_id': 16}, {'order_id': 118, 'order_user_id': 83}, {'order_id': 223, 'order_user_id': 70}, {'order_id': 56, 'order_user_id': 41}, {'order_id': 124, 'order_user_id': 81}, {'order_id': 273, 'order_user_id': 30}, {'order_id': 281, 'order_user_id': 67}, {'order_id': 243, 'order_user_id': 73}, {'order_id': 234, 'order_user_id': 54}, {'order_id': 261, 'order_user_id': 41}, {'order_id': 276, 'order_user_id': 22}, {'order_id': 293, 'order_user_id': 37}, {'order_id': 298, 'order_user_id': 13}, {'order_id': 283, 'order_user_id': 20}, {'order_id': 47, 'order_user_id': 51}, {'order_id': 274, 'order_user_id': 80}, {'order_id': 205, 'order_user_id': 71}, {'order_id': 133, 'order_user_id': 20}, {'order_id': 166, 'order_user_id': 71}, {'order_id': 259, 'order_user_id': 47}, {'order_id': 224, 'order_user_id': 50}, {'order_id': 193, 'order_user_id': 86}, {'order_id': 163, 'order_user_id': 40}, {'order_id': 16, 'order_user_id': 85}]",,MEDIUM
Which users have saved at least 3 unique products across all their wishlists?,"SELECT u.user_id,
       u.user_name,
       COUNT(DISTINCT wi.wishlist_item_product_id) AS unique_products
FROM users AS u
JOIN wishlist AS w
    ON w.wishlist_user_id = u.user_id
JOIN wishlist_items AS wi
    ON wi.wishlist_item_wishlist_id = w.wishlist_id
GROUP BY u.user_id, u.user_name
HAVING COUNT(DISTINCT wi.wishlist_item_product_id) >= 3;","[{'user_id': 2, 'user_name': 'Joseph Gutierrez', 'unique_products': 7}, {'user_id': 3, 'user_name': 'Ashley Green', 'unique_products': 7}, {'user_id': 5, 'user_name': 'Pamela Patel', 'unique_products': 6}, {'user_id': 7, 'user_name': 'Elizabeth Bailey', 'unique_products': 3}, {'user_id': 8, 'user_name': 'Anthony Foster', 'unique_products': 11}, {'user_id': 9, 'user_name': 'Andrew Reyes', 'unique_products': 7}, {'user_id': 11, 'user_name': 'William Green', 'unique_products': 9}, {'user_id': 13, 'user_name': 'Melissa Nelson', 'unique_products': 3}, {'user_id': 16, 'user_name': 'Raymond Ruiz', 'unique_products': 4}, {'user_id': 22, 'user_name': 'Frank Martin', 'unique_products': 11}, {'user_id': 23, 'user_name': 'Matthew Brown', 'unique_products': 4}, {'user_id': 25, 'user_name': 'Emily Robinson', 'unique_products': 12}, {'user_id': 28, 'user_name': 'Anna Thompson', 'unique_products': 10}, {'user_id': 29, 'user_name': 'Jeffrey Davis', 'unique_products': 5}, {'user_id': 35, 'user_name': 'Carolyn Adams', 'unique_products': 3}, {'user_id': 36, 'user_name': 'Michael Cooper', 'unique_products': 6}, {'user_id': 41, 'user_name': 'Donald Hughes', 'unique_products': 4}, {'user_id': 44, 'user_name': 'Lisa Robinson', 'unique_products': 8}, {'user_id': 47, 'user_name': 'Margaret Clark', 'unique_products': 12}, {'user_id': 54, 'user_name': 'Scott Howard', 'unique_products': 4}, {'user_id': 56, 'user_name': 'Jacob Brown', 'unique_products': 10}, {'user_id': 57, 'user_name': 'Mark Sanchez', 'unique_products': 7}, {'user_id': 59, 'user_name': 'Amanda Martin', 'unique_products': 6}, {'user_id': 60, 'user_name': 'Thomas Kelly', 'unique_products': 3}, {'user_id': 68, 'user_name': 'Larry Stewart', 'unique_products': 5}, {'user_id': 69, 'user_name': 'Gary Kim', 'unique_products': 10}, {'user_id': 74, 'user_name': 'Scott Ortiz', 'unique_products': 5}, {'user_id': 79, 'user_name': 'Mark Evans', 'unique_products': 8}, {'user_id': 81, 'user_name': 'Jennifer Morales', 'unique_products': 4}, {'user_id': 87, 'user_name': 'Jacob Lopez', 'unique_products': 5}, {'user_id': 88, 'user_name': 'Emily Sanders', 'unique_products': 5}, {'user_id': 90, 'user_name': 'John Ward', 'unique_products': 8}, {'user_id': 95, 'user_name': 'Anthony Mitchell', 'unique_products': 6}, {'user_id': 100, 'user_name': 'Carolyn Ward', 'unique_products': 3}]",,HARD
Which shipments were delivered to ZIP codes starting with '90'?,"SELECT s.shipment_id,
       s.shipment_order_id,
       a.address_zip
FROM shipments AS s
JOIN addresses AS a
    ON s.shipment_address_id = a.address_id
WHERE s.shipment_status = 'delivered'
  AND a.address_zip LIKE '90%';",[],,MEDIUM
Which products have active discounts on 2024-11-01 and also appear in at least one category?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN product_discounts AS pd
    ON pd.product_discount_product_id = p.product_id
JOIN discounts AS d
    ON d.discount_id = pd.product_discount_discount_id
JOIN category_products AS cp
    ON cp.category_product_product_id = p.product_id
WHERE '2024-11-01' BETWEEN d.discount_start_date AND d.discount_end_date;","[{'product_id': 43, 'product_name': 'Helmet'}, {'product_id': 109, 'product_name': 'Earrings'}, {'product_id': 116, 'product_name': 'Wallet'}, {'product_id': 115, 'product_name': 'Backpack'}, {'product_id': 4, 'product_name': 'Headphones'}, {'product_id': 198, 'product_name': 'Product 198'}, {'product_id': 200, 'product_name': 'Product 200'}, {'product_id': 81, 'product_name': 'Video Game'}, {'product_id': 54, 'product_name': 'Makeup Kit'}, {'product_id': 196, 'product_name': 'Product 196'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 191, 'product_name': 'Product 191'}, {'product_id': 105, 'product_name': 'Baby Monitor'}, {'product_id': 24, 'product_name': 'Comic'}, {'product_id': 16, 'product_name': 'Hat'}, {'product_id': 13, 'product_name': 'Pants'}, {'product_id': 137, 'product_name': 'Switch'}, {'product_id': 73, 'product_name': 'Vitamins'}, {'product_id': 3, 'product_name': 'Tablet'}, {'product_id': 172, 'product_name': 'Safety Glasses'}, {'product_id': 164, 'product_name': 'Lantern'}, {'product_id': 15, 'product_name': 'Shoes'}, {'product_id': 195, 'product_name': 'Product 195'}, {'product_id': 193, 'product_name': 'Product 193'}, {'product_id': 94, 'product_name': 'Coffee Maker'}, {'product_id': 91, 'product_name': 'Backpack'}, {'product_id': 97, 'product_name': 'Desk'}, {'product_id': 131, 'product_name': 'USB Cable'}, {'product_id': 147, 'product_name': 'Mousepad'}, {'product_id': 28, 'product_name': 'Table'}, {'product_id': 79, 'product_name': 'DVD'}, {'product_id': 1, 'product_name': 'Laptop'}, {'product_id': 14, 'product_name': 'Jacket'}, {'product_id': 139, 'product_name': 'Screen Protector'}, {'product_id': 50, 'product_name': 'Lipstick'}, {'product_id': 187, 'product_name': 'Product 187'}, {'product_id': 158, 'product_name': 'Heater'}, {'product_id': 87, 'product_name': 'Screwdriver Set'}, {'product_id': 86, 'product_name': 'Saw'}, {'product_id': 70, 'product_name': 'Pen Set'}, {'product_id': 61, 'product_name': 'Tea'}, {'product_id': 83, 'product_name': 'Controller'}, {'product_id': 149, 'product_name': 'Monitor Arm'}, {'product_id': 128, 'product_name': 'Safety Vest'}, {'product_id': 39, 'product_name': 'Yoga Mat'}, {'product_id': 143, 'product_name': 'Graphics Card'}, {'product_id': 101, 'product_name': 'Nightstand'}, {'product_id': 197, 'product_name': 'Product 197'}, {'product_id': 124, 'product_name': 'Balloons'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 59, 'product_name': 'Wiper Blades'}, {'product_id': 46, 'product_name': 'Board Game'}, {'product_id': 75, 'product_name': 'Thermometer'}, {'product_id': 185, 'product_name': 'Product 185'}]",,HARD
Which users have had at least one payment transaction fail for their orders?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN payments AS p
    ON p.payment_order_id = o.order_id
JOIN transactions AS t
    ON t.transaction_payment_id = p.payment_id
WHERE t.transaction_status = 'failed';","[{'user_id': 23, 'user_name': 'Matthew Brown'}, {'user_id': 8, 'user_name': 'Anthony Foster'}, {'user_id': 15, 'user_name': 'Lisa Lopez'}, {'user_id': 80, 'user_name': 'Angela Collins'}, {'user_id': 73, 'user_name': 'Richard Reed'}, {'user_id': 40, 'user_name': 'Sandra Garcia'}, {'user_id': 21, 'user_name': 'Richard Scott'}, {'user_id': 26, 'user_name': 'Nicole Anderson'}, {'user_id': 48, 'user_name': 'Elizabeth Richardson'}, {'user_id': 33, 'user_name': 'Jonathan Chavez'}, {'user_id': 52, 'user_name': 'David Young'}, {'user_id': 45, 'user_name': 'Brian Martinez'}, {'user_id': 5, 'user_name': 'Pamela Patel'}, {'user_id': 54, 'user_name': 'Scott Howard'}, {'user_id': 44, 'user_name': 'Lisa Robinson'}, {'user_id': 51, 'user_name': 'Barbara Gonzalez'}, {'user_id': 22, 'user_name': 'Frank Martin'}, {'user_id': 66, 'user_name': 'Timothy Wood'}, {'user_id': 71, 'user_name': 'Kathleen Baker'}, {'user_id': 47, 'user_name': 'Margaret Clark'}, {'user_id': 60, 'user_name': 'Thomas Kelly'}, {'user_id': 24, 'user_name': 'Emily James'}, {'user_id': 88, 'user_name': 'Emily Sanders'}, {'user_id': 38, 'user_name': 'Rebecca Lopez'}, {'user_id': 64, 'user_name': 'Samuel Peterson'}, {'user_id': 78, 'user_name': 'William Reed'}, {'user_id': 81, 'user_name': 'Jennifer Morales'}, {'user_id': 20, 'user_name': 'Carolyn Torres'}, {'user_id': 19, 'user_name': 'Andrew Torres'}, {'user_id': 16, 'user_name': 'Raymond Ruiz'}, {'user_id': 79, 'user_name': 'Mark Evans'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}, {'user_id': 34, 'user_name': 'Timothy Murphy'}, {'user_id': 10, 'user_name': 'Jeffrey Torres'}, {'user_id': 6, 'user_name': 'Heather Murphy'}, {'user_id': 41, 'user_name': 'Donald Hughes'}, {'user_id': 3, 'user_name': 'Ashley Green'}, {'user_id': 70, 'user_name': 'Scott Brooks'}, {'user_id': 77, 'user_name': 'Christine James'}, {'user_id': 13, 'user_name': 'Melissa Nelson'}, {'user_id': 67, 'user_name': 'Sandra Harris'}, {'user_id': 46, 'user_name': 'Brenda Diaz'}, {'user_id': 27, 'user_name': 'Justin Morgan'}, {'user_id': 83, 'user_name': 'Sarah Foster'}, {'user_id': 89, 'user_name': 'Rebecca Moore'}, {'user_id': 84, 'user_name': 'Dorothy Richardson'}, {'user_id': 25, 'user_name': 'Emily Robinson'}, {'user_id': 61, 'user_name': 'Michael Bailey'}, {'user_id': 82, 'user_name': 'Edward Diaz'}, {'user_id': 11, 'user_name': 'William Green'}, {'user_id': 9, 'user_name': 'Andrew Reyes'}, {'user_id': 72, 'user_name': 'Michelle Nelson'}, {'user_id': 7, 'user_name': 'Elizabeth Bailey'}, {'user_id': 37, 'user_name': 'Lisa Kim'}, {'user_id': 35, 'user_name': 'Carolyn Adams'}, {'user_id': 42, 'user_name': 'Emma Allen'}, {'user_id': 55, 'user_name': 'Christine Hughes'}, {'user_id': 86, 'user_name': 'Brenda King'}, {'user_id': 2, 'user_name': 'Joseph Gutierrez'}, {'user_id': 4, 'user_name': 'Kenneth Castillo'}]",,HARD
"Which products received at least one review with a rating of 10, and how many perfect-score reviews did each receive?","SELECT p.product_id,
       p.product_name,
       COUNT(r.review_id) AS perfect_reviews
FROM products AS p
JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE r.review_rating = 10
GROUP BY p.product_id, p.product_name
ORDER BY perfect_reviews DESC;","[{'product_id': 38, 'product_name': 'Tennis Racket', 'perfect_reviews': 3}, {'product_id': 19, 'product_name': 'Jeans', 'perfect_reviews': 3}, {'product_id': 97, 'product_name': 'Desk', 'perfect_reviews': 2}, {'product_id': 116, 'product_name': 'Wallet', 'perfect_reviews': 2}, {'product_id': 149, 'product_name': 'Monitor Arm', 'perfect_reviews': 2}, {'product_id': 22, 'product_name': 'Textbook', 'perfect_reviews': 2}, {'product_id': 200, 'product_name': 'Product 200', 'perfect_reviews': 2}, {'product_id': 31, 'product_name': 'Curtains', 'perfect_reviews': 2}, {'product_id': 199, 'product_name': 'Product 199', 'perfect_reviews': 2}, {'product_id': 117, 'product_name': 'Suitcase', 'perfect_reviews': 2}, {'product_id': 56, 'product_name': 'Car Battery', 'perfect_reviews': 2}, {'product_id': 182, 'product_name': 'Anchors', 'perfect_reviews': 2}, {'product_id': 176, 'product_name': 'Paint Roller', 'perfect_reviews': 1}, {'product_id': 92, 'product_name': 'Blender', 'perfect_reviews': 1}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'perfect_reviews': 1}, {'product_id': 128, 'product_name': 'Safety Vest', 'perfect_reviews': 1}, {'product_id': 194, 'product_name': 'Product 194', 'perfect_reviews': 1}, {'product_id': 73, 'product_name': 'Vitamins', 'perfect_reviews': 1}, {'product_id': 99, 'product_name': 'Bed Frame', 'perfect_reviews': 1}, {'product_id': 88, 'product_name': 'Tent', 'perfect_reviews': 1}, {'product_id': 41, 'product_name': 'Bike', 'perfect_reviews': 1}, {'product_id': 40, 'product_name': 'Dumbbell', 'perfect_reviews': 1}, {'product_id': 46, 'product_name': 'Board Game', 'perfect_reviews': 1}, {'product_id': 157, 'product_name': 'Fan', 'perfect_reviews': 1}, {'product_id': 120, 'product_name': 'Wall Art', 'perfect_reviews': 1}, {'product_id': 100, 'product_name': 'Dresser', 'perfect_reviews': 1}, {'product_id': 196, 'product_name': 'Product 196', 'perfect_reviews': 1}, {'product_id': 48, 'product_name': 'LEGO Set', 'perfect_reviews': 1}, {'product_id': 187, 'product_name': 'Product 187', 'perfect_reviews': 1}, {'product_id': 164, 'product_name': 'Lantern', 'perfect_reviews': 1}, {'product_id': 137, 'product_name': 'Switch', 'perfect_reviews': 1}, {'product_id': 95, 'product_name': 'Knife Set', 'perfect_reviews': 1}, {'product_id': 78, 'product_name': 'Drum Set', 'perfect_reviews': 1}, {'product_id': 57, 'product_name': 'Oil Filter', 'perfect_reviews': 1}, {'product_id': 24, 'product_name': 'Comic', 'perfect_reviews': 1}, {'product_id': 61, 'product_name': 'Tea', 'perfect_reviews': 1}, {'product_id': 154, 'product_name': 'Thermostat', 'perfect_reviews': 1}, {'product_id': 30, 'product_name': 'Rug', 'perfect_reviews': 1}, {'product_id': 49, 'product_name': 'RC Car', 'perfect_reviews': 1}, {'product_id': 47, 'product_name': 'Doll', 'perfect_reviews': 1}, {'product_id': 20, 'product_name': 'Socks', 'perfect_reviews': 1}, {'product_id': 33, 'product_name': 'Vase', 'perfect_reviews': 1}, {'product_id': 1, 'product_name': 'Laptop', 'perfect_reviews': 1}, {'product_id': 110, 'product_name': 'Sneakers', 'perfect_reviews': 1}, {'product_id': 178, 'product_name': 'Sandpaper', 'perfect_reviews': 1}, {'product_id': 55, 'product_name': 'Hair Dryer', 'perfect_reviews': 1}, {'product_id': 145, 'product_name': 'SSD', 'perfect_reviews': 1}, {'product_id': 129, 'product_name': 'Smartphone', 'perfect_reviews': 1}, {'product_id': 148, 'product_name': 'Desk Mat', 'perfect_reviews': 1}, {'product_id': 104, 'product_name': 'Car Seat', 'perfect_reviews': 1}, {'product_id': 179, 'product_name': 'Wood Glue', 'perfect_reviews': 1}, {'product_id': 68, 'product_name': 'Pet Bed', 'perfect_reviews': 1}, {'product_id': 34, 'product_name': 'Mirror', 'perfect_reviews': 1}, {'product_id': 96, 'product_name': 'Cookware', 'perfect_reviews': 1}, {'product_id': 63, 'product_name': 'Pasta', 'perfect_reviews': 1}, {'product_id': 10, 'product_name': 'Keyboard', 'perfect_reviews': 1}, {'product_id': 105, 'product_name': 'Baby Monitor', 'perfect_reviews': 1}, {'product_id': 174, 'product_name': 'Respirator', 'perfect_reviews': 1}, {'product_id': 6, 'product_name': 'Camera', 'perfect_reviews': 1}, {'product_id': 107, 'product_name': 'Ring', 'perfect_reviews': 1}, {'product_id': 192, 'product_name': 'Product 192', 'perfect_reviews': 1}]",,HARD
Which users placed orders totaling more than $500 in March 2024?,"SELECT u.user_id,
       u.user_name,
       SUM(o.order_total) AS total_spent
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
WHERE o.order_created_at >= '2024-03-01'
  AND o.order_created_at < '2024-04-01'
GROUP BY u.user_id, u.user_name
HAVING SUM(o.order_total) > 500.00
ORDER BY total_spent DESC;","[{'user_id': 21, 'user_name': 'Richard Scott', 'total_spent': Decimal('4647.35')}, {'user_id': 54, 'user_name': 'Scott Howard', 'total_spent': Decimal('2992.96')}, {'user_id': 36, 'user_name': 'Michael Cooper', 'total_spent': Decimal('2646.22')}, {'user_id': 64, 'user_name': 'Samuel Peterson', 'total_spent': Decimal('2293.08')}, {'user_id': 46, 'user_name': 'Brenda Diaz', 'total_spent': Decimal('2186.99')}, {'user_id': 35, 'user_name': 'Carolyn Adams', 'total_spent': Decimal('2064.48')}, {'user_id': 6, 'user_name': 'Heather Murphy', 'total_spent': Decimal('2032.45')}, {'user_id': 49, 'user_name': 'Jason Hill', 'total_spent': Decimal('1850.89')}, {'user_id': 62, 'user_name': 'Kathleen Wright', 'total_spent': Decimal('1733.98')}, {'user_id': 56, 'user_name': 'Jacob Brown', 'total_spent': Decimal('1668.85')}, {'user_id': 77, 'user_name': 'Christine James', 'total_spent': Decimal('1565.14')}, {'user_id': 50, 'user_name': 'Stephanie Lopez', 'total_spent': Decimal('1317.40')}, {'user_id': 43, 'user_name': 'Donna White', 'total_spent': Decimal('1174.99')}, {'user_id': 52, 'user_name': 'David Young', 'total_spent': Decimal('836.18')}, {'user_id': 40, 'user_name': 'Sandra Garcia', 'total_spent': Decimal('740.97')}, {'user_id': 83, 'user_name': 'Sarah Foster', 'total_spent': Decimal('527.43')}]",,EXTRA
Which products were added in 2024 and have been included in at least one delivered order?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN order_items AS oi
    ON oi.order_item_product_id = p.product_id
JOIN orders AS o
    ON o.order_id = oi.order_item_order_id
WHERE p.product_created_at >= '2024-01-01'
  AND p.product_created_at < '2025-01-01'
  AND o.order_status = 'delivered';","[{'product_id': 104, 'product_name': 'Car Seat'}, {'product_id': 146, 'product_name': 'Cooling Fan'}, {'product_id': 109, 'product_name': 'Earrings'}, {'product_id': 120, 'product_name': 'Wall Art'}, {'product_id': 159, 'product_name': 'Extension Cord'}, {'product_id': 154, 'product_name': 'Thermostat'}, {'product_id': 118, 'product_name': 'Smartwatch'}, {'product_id': 4, 'product_name': 'Headphones'}, {'product_id': 38, 'product_name': 'Tennis Racket'}, {'product_id': 81, 'product_name': 'Video Game'}, {'product_id': 200, 'product_name': 'Product 200'}, {'product_id': 127, 'product_name': 'Warehouse Shelving'}, {'product_id': 19, 'product_name': 'Jeans'}, {'product_id': 69, 'product_name': 'Notebook'}, {'product_id': 60, 'product_name': 'Coffee'}, {'product_id': 166, 'product_name': 'Tape Measure'}, {'product_id': 24, 'product_name': 'Comic'}, {'product_id': 176, 'product_name': 'Paint Roller'}, {'product_id': 78, 'product_name': 'Drum Set'}, {'product_id': 188, 'product_name': 'Product 188'}, {'product_id': 177, 'product_name': 'Paintbrush'}, {'product_id': 18, 'product_name': 'Sweater'}, {'product_id': 136, 'product_name': 'Router'}, {'product_id': 15, 'product_name': 'Shoes'}, {'product_id': 44, 'product_name': 'Action Figure'}, {'product_id': 102, 'product_name': 'Crib'}, {'product_id': 148, 'product_name': 'Desk Mat'}, {'product_id': 161, 'product_name': 'Battery Pack'}, {'product_id': 42, 'product_name': 'Skateboard'}, {'product_id': 150, 'product_name': 'LED Strip'}, {'product_id': 55, 'product_name': 'Hair Dryer'}, {'product_id': 28, 'product_name': 'Table'}, {'product_id': 165, 'product_name': 'Multi-tool'}, {'product_id': 111, 'product_name': 'Boots'}, {'product_id': 89, 'product_name': 'Sleeping Bag'}, {'product_id': 14, 'product_name': 'Jacket'}, {'product_id': 133, 'product_name': 'External Hard Drive'}, {'product_id': 184, 'product_name': 'Product 184'}, {'product_id': 47, 'product_name': 'Doll'}, {'product_id': 6, 'product_name': 'Camera'}, {'product_id': 82, 'product_name': 'Console'}, {'product_id': 112, 'product_name': 'Sandals'}, {'product_id': 87, 'product_name': 'Screwdriver Set'}, {'product_id': 11, 'product_name': 'Mouse'}, {'product_id': 135, 'product_name': 'Webcam'}, {'product_id': 107, 'product_name': 'Ring'}, {'product_id': 149, 'product_name': 'Monitor Arm'}, {'product_id': 5, 'product_name': 'Speaker'}, {'product_id': 41, 'product_name': 'Bike'}, {'product_id': 93, 'product_name': 'Toaster'}, {'product_id': 46, 'product_name': 'Board Game'}, {'product_id': 43, 'product_name': 'Helmet'}, {'product_id': 84, 'product_name': 'Drill'}, {'product_id': 35, 'product_name': 'Clock'}, {'product_id': 106, 'product_name': 'Necklace'}, {'product_id': 2, 'product_name': 'Phone'}, {'product_id': 48, 'product_name': 'LEGO Set'}, {'product_id': 51, 'product_name': 'Perfume'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 196, 'product_name': 'Product 196'}, {'product_id': 77, 'product_name': 'Microphone'}, {'product_id': 88, 'product_name': 'Tent'}, {'product_id': 152, 'product_name': 'Security Camera'}, {'product_id': 189, 'product_name': 'Product 189'}, {'product_id': 138, 'product_name': 'Cable Organizer'}, {'product_id': 56, 'product_name': 'Car Battery'}, {'product_id': 105, 'product_name': 'Baby Monitor'}, {'product_id': 191, 'product_name': 'Product 191'}, {'product_id': 16, 'product_name': 'Hat'}, {'product_id': 13, 'product_name': 'Pants'}, {'product_id': 95, 'product_name': 'Knife Set'}, {'product_id': 73, 'product_name': 'Vitamins'}, {'product_id': 34, 'product_name': 'Mirror'}, {'product_id': 172, 'product_name': 'Safety Glasses'}, {'product_id': 186, 'product_name': 'Product 186'}, {'product_id': 94, 'product_name': 'Coffee Maker'}, {'product_id': 96, 'product_name': 'Cookware'}, {'product_id': 131, 'product_name': 'USB Cable'}, {'product_id': 147, 'product_name': 'Mousepad'}, {'product_id': 57, 'product_name': 'Oil Filter'}, {'product_id': 192, 'product_name': 'Product 192'}, {'product_id': 139, 'product_name': 'Screen Protector'}, {'product_id': 123, 'product_name': 'Paint Set'}, {'product_id': 72, 'product_name': 'Filing Cabinet'}, {'product_id': 162, 'product_name': 'Solar Panel'}, {'product_id': 182, 'product_name': 'Anchors'}, {'product_id': 108, 'product_name': 'Bracelet'}, {'product_id': 26, 'product_name': 'Sofa'}, {'product_id': 83, 'product_name': 'Controller'}, {'product_id': 145, 'product_name': 'SSD'}, {'product_id': 39, 'product_name': 'Yoga Mat'}, {'product_id': 101, 'product_name': 'Nightstand'}, {'product_id': 10, 'product_name': 'Keyboard'}, {'product_id': 180, 'product_name': 'Nails'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 21, 'product_name': 'Novel'}, {'product_id': 116, 'product_name': 'Wallet'}, {'product_id': 25, 'product_name': 'Journal'}, {'product_id': 126, 'product_name': 'Wrapping Paper'}, {'product_id': 194, 'product_name': 'Product 194'}, {'product_id': 63, 'product_name': 'Pasta'}, {'product_id': 29, 'product_name': 'Lamp'}, {'product_id': 119, 'product_name': 'Fitness Tracker'}, {'product_id': 54, 'product_name': 'Makeup Kit'}, {'product_id': 151, 'product_name': 'Smart Bulb'}, {'product_id': 167, 'product_name': 'Level'}, {'product_id': 171, 'product_name': 'Work Gloves'}, {'product_id': 71, 'product_name': 'Stapler'}, {'product_id': 74, 'product_name': 'First Aid Kit'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 199, 'product_name': 'Product 199'}, {'product_id': 174, 'product_name': 'Respirator'}, {'product_id': 33, 'product_name': 'Vase'}, {'product_id': 98, 'product_name': 'Bookshelf'}, {'product_id': 137, 'product_name': 'Switch'}, {'product_id': 190, 'product_name': 'Product 190'}, {'product_id': 67, 'product_name': 'Leash'}, {'product_id': 27, 'product_name': 'Chair'}, {'product_id': 32, 'product_name': 'Plant'}, {'product_id': 91, 'product_name': 'Backpack'}, {'product_id': 23, 'product_name': 'Magazine'}, {'product_id': 140, 'product_name': 'Phone Case'}, {'product_id': 68, 'product_name': 'Pet Bed'}, {'product_id': 1, 'product_name': 'Laptop'}, {'product_id': 114, 'product_name': 'Handbag'}, {'product_id': 187, 'product_name': 'Product 187'}, {'product_id': 66, 'product_name': 'Cat Toy'}, {'product_id': 30, 'product_name': 'Rug'}, {'product_id': 9, 'product_name': 'Monitor'}, {'product_id': 160, 'product_name': 'Surge Protector'}, {'product_id': 20, 'product_name': 'Socks'}, {'product_id': 58, 'product_name': 'Tire'}, {'product_id': 183, 'product_name': 'Hinges'}, {'product_id': 92, 'product_name': 'Blender'}, {'product_id': 153, 'product_name': 'Doorbell'}, {'product_id': 75, 'product_name': 'Thermometer'}, {'product_id': 185, 'product_name': 'Product 185'}, {'product_id': 173, 'product_name': 'Ear Protection'}, {'product_id': 49, 'product_name': 'RC Car'}, {'product_id': 31, 'product_name': 'Curtains'}, {'product_id': 115, 'product_name': 'Backpack'}, {'product_id': 179, 'product_name': 'Wood Glue'}, {'product_id': 7, 'product_name': 'Watch'}, {'product_id': 110, 'product_name': 'Sneakers'}, {'product_id': 155, 'product_name': 'Air Purifier'}, {'product_id': 129, 'product_name': 'Smartphone'}, {'product_id': 134, 'product_name': 'Gaming Mouse'}, {'product_id': 122, 'product_name': 'Canvas'}, {'product_id': 168, 'product_name': 'Wrench Set'}, {'product_id': 178, 'product_name': 'Sandpaper'}, {'product_id': 53, 'product_name': 'Lotion'}, {'product_id': 169, 'product_name': 'Pliers'}, {'product_id': 117, 'product_name': 'Suitcase'}, {'product_id': 62, 'product_name': 'Snacks'}, {'product_id': 132, 'product_name': 'Power Bank'}, {'product_id': 36, 'product_name': 'Basketball'}, {'product_id': 85, 'product_name': 'Hammer'}, {'product_id': 17, 'product_name': 'Dress'}, {'product_id': 3, 'product_name': 'Tablet'}, {'product_id': 113, 'product_name': 'Loafers'}, {'product_id': 164, 'product_name': 'Lantern'}, {'product_id': 8, 'product_name': 'TV'}, {'product_id': 100, 'product_name': 'Dresser'}, {'product_id': 193, 'product_name': 'Product 193'}, {'product_id': 142, 'product_name': 'Bluetooth Adapter'}, {'product_id': 103, 'product_name': 'Stroller'}, {'product_id': 76, 'product_name': 'Guitar'}, {'product_id': 97, 'product_name': 'Desk'}, {'product_id': 90, 'product_name': 'Cooler'}, {'product_id': 79, 'product_name': 'DVD'}, {'product_id': 175, 'product_name': 'Ladder'}, {'product_id': 50, 'product_name': 'Lipstick'}, {'product_id': 157, 'product_name': 'Fan'}, {'product_id': 156, 'product_name': 'Humidifier'}, {'product_id': 158, 'product_name': 'Heater'}, {'product_id': 45, 'product_name': 'Puzzle'}, {'product_id': 86, 'product_name': 'Saw'}, {'product_id': 61, 'product_name': 'Tea'}, {'product_id': 144, 'product_name': 'RAM'}, {'product_id': 128, 'product_name': 'Safety Vest'}, {'product_id': 197, 'product_name': 'Product 197'}, {'product_id': 163, 'product_name': 'Flashlight'}]",,HARD
Which categories have products supplied by more than 3 distinct vendors?,"SELECT c.category_id,
       c.category_name,
       COUNT(DISTINCT pv.product_vendor_vendor_id) AS vendor_count
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
JOIN product_vendors AS pv
    ON pv.product_vendor_product_id = cp.category_product_product_id
GROUP BY c.category_id, c.category_name
HAVING COUNT(DISTINCT pv.product_vendor_vendor_id) > 3;","[{'category_id': 1, 'category_name': 'Electronics', 'vendor_count': 14}, {'category_id': 2, 'category_name': 'Clothing', 'vendor_count': 14}, {'category_id': 3, 'category_name': 'Books', 'vendor_count': 18}, {'category_id': 4, 'category_name': 'Home & Garden', 'vendor_count': 8}, {'category_id': 5, 'category_name': 'Sports', 'vendor_count': 24}, {'category_id': 6, 'category_name': 'Toys', 'vendor_count': 18}, {'category_id': 7, 'category_name': 'Beauty', 'vendor_count': 15}, {'category_id': 8, 'category_name': 'Automotive', 'vendor_count': 18}, {'category_id': 9, 'category_name': 'Food', 'vendor_count': 11}, {'category_id': 10, 'category_name': 'Pet Supplies', 'vendor_count': 21}, {'category_id': 11, 'category_name': 'Office', 'vendor_count': 10}, {'category_id': 12, 'category_name': 'Health', 'vendor_count': 17}, {'category_id': 13, 'category_name': 'Music', 'vendor_count': 15}, {'category_id': 14, 'category_name': 'Movies', 'vendor_count': 11}, {'category_id': 15, 'category_name': 'Games', 'vendor_count': 11}, {'category_id': 16, 'category_name': 'Tools', 'vendor_count': 19}, {'category_id': 17, 'category_name': 'Outdoor', 'vendor_count': 13}, {'category_id': 18, 'category_name': 'Kitchen', 'vendor_count': 17}, {'category_id': 19, 'category_name': 'Furniture', 'vendor_count': 21}, {'category_id': 20, 'category_name': 'Baby', 'vendor_count': 10}, {'category_id': 21, 'category_name': 'Jewelry', 'vendor_count': 16}, {'category_id': 22, 'category_name': 'Shoes', 'vendor_count': 14}, {'category_id': 23, 'category_name': 'Bags', 'vendor_count': 11}, {'category_id': 24, 'category_name': 'Watches', 'vendor_count': 15}, {'category_id': 25, 'category_name': 'Art', 'vendor_count': 12}, {'category_id': 26, 'category_name': 'Crafts', 'vendor_count': 8}, {'category_id': 27, 'category_name': 'Party Supplies', 'vendor_count': 12}, {'category_id': 28, 'category_name': 'Industrial', 'vendor_count': 14}, {'category_id': 29, 'category_name': 'Phones', 'vendor_count': 17}, {'category_id': 30, 'category_name': 'Computers', 'vendor_count': 15}]",,HARD
Which vendors supplied products that appear in more than 5 wishlists?,"SELECT v.vendor_id,
       v.vendor_name,
       COUNT(DISTINCT wi.wishlist_item_id) AS wishlist_mentions
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN products AS p
    ON p.product_id = pv.product_vendor_product_id
JOIN wishlist_items AS wi
    ON wi.wishlist_item_product_id = p.product_id
GROUP BY v.vendor_id, v.vendor_name
HAVING COUNT(DISTINCT wi.wishlist_item_id) > 5;","[{'vendor_id': 1, 'vendor_name': 'Vendor Corp 1', 'wishlist_mentions': 8}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2', 'wishlist_mentions': 7}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3', 'wishlist_mentions': 11}, {'vendor_id': 4, 'vendor_name': 'Vendor LLC 4', 'wishlist_mentions': 11}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5', 'wishlist_mentions': 7}, {'vendor_id': 6, 'vendor_name': 'Vendor LLC 6', 'wishlist_mentions': 6}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7', 'wishlist_mentions': 8}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8', 'wishlist_mentions': 9}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12', 'wishlist_mentions': 8}, {'vendor_id': 15, 'vendor_name': 'Vendor LLC 15', 'wishlist_mentions': 6}, {'vendor_id': 16, 'vendor_name': 'Vendor LLC 16', 'wishlist_mentions': 6}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17', 'wishlist_mentions': 8}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19', 'wishlist_mentions': 11}, {'vendor_id': 23, 'vendor_name': 'Vendor Enterprises 23', 'wishlist_mentions': 11}, {'vendor_id': 26, 'vendor_name': 'Vendor LLC 26', 'wishlist_mentions': 8}, {'vendor_id': 27, 'vendor_name': 'Vendor LLC 27', 'wishlist_mentions': 7}, {'vendor_id': 29, 'vendor_name': 'Vendor Corp 29', 'wishlist_mentions': 8}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30', 'wishlist_mentions': 10}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36', 'wishlist_mentions': 11}, {'vendor_id': 38, 'vendor_name': 'Vendor Corp 38', 'wishlist_mentions': 7}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39', 'wishlist_mentions': 16}, {'vendor_id': 40, 'vendor_name': 'Vendor Group 40', 'wishlist_mentions': 8}, {'vendor_id': 43, 'vendor_name': 'Vendor Enterprises 43', 'wishlist_mentions': 13}, {'vendor_id': 45, 'vendor_name': 'Vendor Industries 45', 'wishlist_mentions': 9}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50', 'wishlist_mentions': 10}]",,EXTRA
Which products have both active discounts on 2024-10-15 and at least one review with a rating below 4?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN product_discounts AS pd
    ON pd.product_discount_product_id = p.product_id
JOIN discounts AS d
    ON d.discount_id = pd.product_discount_discount_id
JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE '2024-10-15' BETWEEN d.discount_start_date AND d.discount_end_date
  AND r.review_rating < 4;","[{'product_id': 1, 'product_name': 'Laptop'}, {'product_id': 13, 'product_name': 'Pants'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 28, 'product_name': 'Table'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 115, 'product_name': 'Backpack'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 139, 'product_name': 'Screen Protector'}, {'product_id': 143, 'product_name': 'Graphics Card'}, {'product_id': 187, 'product_name': 'Product 187'}, {'product_id': 196, 'product_name': 'Product 196'}]",,HARD
Which shipments are linked to orders using at least one coupon?,"SELECT DISTINCT s.shipment_id,
       s.shipment_order_id,
       s.shipment_status
FROM shipments AS s
JOIN order_coupons AS oc
    ON oc.order_coupon_order_id = s.shipment_order_id;","[{'shipment_id': 213, 'shipment_order_id': 213, 'shipment_status': 'delivered'}, {'shipment_id': 171, 'shipment_order_id': 171, 'shipment_status': 'delivered'}, {'shipment_id': 276, 'shipment_order_id': 276, 'shipment_status': 'preparing'}, {'shipment_id': 202, 'shipment_order_id': 202, 'shipment_status': 'in_transit'}, {'shipment_id': 220, 'shipment_order_id': 220, 'shipment_status': 'delivered'}, {'shipment_id': 127, 'shipment_order_id': 127, 'shipment_status': 'preparing'}, {'shipment_id': 68, 'shipment_order_id': 68, 'shipment_status': 'preparing'}, {'shipment_id': 275, 'shipment_order_id': 275, 'shipment_status': 'delivered'}, {'shipment_id': 1, 'shipment_order_id': 1, 'shipment_status': 'delivered'}, {'shipment_id': 105, 'shipment_order_id': 105, 'shipment_status': 'in_transit'}, {'shipment_id': 172, 'shipment_order_id': 172, 'shipment_status': 'delivered'}, {'shipment_id': 169, 'shipment_order_id': 169, 'shipment_status': 'preparing'}, {'shipment_id': 288, 'shipment_order_id': 288, 'shipment_status': 'in_transit'}, {'shipment_id': 227, 'shipment_order_id': 227, 'shipment_status': 'in_transit'}, {'shipment_id': 21, 'shipment_order_id': 21, 'shipment_status': 'in_transit'}, {'shipment_id': 280, 'shipment_order_id': 280, 'shipment_status': 'preparing'}, {'shipment_id': 155, 'shipment_order_id': 155, 'shipment_status': 'in_transit'}, {'shipment_id': 123, 'shipment_order_id': 123, 'shipment_status': 'delivered'}, {'shipment_id': 199, 'shipment_order_id': 199, 'shipment_status': 'delivered'}, {'shipment_id': 137, 'shipment_order_id': 137, 'shipment_status': 'delivered'}, {'shipment_id': 128, 'shipment_order_id': 128, 'shipment_status': 'delivered'}, {'shipment_id': 238, 'shipment_order_id': 238, 'shipment_status': 'delivered'}, {'shipment_id': 52, 'shipment_order_id': 52, 'shipment_status': 'delivered'}, {'shipment_id': 201, 'shipment_order_id': 201, 'shipment_status': 'in_transit'}, {'shipment_id': 191, 'shipment_order_id': 191, 'shipment_status': 'in_transit'}, {'shipment_id': 132, 'shipment_order_id': 132, 'shipment_status': 'in_transit'}, {'shipment_id': 166, 'shipment_order_id': 166, 'shipment_status': 'delivered'}, {'shipment_id': 226, 'shipment_order_id': 226, 'shipment_status': 'preparing'}, {'shipment_id': 40, 'shipment_order_id': 40, 'shipment_status': 'preparing'}, {'shipment_id': 174, 'shipment_order_id': 174, 'shipment_status': 'preparing'}, {'shipment_id': 247, 'shipment_order_id': 247, 'shipment_status': 'delivered'}, {'shipment_id': 48, 'shipment_order_id': 48, 'shipment_status': 'in_transit'}, {'shipment_id': 225, 'shipment_order_id': 225, 'shipment_status': 'preparing'}, {'shipment_id': 46, 'shipment_order_id': 46, 'shipment_status': 'in_transit'}, {'shipment_id': 248, 'shipment_order_id': 248, 'shipment_status': 'preparing'}, {'shipment_id': 255, 'shipment_order_id': 255, 'shipment_status': 'delivered'}, {'shipment_id': 102, 'shipment_order_id': 102, 'shipment_status': 'preparing'}, {'shipment_id': 34, 'shipment_order_id': 34, 'shipment_status': 'preparing'}, {'shipment_id': 190, 'shipment_order_id': 190, 'shipment_status': 'preparing'}, {'shipment_id': 32, 'shipment_order_id': 32, 'shipment_status': 'in_transit'}, {'shipment_id': 149, 'shipment_order_id': 149, 'shipment_status': 'delivered'}, {'shipment_id': 87, 'shipment_order_id': 87, 'shipment_status': 'in_transit'}, {'shipment_id': 293, 'shipment_order_id': 293, 'shipment_status': 'delivered'}, {'shipment_id': 5, 'shipment_order_id': 5, 'shipment_status': 'delivered'}, {'shipment_id': 56, 'shipment_order_id': 56, 'shipment_status': 'in_transit'}, {'shipment_id': 14, 'shipment_order_id': 14, 'shipment_status': 'in_transit'}, {'shipment_id': 259, 'shipment_order_id': 259, 'shipment_status': 'delivered'}, {'shipment_id': 265, 'shipment_order_id': 265, 'shipment_status': 'delivered'}, {'shipment_id': 260, 'shipment_order_id': 260, 'shipment_status': 'delivered'}, {'shipment_id': 136, 'shipment_order_id': 136, 'shipment_status': 'in_transit'}, {'shipment_id': 208, 'shipment_order_id': 208, 'shipment_status': 'preparing'}, {'shipment_id': 24, 'shipment_order_id': 24, 'shipment_status': 'delivered'}, {'shipment_id': 228, 'shipment_order_id': 228, 'shipment_status': 'delivered'}, {'shipment_id': 163, 'shipment_order_id': 163, 'shipment_status': 'preparing'}, {'shipment_id': 129, 'shipment_order_id': 129, 'shipment_status': 'in_transit'}, {'shipment_id': 92, 'shipment_order_id': 92, 'shipment_status': 'preparing'}, {'shipment_id': 184, 'shipment_order_id': 184, 'shipment_status': 'in_transit'}, {'shipment_id': 26, 'shipment_order_id': 26, 'shipment_status': 'delivered'}, {'shipment_id': 173, 'shipment_order_id': 173, 'shipment_status': 'preparing'}, {'shipment_id': 160, 'shipment_order_id': 160, 'shipment_status': 'delivered'}, {'shipment_id': 282, 'shipment_order_id': 282, 'shipment_status': 'preparing'}, {'shipment_id': 240, 'shipment_order_id': 240, 'shipment_status': 'preparing'}, {'shipment_id': 158, 'shipment_order_id': 158, 'shipment_status': 'delivered'}, {'shipment_id': 15, 'shipment_order_id': 15, 'shipment_status': 'preparing'}, {'shipment_id': 63, 'shipment_order_id': 63, 'shipment_status': 'in_transit'}, {'shipment_id': 295, 'shipment_order_id': 295, 'shipment_status': 'delivered'}, {'shipment_id': 210, 'shipment_order_id': 210, 'shipment_status': 'delivered'}, {'shipment_id': 268, 'shipment_order_id': 268, 'shipment_status': 'in_transit'}, {'shipment_id': 161, 'shipment_order_id': 161, 'shipment_status': 'preparing'}, {'shipment_id': 110, 'shipment_order_id': 110, 'shipment_status': 'delivered'}, {'shipment_id': 130, 'shipment_order_id': 130, 'shipment_status': 'in_transit'}, {'shipment_id': 84, 'shipment_order_id': 84, 'shipment_status': 'preparing'}, {'shipment_id': 176, 'shipment_order_id': 176, 'shipment_status': 'in_transit'}, {'shipment_id': 170, 'shipment_order_id': 170, 'shipment_status': 'in_transit'}, {'shipment_id': 107, 'shipment_order_id': 107, 'shipment_status': 'in_transit'}, {'shipment_id': 292, 'shipment_order_id': 292, 'shipment_status': 'delivered'}, {'shipment_id': 33, 'shipment_order_id': 33, 'shipment_status': 'in_transit'}]",,MEDIUM
"Which users created wishlists that include products tagged with ""electronics""?","SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN wishlist AS w
    ON w.wishlist_user_id = u.user_id
JOIN wishlist_items AS wi
    ON wi.wishlist_item_wishlist_id = w.wishlist_id
JOIN product_tags AS pt
    ON pt.product_tag_product_id = wi.wishlist_item_product_id
JOIN tags AS t
    ON t.tag_id = pt.product_tag_tag_id
WHERE t.tag_name = 'electronics';",[],,EXTRA
Which payments were completed for orders created before 2024-02-01?,"SELECT p.payment_id,
       p.payment_order_id,
       p.payment_method,
       p.payment_status
FROM payments AS p
JOIN orders AS o
    ON o.order_id = p.payment_order_id
WHERE p.payment_status = 'completed'
  AND o.order_created_at < '2024-02-01';","[{'payment_id': 21, 'payment_order_id': 21, 'payment_method': 'credit_card', 'payment_status': 'completed'}, {'payment_id': 22, 'payment_order_id': 22, 'payment_method': 'google_pay', 'payment_status': 'completed'}, {'payment_id': 25, 'payment_order_id': 25, 'payment_method': 'paypal', 'payment_status': 'completed'}, {'payment_id': 27, 'payment_order_id': 27, 'payment_method': 'apple_pay', 'payment_status': 'completed'}, {'payment_id': 43, 'payment_order_id': 43, 'payment_method': 'apple_pay', 'payment_status': 'completed'}, {'payment_id': 55, 'payment_order_id': 55, 'payment_method': 'credit_card', 'payment_status': 'completed'}, {'payment_id': 61, 'payment_order_id': 61, 'payment_method': 'debit_card', 'payment_status': 'completed'}, {'payment_id': 69, 'payment_order_id': 69, 'payment_method': 'debit_card', 'payment_status': 'completed'}, {'payment_id': 78, 'payment_order_id': 78, 'payment_method': 'paypal', 'payment_status': 'completed'}, {'payment_id': 110, 'payment_order_id': 110, 'payment_method': 'credit_card', 'payment_status': 'completed'}, {'payment_id': 119, 'payment_order_id': 119, 'payment_method': 'apple_pay', 'payment_status': 'completed'}, {'payment_id': 124, 'payment_order_id': 124, 'payment_method': 'google_pay', 'payment_status': 'completed'}, {'payment_id': 132, 'payment_order_id': 132, 'payment_method': 'google_pay', 'payment_status': 'completed'}, {'payment_id': 136, 'payment_order_id': 136, 'payment_method': 'credit_card', 'payment_status': 'completed'}, {'payment_id': 137, 'payment_order_id': 137, 'payment_method': 'paypal', 'payment_status': 'completed'}, {'payment_id': 159, 'payment_order_id': 159, 'payment_method': 'debit_card', 'payment_status': 'completed'}, {'payment_id': 175, 'payment_order_id': 175, 'payment_method': 'apple_pay', 'payment_status': 'completed'}, {'payment_id': 183, 'payment_order_id': 183, 'payment_method': 'google_pay', 'payment_status': 'completed'}, {'payment_id': 187, 'payment_order_id': 187, 'payment_method': 'google_pay', 'payment_status': 'completed'}, {'payment_id': 199, 'payment_order_id': 199, 'payment_method': 'debit_card', 'payment_status': 'completed'}, {'payment_id': 204, 'payment_order_id': 204, 'payment_method': 'debit_card', 'payment_status': 'completed'}, {'payment_id': 238, 'payment_order_id': 238, 'payment_method': 'apple_pay', 'payment_status': 'completed'}, {'payment_id': 258, 'payment_order_id': 258, 'payment_method': 'paypal', 'payment_status': 'completed'}, {'payment_id': 285, 'payment_order_id': 285, 'payment_method': 'credit_card', 'payment_status': 'completed'}, {'payment_id': 292, 'payment_order_id': 292, 'payment_method': 'debit_card', 'payment_status': 'completed'}]",,MEDIUM
Which orders include products belonging to the category with category_id = 2?,"SELECT DISTINCT o.order_id,
       o.order_user_id
FROM orders AS o
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
JOIN category_products AS cp
    ON cp.category_product_product_id = oi.order_item_product_id
WHERE cp.category_product_category_id = 2;","[{'order_id': 131, 'order_user_id': 32}, {'order_id': 289, 'order_user_id': 30}, {'order_id': 292, 'order_user_id': 60}, {'order_id': 266, 'order_user_id': 15}, {'order_id': 211, 'order_user_id': 6}, {'order_id': 140, 'order_user_id': 21}, {'order_id': 107, 'order_user_id': 45}, {'order_id': 152, 'order_user_id': 50}, {'order_id': 70, 'order_user_id': 37}, {'order_id': 158, 'order_user_id': 36}, {'order_id': 149, 'order_user_id': 68}, {'order_id': 83, 'order_user_id': 35}, {'order_id': 51, 'order_user_id': 71}, {'order_id': 215, 'order_user_id': 83}, {'order_id': 73, 'order_user_id': 47}, {'order_id': 35, 'order_user_id': 62}, {'order_id': 136, 'order_user_id': 77}, {'order_id': 233, 'order_user_id': 38}, {'order_id': 173, 'order_user_id': 83}, {'order_id': 153, 'order_user_id': 73}, {'order_id': 188, 'order_user_id': 62}, {'order_id': 202, 'order_user_id': 43}, {'order_id': 295, 'order_user_id': 40}, {'order_id': 151, 'order_user_id': 34}, {'order_id': 137, 'order_user_id': 88}, {'order_id': 247, 'order_user_id': 89}, {'order_id': 161, 'order_user_id': 77}, {'order_id': 6, 'order_user_id': 19}, {'order_id': 37, 'order_user_id': 89}, {'order_id': 7, 'order_user_id': 54}, {'order_id': 69, 'order_user_id': 50}, {'order_id': 46, 'order_user_id': 43}, {'order_id': 180, 'order_user_id': 18}, {'order_id': 105, 'order_user_id': 15}, {'order_id': 209, 'order_user_id': 53}, {'order_id': 187, 'order_user_id': 37}, {'order_id': 1, 'order_user_id': 21}, {'order_id': 148, 'order_user_id': 11}, {'order_id': 286, 'order_user_id': 42}, {'order_id': 52, 'order_user_id': 78}, {'order_id': 50, 'order_user_id': 54}, {'order_id': 228, 'order_user_id': 23}, {'order_id': 200, 'order_user_id': 34}, {'order_id': 76, 'order_user_id': 50}, {'order_id': 63, 'order_user_id': 10}, {'order_id': 17, 'order_user_id': 70}, {'order_id': 55, 'order_user_id': 38}, {'order_id': 262, 'order_user_id': 82}, {'order_id': 169, 'order_user_id': 66}, {'order_id': 221, 'order_user_id': 38}, {'order_id': 18, 'order_user_id': 65}, {'order_id': 195, 'order_user_id': 24}, {'order_id': 127, 'order_user_id': 6}, {'order_id': 245, 'order_user_id': 77}, {'order_id': 124, 'order_user_id': 81}, {'order_id': 227, 'order_user_id': 84}, {'order_id': 146, 'order_user_id': 5}, {'order_id': 198, 'order_user_id': 21}, {'order_id': 277, 'order_user_id': 46}, {'order_id': 219, 'order_user_id': 24}, {'order_id': 253, 'order_user_id': 64}, {'order_id': 205, 'order_user_id': 71}, {'order_id': 42, 'order_user_id': 86}, {'order_id': 133, 'order_user_id': 20}, {'order_id': 224, 'order_user_id': 50}, {'order_id': 119, 'order_user_id': 89}, {'order_id': 193, 'order_user_id': 86}, {'order_id': 102, 'order_user_id': 49}, {'order_id': 235, 'order_user_id': 73}]",,HARD
Which products have been purchased in quantities totaling more than 20 units across all orders?,"SELECT p.product_id,
       p.product_name,
       SUM(oi.order_item_quantity) AS total_quantity
FROM products AS p
JOIN order_items AS oi
    ON oi.order_item_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING SUM(oi.order_item_quantity) > 20
ORDER BY total_quantity DESC;","[{'product_id': 97, 'product_name': 'Desk', 'total_quantity': 23}, {'product_id': 22, 'product_name': 'Textbook', 'total_quantity': 23}, {'product_id': 33, 'product_name': 'Vase', 'total_quantity': 22}, {'product_id': 155, 'product_name': 'Air Purifier', 'total_quantity': 21}]",,HARD
Which users have both written reviews and placed at least one order?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN reviews AS r
    ON r.review_user_id = u.user_id
JOIN orders AS o
    ON o.order_user_id = u.user_id;","[{'user_id': 8, 'user_name': 'Anthony Foster'}, {'user_id': 15, 'user_name': 'Lisa Lopez'}, {'user_id': 23, 'user_name': 'Matthew Brown'}, {'user_id': 80, 'user_name': 'Angela Collins'}, {'user_id': 73, 'user_name': 'Richard Reed'}, {'user_id': 40, 'user_name': 'Sandra Garcia'}, {'user_id': 21, 'user_name': 'Richard Scott'}, {'user_id': 26, 'user_name': 'Nicole Anderson'}, {'user_id': 33, 'user_name': 'Jonathan Chavez'}, {'user_id': 48, 'user_name': 'Elizabeth Richardson'}, {'user_id': 52, 'user_name': 'David Young'}, {'user_id': 45, 'user_name': 'Brian Martinez'}, {'user_id': 5, 'user_name': 'Pamela Patel'}, {'user_id': 54, 'user_name': 'Scott Howard'}, {'user_id': 17, 'user_name': 'Dennis Kelly'}, {'user_id': 44, 'user_name': 'Lisa Robinson'}, {'user_id': 85, 'user_name': 'Dennis Kim'}, {'user_id': 51, 'user_name': 'Barbara Gonzalez'}, {'user_id': 76, 'user_name': 'Emma Howard'}, {'user_id': 56, 'user_name': 'Jacob Brown'}, {'user_id': 69, 'user_name': 'Gary Kim'}, {'user_id': 22, 'user_name': 'Frank Martin'}, {'user_id': 39, 'user_name': 'Emma Hernandez'}, {'user_id': 30, 'user_name': 'Amanda Morales'}, {'user_id': 50, 'user_name': 'Stephanie Lopez'}, {'user_id': 66, 'user_name': 'Timothy Wood'}, {'user_id': 75, 'user_name': 'Joseph Allen'}, {'user_id': 71, 'user_name': 'Kathleen Baker'}, {'user_id': 47, 'user_name': 'Margaret Clark'}, {'user_id': 65, 'user_name': 'Ronald Ross'}, {'user_id': 88, 'user_name': 'Emily Sanders'}, {'user_id': 24, 'user_name': 'Emily James'}, {'user_id': 60, 'user_name': 'Thomas Kelly'}, {'user_id': 57, 'user_name': 'Mark Sanchez'}, {'user_id': 74, 'user_name': 'Scott Ortiz'}, {'user_id': 38, 'user_name': 'Rebecca Lopez'}, {'user_id': 64, 'user_name': 'Samuel Peterson'}, {'user_id': 68, 'user_name': 'Larry Stewart'}, {'user_id': 18, 'user_name': 'Karen Hernandez'}, {'user_id': 78, 'user_name': 'William Reed'}, {'user_id': 81, 'user_name': 'Jennifer Morales'}, {'user_id': 20, 'user_name': 'Carolyn Torres'}, {'user_id': 19, 'user_name': 'Andrew Torres'}, {'user_id': 16, 'user_name': 'Raymond Ruiz'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}, {'user_id': 79, 'user_name': 'Mark Evans'}, {'user_id': 34, 'user_name': 'Timothy Murphy'}, {'user_id': 49, 'user_name': 'Jason Hill'}, {'user_id': 10, 'user_name': 'Jeffrey Torres'}, {'user_id': 59, 'user_name': 'Amanda Martin'}, {'user_id': 6, 'user_name': 'Heather Murphy'}, {'user_id': 41, 'user_name': 'Donald Hughes'}, {'user_id': 3, 'user_name': 'Ashley Green'}, {'user_id': 70, 'user_name': 'Scott Brooks'}, {'user_id': 32, 'user_name': 'Jennifer Thompson'}, {'user_id': 77, 'user_name': 'Christine James'}, {'user_id': 13, 'user_name': 'Melissa Nelson'}, {'user_id': 62, 'user_name': 'Kathleen Wright'}, {'user_id': 67, 'user_name': 'Sandra Harris'}, {'user_id': 43, 'user_name': 'Donna White'}, {'user_id': 46, 'user_name': 'Brenda Diaz'}, {'user_id': 27, 'user_name': 'Justin Morgan'}, {'user_id': 83, 'user_name': 'Sarah Foster'}, {'user_id': 84, 'user_name': 'Dorothy Richardson'}, {'user_id': 89, 'user_name': 'Rebecca Moore'}, {'user_id': 25, 'user_name': 'Emily Robinson'}, {'user_id': 61, 'user_name': 'Michael Bailey'}, {'user_id': 82, 'user_name': 'Edward Diaz'}, {'user_id': 1, 'user_name': 'Andrew Thomas'}, {'user_id': 11, 'user_name': 'William Green'}, {'user_id': 63, 'user_name': 'Jeffrey Davis'}, {'user_id': 9, 'user_name': 'Andrew Reyes'}, {'user_id': 72, 'user_name': 'Michelle Nelson'}, {'user_id': 7, 'user_name': 'Elizabeth Bailey'}, {'user_id': 37, 'user_name': 'Lisa Kim'}, {'user_id': 35, 'user_name': 'Carolyn Adams'}, {'user_id': 42, 'user_name': 'Emma Allen'}, {'user_id': 29, 'user_name': 'Jeffrey Davis'}, {'user_id': 55, 'user_name': 'Christine Hughes'}, {'user_id': 86, 'user_name': 'Brenda King'}, {'user_id': 2, 'user_name': 'Joseph Gutierrez'}, {'user_id': 4, 'user_name': 'Kenneth Castillo'}]",,MEDIUM
Which products appear in carts with a total quantity greater than 3 for any single cart?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN cart_items AS ci
    ON ci.cart_item_product_id = p.product_id
JOIN cart AS c
    ON c.cart_id = ci.cart_item_cart_id
GROUP BY p.product_id, p.product_name, c.cart_id
HAVING SUM(ci.cart_item_quantity) > 3;",[],,HARD
Which vendors supply products that have been returned by users at least once?,"SELECT DISTINCT v.vendor_id,
       v.vendor_name
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN order_items AS oi
    ON oi.order_item_product_id = pv.product_vendor_product_id
JOIN returns AS r
    ON r.return_order_id = oi.order_item_order_id;","[{'vendor_id': 45, 'vendor_name': 'Vendor Industries 45'}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36'}, {'vendor_id': 41, 'vendor_name': 'Vendor Group 41'}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39'}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19'}, {'vendor_id': 43, 'vendor_name': 'Vendor Enterprises 43'}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5'}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30'}, {'vendor_id': 22, 'vendor_name': 'Vendor Industries 22'}, {'vendor_id': 20, 'vendor_name': 'Vendor Enterprises 20'}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7'}, {'vendor_id': 9, 'vendor_name': 'Vendor Group 9'}, {'vendor_id': 25, 'vendor_name': 'Vendor Group 25'}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50'}, {'vendor_id': 33, 'vendor_name': 'Vendor LLC 33'}, {'vendor_id': 6, 'vendor_name': 'Vendor LLC 6'}, {'vendor_id': 4, 'vendor_name': 'Vendor LLC 4'}, {'vendor_id': 34, 'vendor_name': 'Vendor Corp 34'}, {'vendor_id': 15, 'vendor_name': 'Vendor LLC 15'}, {'vendor_id': 18, 'vendor_name': 'Vendor Industries 18'}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2'}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8'}, {'vendor_id': 14, 'vendor_name': 'Vendor Corp 14'}, {'vendor_id': 49, 'vendor_name': 'Vendor LLC 49'}, {'vendor_id': 1, 'vendor_name': 'Vendor Corp 1'}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3'}, {'vendor_id': 29, 'vendor_name': 'Vendor Corp 29'}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17'}, {'vendor_id': 27, 'vendor_name': 'Vendor LLC 27'}, {'vendor_id': 40, 'vendor_name': 'Vendor Group 40'}]",,HARD
Which categories contain products that have received an average review rating below 6?,"SELECT DISTINCT c.category_id,
       c.category_name
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
JOIN products AS p
    ON p.product_id = cp.category_product_product_id
JOIN reviews AS r
    ON r.review_product_id = p.product_id
GROUP BY c.category_id, c.category_name, p.product_id
HAVING AVG(r.review_rating) < 6;","[{'category_id': 5, 'category_name': 'Sports'}, {'category_id': 7, 'category_name': 'Beauty'}, {'category_id': 3, 'category_name': 'Books'}, {'category_id': 13, 'category_name': 'Music'}, {'category_id': 11, 'category_name': 'Office'}, {'category_id': 22, 'category_name': 'Shoes'}, {'category_id': 4, 'category_name': 'Home & Garden'}, {'category_id': 17, 'category_name': 'Outdoor'}, {'category_id': 15, 'category_name': 'Games'}, {'category_id': 18, 'category_name': 'Kitchen'}, {'category_id': 8, 'category_name': 'Automotive'}, {'category_id': 19, 'category_name': 'Furniture'}, {'category_id': 6, 'category_name': 'Toys'}, {'category_id': 10, 'category_name': 'Pet Supplies'}, {'category_id': 27, 'category_name': 'Party Supplies'}, {'category_id': 1, 'category_name': 'Electronics'}, {'category_id': 26, 'category_name': 'Crafts'}, {'category_id': 12, 'category_name': 'Health'}]",,HARD
Which orders have a shipment that is still not delivered?,"SELECT DISTINCT o.order_id,
       o.order_user_id,
       s.shipment_status
FROM orders AS o
JOIN shipments AS s
    ON s.shipment_order_id = o.order_id
WHERE s.shipment_status <> 'delivered';","[{'order_id': 243, 'order_user_id': 73, 'shipment_status': 'preparing'}, {'order_id': 153, 'order_user_id': 73, 'shipment_status': 'in_transit'}, {'order_id': 105, 'order_user_id': 15, 'shipment_status': 'in_transit'}, {'order_id': 268, 'order_user_id': 27, 'shipment_status': 'in_transit'}, {'order_id': 144, 'order_user_id': 68, 'shipment_status': 'preparing'}, {'order_id': 87, 'order_user_id': 51, 'shipment_status': 'in_transit'}, {'order_id': 173, 'order_user_id': 83, 'shipment_status': 'preparing'}, {'order_id': 72, 'order_user_id': 17, 'shipment_status': 'preparing'}, {'order_id': 279, 'order_user_id': 10, 'shipment_status': 'in_transit'}, {'order_id': 30, 'order_user_id': 17, 'shipment_status': 'in_transit'}, {'order_id': 204, 'order_user_id': 14, 'shipment_status': 'preparing'}, {'order_id': 70, 'order_user_id': 37, 'shipment_status': 'in_transit'}, {'order_id': 56, 'order_user_id': 41, 'shipment_status': 'in_transit'}, {'order_id': 169, 'order_user_id': 66, 'shipment_status': 'preparing'}, {'order_id': 164, 'order_user_id': 78, 'shipment_status': 'preparing'}, {'order_id': 127, 'order_user_id': 6, 'shipment_status': 'preparing'}, {'order_id': 264, 'order_user_id': 33, 'shipment_status': 'in_transit'}, {'order_id': 43, 'order_user_id': 45, 'shipment_status': 'preparing'}, {'order_id': 67, 'order_user_id': 33, 'shipment_status': 'in_transit'}, {'order_id': 280, 'order_user_id': 47, 'shipment_status': 'preparing'}, {'order_id': 84, 'order_user_id': 33, 'shipment_status': 'preparing'}, {'order_id': 186, 'order_user_id': 73, 'shipment_status': 'in_transit'}, {'order_id': 185, 'order_user_id': 89, 'shipment_status': 'in_transit'}, {'order_id': 205, 'order_user_id': 71, 'shipment_status': 'preparing'}, {'order_id': 226, 'order_user_id': 27, 'shipment_status': 'preparing'}, {'order_id': 147, 'order_user_id': 37, 'shipment_status': 'in_transit'}, {'order_id': 191, 'order_user_id': 28, 'shipment_status': 'in_transit'}, {'order_id': 216, 'order_user_id': 15, 'shipment_status': 'preparing'}, {'order_id': 101, 'order_user_id': 52, 'shipment_status': 'in_transit'}, {'order_id': 37, 'order_user_id': 89, 'shipment_status': 'in_transit'}, {'order_id': 257, 'order_user_id': 52, 'shipment_status': 'in_transit'}, {'order_id': 267, 'order_user_id': 51, 'shipment_status': 'in_transit'}, {'order_id': 57, 'order_user_id': 7, 'shipment_status': 'preparing'}, {'order_id': 253, 'order_user_id': 64, 'shipment_status': 'in_transit'}, {'order_id': 16, 'order_user_id': 85, 'shipment_status': 'preparing'}, {'order_id': 89, 'order_user_id': 75, 'shipment_status': 'preparing'}, {'order_id': 28, 'order_user_id': 80, 'shipment_status': 'in_transit'}, {'order_id': 181, 'order_user_id': 67, 'shipment_status': 'preparing'}, {'order_id': 231, 'order_user_id': 15, 'shipment_status': 'in_transit'}, {'order_id': 190, 'order_user_id': 33, 'shipment_status': 'preparing'}, {'order_id': 189, 'order_user_id': 20, 'shipment_status': 'in_transit'}, {'order_id': 274, 'order_user_id': 80, 'shipment_status': 'in_transit'}, {'order_id': 27, 'order_user_id': 35, 'shipment_status': 'in_transit'}, {'order_id': 104, 'order_user_id': 21, 'shipment_status': 'preparing'}, {'order_id': 148, 'order_user_id': 11, 'shipment_status': 'preparing'}, {'order_id': 83, 'order_user_id': 35, 'shipment_status': 'in_transit'}, {'order_id': 20, 'order_user_id': 15, 'shipment_status': 'preparing'}, {'order_id': 15, 'order_user_id': 19, 'shipment_status': 'preparing'}, {'order_id': 230, 'order_user_id': 15, 'shipment_status': 'preparing'}, {'order_id': 161, 'order_user_id': 77, 'shipment_status': 'preparing'}, {'order_id': 156, 'order_user_id': 83, 'shipment_status': 'preparing'}, {'order_id': 206, 'order_user_id': 1, 'shipment_status': 'preparing'}, {'order_id': 283, 'order_user_id': 20, 'shipment_status': 'preparing'}, {'order_id': 194, 'order_user_id': 64, 'shipment_status': 'in_transit'}, {'order_id': 209, 'order_user_id': 53, 'shipment_status': 'preparing'}, {'order_id': 168, 'order_user_id': 88, 'shipment_status': 'in_transit'}, {'order_id': 48, 'order_user_id': 35, 'shipment_status': 'in_transit'}, {'order_id': 201, 'order_user_id': 82, 'shipment_status': 'in_transit'}, {'order_id': 225, 'order_user_id': 67, 'shipment_status': 'preparing'}, {'order_id': 106, 'order_user_id': 6, 'shipment_status': 'preparing'}, {'order_id': 136, 'order_user_id': 77, 'shipment_status': 'in_transit'}, {'order_id': 117, 'order_user_id': 22, 'shipment_status': 'in_transit'}, {'order_id': 65, 'order_user_id': 37, 'shipment_status': 'in_transit'}, {'order_id': 46, 'order_user_id': 43, 'shipment_status': 'in_transit'}, {'order_id': 50, 'order_user_id': 54, 'shipment_status': 'in_transit'}, {'order_id': 29, 'order_user_id': 83, 'shipment_status': 'in_transit'}, {'order_id': 36, 'order_user_id': 33, 'shipment_status': 'preparing'}, {'order_id': 207, 'order_user_id': 61, 'shipment_status': 'in_transit'}, {'order_id': 68, 'order_user_id': 62, 'shipment_status': 'preparing'}, {'order_id': 251, 'order_user_id': 16, 'shipment_status': 'in_transit'}, {'order_id': 133, 'order_user_id': 20, 'shipment_status': 'in_transit'}, {'order_id': 49, 'order_user_id': 88, 'shipment_status': 'in_transit'}, {'order_id': 32, 'order_user_id': 40, 'shipment_status': 'in_transit'}, {'order_id': 278, 'order_user_id': 75, 'shipment_status': 'preparing'}, {'order_id': 178, 'order_user_id': 73, 'shipment_status': 'preparing'}, {'order_id': 118, 'order_user_id': 83, 'shipment_status': 'preparing'}, {'order_id': 79, 'order_user_id': 7, 'shipment_status': 'preparing'}, {'order_id': 200, 'order_user_id': 34, 'shipment_status': 'preparing'}, {'order_id': 234, 'order_user_id': 54, 'shipment_status': 'in_transit'}, {'order_id': 47, 'order_user_id': 51, 'shipment_status': 'preparing'}, {'order_id': 174, 'order_user_id': 71, 'shipment_status': 'preparing'}, {'order_id': 103, 'order_user_id': 26, 'shipment_status': 'in_transit'}, {'order_id': 39, 'order_user_id': 35, 'shipment_status': 'preparing'}, {'order_id': 34, 'order_user_id': 61, 'shipment_status': 'preparing'}, {'order_id': 237, 'order_user_id': 64, 'shipment_status': 'in_transit'}, {'order_id': 94, 'order_user_id': 27, 'shipment_status': 'in_transit'}, {'order_id': 163, 'order_user_id': 40, 'shipment_status': 'preparing'}, {'order_id': 4, 'order_user_id': 26, 'shipment_status': 'in_transit'}, {'order_id': 215, 'order_user_id': 83, 'shipment_status': 'in_transit'}, {'order_id': 162, 'order_user_id': 42, 'shipment_status': 'in_transit'}, {'order_id': 45, 'order_user_id': 14, 'shipment_status': 'in_transit'}, {'order_id': 44, 'order_user_id': 46, 'shipment_status': 'in_transit'}, {'order_id': 21, 'order_user_id': 22, 'shipment_status': 'in_transit'}, {'order_id': 241, 'order_user_id': 3, 'shipment_status': 'in_transit'}, {'order_id': 239, 'order_user_id': 69, 'shipment_status': 'in_transit'}, {'order_id': 142, 'order_user_id': 47, 'shipment_status': 'in_transit'}, {'order_id': 282, 'order_user_id': 49, 'shipment_status': 'preparing'}, {'order_id': 95, 'order_user_id': 70, 'shipment_status': 'preparing'}, {'order_id': 187, 'order_user_id': 37, 'shipment_status': 'in_transit'}, {'order_id': 167, 'order_user_id': 29, 'shipment_status': 'in_transit'}, {'order_id': 297, 'order_user_id': 13, 'shipment_status': 'preparing'}, {'order_id': 98, 'order_user_id': 4, 'shipment_status': 'preparing'}, {'order_id': 138, 'order_user_id': 81, 'shipment_status': 'in_transit'}, {'order_id': 202, 'order_user_id': 43, 'shipment_status': 'in_transit'}, {'order_id': 188, 'order_user_id': 62, 'shipment_status': 'in_transit'}, {'order_id': 288, 'order_user_id': 11, 'shipment_status': 'in_transit'}, {'order_id': 146, 'order_user_id': 5, 'shipment_status': 'in_transit'}, {'order_id': 75, 'order_user_id': 61, 'shipment_status': 'preparing'}, {'order_id': 277, 'order_user_id': 46, 'shipment_status': 'in_transit'}, {'order_id': 195, 'order_user_id': 24, 'shipment_status': 'in_transit'}, {'order_id': 121, 'order_user_id': 67, 'shipment_status': 'preparing'}, {'order_id': 131, 'order_user_id': 32, 'shipment_status': 'in_transit'}, {'order_id': 92, 'order_user_id': 45, 'shipment_status': 'preparing'}, {'order_id': 227, 'order_user_id': 84, 'shipment_status': 'in_transit'}, {'order_id': 244, 'order_user_id': 26, 'shipment_status': 'preparing'}, {'order_id': 81, 'order_user_id': 8, 'shipment_status': 'preparing'}, {'order_id': 296, 'order_user_id': 55, 'shipment_status': 'in_transit'}, {'order_id': 276, 'order_user_id': 22, 'shipment_status': 'preparing'}, {'order_id': 100, 'order_user_id': 1, 'shipment_status': 'preparing'}, {'order_id': 233, 'order_user_id': 38, 'shipment_status': 'in_transit'}, {'order_id': 141, 'order_user_id': 15, 'shipment_status': 'in_transit'}, {'order_id': 129, 'order_user_id': 10, 'shipment_status': 'in_transit'}, {'order_id': 130, 'order_user_id': 59, 'shipment_status': 'in_transit'}, {'order_id': 11, 'order_user_id': 41, 'shipment_status': 'preparing'}, {'order_id': 179, 'order_user_id': 16, 'shipment_status': 'in_transit'}, {'order_id': 102, 'order_user_id': 49, 'shipment_status': 'preparing'}, {'order_id': 13, 'order_user_id': 77, 'shipment_status': 'preparing'}, {'order_id': 203, 'order_user_id': 52, 'shipment_status': 'in_transit'}, {'order_id': 63, 'order_user_id': 10, 'shipment_status': 'in_transit'}, {'order_id': 96, 'order_user_id': 71, 'shipment_status': 'in_transit'}, {'order_id': 248, 'order_user_id': 78, 'shipment_status': 'preparing'}, {'order_id': 143, 'order_user_id': 68, 'shipment_status': 'preparing'}, {'order_id': 272, 'order_user_id': 64, 'shipment_status': 'in_transit'}, {'order_id': 107, 'order_user_id': 45, 'shipment_status': 'in_transit'}, {'order_id': 33, 'order_user_id': 24, 'shipment_status': 'in_transit'}, {'order_id': 97, 'order_user_id': 12, 'shipment_status': 'in_transit'}, {'order_id': 122, 'order_user_id': 16, 'shipment_status': 'in_transit'}, {'order_id': 151, 'order_user_id': 34, 'shipment_status': 'preparing'}, {'order_id': 61, 'order_user_id': 41, 'shipment_status': 'in_transit'}, {'order_id': 240, 'order_user_id': 4, 'shipment_status': 'preparing'}, {'order_id': 113, 'order_user_id': 67, 'shipment_status': 'in_transit'}, {'order_id': 82, 'order_user_id': 26, 'shipment_status': 'preparing'}, {'order_id': 224, 'order_user_id': 50, 'shipment_status': 'preparing'}, {'order_id': 170, 'order_user_id': 61, 'shipment_status': 'in_transit'}, {'order_id': 155, 'order_user_id': 11, 'shipment_status': 'in_transit'}, {'order_id': 40, 'order_user_id': 27, 'shipment_status': 'preparing'}, {'order_id': 184, 'order_user_id': 61, 'shipment_status': 'in_transit'}, {'order_id': 261, 'order_user_id': 41, 'shipment_status': 'in_transit'}, {'order_id': 219, 'order_user_id': 24, 'shipment_status': 'in_transit'}, {'order_id': 90, 'order_user_id': 33, 'shipment_status': 'in_transit'}, {'order_id': 211, 'order_user_id': 6, 'shipment_status': 'preparing'}, {'order_id': 176, 'order_user_id': 64, 'shipment_status': 'in_transit'}, {'order_id': 14, 'order_user_id': 40, 'shipment_status': 'in_transit'}, {'order_id': 208, 'order_user_id': 35, 'shipment_status': 'preparing'}, {'order_id': 232, 'order_user_id': 51, 'shipment_status': 'preparing'}, {'order_id': 88, 'order_user_id': 78, 'shipment_status': 'preparing'}, {'order_id': 132, 'order_user_id': 16, 'shipment_status': 'in_transit'}, {'order_id': 300, 'order_user_id': 37, 'shipment_status': 'in_transit'}, {'order_id': 150, 'order_user_id': 86, 'shipment_status': 'in_transit'}]",,MEDIUM
Which products have been tagged with at least three different tags?,"SELECT p.product_id,
       p.product_name,
       COUNT(pt.product_tag_tag_id) AS tag_count
FROM products AS p
JOIN product_tags AS pt
    ON pt.product_tag_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING COUNT(pt.product_tag_tag_id) >= 3;","[{'product_id': 58, 'product_name': 'Tire', 'tag_count': 5}, {'product_id': 8, 'product_name': 'TV', 'tag_count': 4}, {'product_id': 116, 'product_name': 'Wallet', 'tag_count': 3}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'tag_count': 4}, {'product_id': 71, 'product_name': 'Stapler', 'tag_count': 3}, {'product_id': 51, 'product_name': 'Perfume', 'tag_count': 3}, {'product_id': 146, 'product_name': 'Cooling Fan', 'tag_count': 3}, {'product_id': 80, 'product_name': 'Blu-ray', 'tag_count': 3}, {'product_id': 70, 'product_name': 'Pen Set', 'tag_count': 5}, {'product_id': 52, 'product_name': 'Shampoo', 'tag_count': 5}, {'product_id': 190, 'product_name': 'Product 190', 'tag_count': 4}, {'product_id': 162, 'product_name': 'Solar Panel', 'tag_count': 3}, {'product_id': 132, 'product_name': 'Power Bank', 'tag_count': 5}, {'product_id': 84, 'product_name': 'Drill', 'tag_count': 5}, {'product_id': 170, 'product_name': 'Toolbox', 'tag_count': 3}, {'product_id': 176, 'product_name': 'Paint Roller', 'tag_count': 4}, {'product_id': 169, 'product_name': 'Pliers', 'tag_count': 5}, {'product_id': 92, 'product_name': 'Blender', 'tag_count': 3}, {'product_id': 101, 'product_name': 'Nightstand', 'tag_count': 5}, {'product_id': 69, 'product_name': 'Notebook', 'tag_count': 3}, {'product_id': 180, 'product_name': 'Nails', 'tag_count': 3}, {'product_id': 114, 'product_name': 'Handbag', 'tag_count': 4}, {'product_id': 97, 'product_name': 'Desk', 'tag_count': 5}, {'product_id': 112, 'product_name': 'Sandals', 'tag_count': 5}, {'product_id': 22, 'product_name': 'Textbook', 'tag_count': 5}, {'product_id': 59, 'product_name': 'Wiper Blades', 'tag_count': 3}, {'product_id': 135, 'product_name': 'Webcam', 'tag_count': 3}, {'product_id': 65, 'product_name': 'Dog Food', 'tag_count': 4}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'tag_count': 3}, {'product_id': 124, 'product_name': 'Balloons', 'tag_count': 5}, {'product_id': 98, 'product_name': 'Bookshelf', 'tag_count': 4}, {'product_id': 173, 'product_name': 'Ear Protection', 'tag_count': 3}, {'product_id': 44, 'product_name': 'Action Figure', 'tag_count': 4}, {'product_id': 11, 'product_name': 'Mouse', 'tag_count': 4}, {'product_id': 42, 'product_name': 'Skateboard', 'tag_count': 4}, {'product_id': 189, 'product_name': 'Product 189', 'tag_count': 3}, {'product_id': 161, 'product_name': 'Battery Pack', 'tag_count': 5}, {'product_id': 121, 'product_name': 'Sculpture', 'tag_count': 4}, {'product_id': 117, 'product_name': 'Suitcase', 'tag_count': 4}, {'product_id': 88, 'product_name': 'Tent', 'tag_count': 3}, {'product_id': 82, 'product_name': 'Console', 'tag_count': 3}, {'product_id': 188, 'product_name': 'Product 188', 'tag_count': 4}, {'product_id': 125, 'product_name': 'Party Decorations', 'tag_count': 5}, {'product_id': 119, 'product_name': 'Fitness Tracker', 'tag_count': 4}, {'product_id': 113, 'product_name': 'Loafers', 'tag_count': 5}, {'product_id': 153, 'product_name': 'Doorbell', 'tag_count': 3}, {'product_id': 43, 'product_name': 'Helmet', 'tag_count': 4}, {'product_id': 147, 'product_name': 'Mousepad', 'tag_count': 3}, {'product_id': 196, 'product_name': 'Product 196', 'tag_count': 4}, {'product_id': 15, 'product_name': 'Shoes', 'tag_count': 5}, {'product_id': 79, 'product_name': 'DVD', 'tag_count': 4}, {'product_id': 26, 'product_name': 'Sofa', 'tag_count': 4}, {'product_id': 187, 'product_name': 'Product 187', 'tag_count': 5}, {'product_id': 72, 'product_name': 'Filing Cabinet', 'tag_count': 4}, {'product_id': 95, 'product_name': 'Knife Set', 'tag_count': 5}, {'product_id': 81, 'product_name': 'Video Game', 'tag_count': 4}, {'product_id': 61, 'product_name': 'Tea', 'tag_count': 3}, {'product_id': 19, 'product_name': 'Jeans', 'tag_count': 4}, {'product_id': 77, 'product_name': 'Microphone', 'tag_count': 5}, {'product_id': 172, 'product_name': 'Safety Glasses', 'tag_count': 4}, {'product_id': 30, 'product_name': 'Rug', 'tag_count': 4}, {'product_id': 21, 'product_name': 'Novel', 'tag_count': 5}, {'product_id': 131, 'product_name': 'USB Cable', 'tag_count': 3}, {'product_id': 198, 'product_name': 'Product 198', 'tag_count': 5}, {'product_id': 17, 'product_name': 'Dress', 'tag_count': 5}, {'product_id': 37, 'product_name': 'Football', 'tag_count': 4}, {'product_id': 28, 'product_name': 'Table', 'tag_count': 4}, {'product_id': 104, 'product_name': 'Car Seat', 'tag_count': 5}, {'product_id': 5, 'product_name': 'Speaker', 'tag_count': 5}, {'product_id': 171, 'product_name': 'Work Gloves', 'tag_count': 4}, {'product_id': 165, 'product_name': 'Multi-tool', 'tag_count': 5}, {'product_id': 56, 'product_name': 'Car Battery', 'tag_count': 4}, {'product_id': 151, 'product_name': 'Smart Bulb', 'tag_count': 3}, {'product_id': 91, 'product_name': 'Backpack', 'tag_count': 5}, {'product_id': 74, 'product_name': 'First Aid Kit', 'tag_count': 4}, {'product_id': 54, 'product_name': 'Makeup Kit', 'tag_count': 5}, {'product_id': 4, 'product_name': 'Headphones', 'tag_count': 4}, {'product_id': 138, 'product_name': 'Cable Organizer', 'tag_count': 3}, {'product_id': 181, 'product_name': 'Screws', 'tag_count': 4}, {'product_id': 96, 'product_name': 'Cookware', 'tag_count': 3}, {'product_id': 83, 'product_name': 'Controller', 'tag_count': 4}, {'product_id': 63, 'product_name': 'Pasta', 'tag_count': 4}, {'product_id': 90, 'product_name': 'Cooler', 'tag_count': 3}, {'product_id': 10, 'product_name': 'Keyboard', 'tag_count': 4}, {'product_id': 105, 'product_name': 'Baby Monitor', 'tag_count': 4}, {'product_id': 35, 'product_name': 'Clock', 'tag_count': 3}, {'product_id': 174, 'product_name': 'Respirator', 'tag_count': 4}, {'product_id': 45, 'product_name': 'Puzzle', 'tag_count': 4}, {'product_id': 6, 'product_name': 'Camera', 'tag_count': 3}, {'product_id': 86, 'product_name': 'Saw', 'tag_count': 3}, {'product_id': 144, 'product_name': 'RAM', 'tag_count': 4}, {'product_id': 168, 'product_name': 'Wrench Set', 'tag_count': 5}, {'product_id': 175, 'product_name': 'Ladder', 'tag_count': 4}, {'product_id': 31, 'product_name': 'Curtains', 'tag_count': 5}, {'product_id': 50, 'product_name': 'Lipstick', 'tag_count': 4}, {'product_id': 167, 'product_name': 'Level', 'tag_count': 3}, {'product_id': 14, 'product_name': 'Jacket', 'tag_count': 4}, {'product_id': 66, 'product_name': 'Cat Toy', 'tag_count': 5}, {'product_id': 109, 'product_name': 'Earrings', 'tag_count': 4}, {'product_id': 158, 'product_name': 'Heater', 'tag_count': 3}, {'product_id': 118, 'product_name': 'Smartwatch', 'tag_count': 5}, {'product_id': 133, 'product_name': 'External Hard Drive', 'tag_count': 5}, {'product_id': 195, 'product_name': 'Product 195', 'tag_count': 4}, {'product_id': 111, 'product_name': 'Boots', 'tag_count': 4}, {'product_id': 16, 'product_name': 'Hat', 'tag_count': 3}, {'product_id': 199, 'product_name': 'Product 199', 'tag_count': 5}, {'product_id': 123, 'product_name': 'Paint Set', 'tag_count': 3}, {'product_id': 128, 'product_name': 'Safety Vest', 'tag_count': 4}, {'product_id': 126, 'product_name': 'Wrapping Paper', 'tag_count': 4}, {'product_id': 194, 'product_name': 'Product 194', 'tag_count': 5}, {'product_id': 166, 'product_name': 'Tape Measure', 'tag_count': 3}, {'product_id': 99, 'product_name': 'Bed Frame', 'tag_count': 3}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'tag_count': 5}, {'product_id': 152, 'product_name': 'Security Camera', 'tag_count': 5}, {'product_id': 41, 'product_name': 'Bike', 'tag_count': 3}, {'product_id': 46, 'product_name': 'Board Game', 'tag_count': 4}, {'product_id': 157, 'product_name': 'Fan', 'tag_count': 5}, {'product_id': 53, 'product_name': 'Lotion', 'tag_count': 3}, {'product_id': 7, 'product_name': 'Watch', 'tag_count': 5}, {'product_id': 183, 'product_name': 'Hinges', 'tag_count': 3}, {'product_id': 136, 'product_name': 'Router', 'tag_count': 3}, {'product_id': 38, 'product_name': 'Tennis Racket', 'tag_count': 5}, {'product_id': 150, 'product_name': 'LED Strip', 'tag_count': 5}, {'product_id': 140, 'product_name': 'Phone Case', 'tag_count': 3}, {'product_id': 139, 'product_name': 'Screen Protector', 'tag_count': 3}, {'product_id': 193, 'product_name': 'Product 193', 'tag_count': 3}, {'product_id': 12, 'product_name': 'Shirt', 'tag_count': 3}, {'product_id': 164, 'product_name': 'Lantern', 'tag_count': 4}, {'product_id': 78, 'product_name': 'Drum Set', 'tag_count': 4}, {'product_id': 24, 'product_name': 'Comic', 'tag_count': 3}, {'product_id': 191, 'product_name': 'Product 191', 'tag_count': 4}, {'product_id': 159, 'product_name': 'Extension Cord', 'tag_count': 3}, {'product_id': 25, 'product_name': 'Journal', 'tag_count': 4}, {'product_id': 122, 'product_name': 'Canvas', 'tag_count': 3}, {'product_id': 186, 'product_name': 'Product 186', 'tag_count': 5}, {'product_id': 154, 'product_name': 'Thermostat', 'tag_count': 4}, {'product_id': 49, 'product_name': 'RC Car', 'tag_count': 5}, {'product_id': 47, 'product_name': 'Doll', 'tag_count': 3}, {'product_id': 177, 'product_name': 'Paintbrush', 'tag_count': 5}, {'product_id': 20, 'product_name': 'Socks', 'tag_count': 5}, {'product_id': 182, 'product_name': 'Anchors', 'tag_count': 4}, {'product_id': 33, 'product_name': 'Vase', 'tag_count': 5}, {'product_id': 76, 'product_name': 'Guitar', 'tag_count': 4}, {'product_id': 106, 'product_name': 'Necklace', 'tag_count': 3}, {'product_id': 18, 'product_name': 'Sweater', 'tag_count': 5}, {'product_id': 185, 'product_name': 'Product 185', 'tag_count': 3}, {'product_id': 64, 'product_name': 'Sauce', 'tag_count': 5}, {'product_id': 110, 'product_name': 'Sneakers', 'tag_count': 4}, {'product_id': 145, 'product_name': 'SSD', 'tag_count': 4}, {'product_id': 55, 'product_name': 'Hair Dryer', 'tag_count': 3}, {'product_id': 148, 'product_name': 'Desk Mat', 'tag_count': 3}, {'product_id': 130, 'product_name': 'Laptop Stand', 'tag_count': 4}, {'product_id': 143, 'product_name': 'Graphics Card', 'tag_count': 4}, {'product_id': 23, 'product_name': 'Magazine', 'tag_count': 3}]",,MEDIUM
Which users have multiple saved addresses in the system?,"SELECT u.user_id,
       u.user_name,
       COUNT(a.address_id) AS address_count
FROM users AS u
JOIN addresses AS a
    ON a.address_user_id = u.user_id
GROUP BY u.user_id, u.user_name
HAVING COUNT(a.address_id) > 1;","[{'user_id': 58, 'user_name': 'Brenda Price', 'address_count': 2}, {'user_id': 87, 'user_name': 'Jacob Lopez', 'address_count': 2}, {'user_id': 68, 'user_name': 'Larry Stewart', 'address_count': 2}, {'user_id': 4, 'user_name': 'Kenneth Castillo', 'address_count': 2}, {'user_id': 83, 'user_name': 'Sarah Foster', 'address_count': 2}, {'user_id': 90, 'user_name': 'John Ward', 'address_count': 2}, {'user_id': 45, 'user_name': 'Brian Martinez', 'address_count': 2}, {'user_id': 93, 'user_name': 'David Brown', 'address_count': 2}, {'user_id': 89, 'user_name': 'Rebecca Moore', 'address_count': 2}, {'user_id': 60, 'user_name': 'Thomas Kelly', 'address_count': 2}, {'user_id': 97, 'user_name': 'David Rogers', 'address_count': 2}, {'user_id': 65, 'user_name': 'Ronald Ross', 'address_count': 2}, {'user_id': 2, 'user_name': 'Joseph Gutierrez', 'address_count': 2}, {'user_id': 62, 'user_name': 'Kathleen Wright', 'address_count': 2}, {'user_id': 11, 'user_name': 'William Green', 'address_count': 2}, {'user_id': 42, 'user_name': 'Emma Allen', 'address_count': 2}, {'user_id': 82, 'user_name': 'Edward Diaz', 'address_count': 2}, {'user_id': 41, 'user_name': 'Donald Hughes', 'address_count': 2}, {'user_id': 48, 'user_name': 'Elizabeth Richardson', 'address_count': 2}, {'user_id': 72, 'user_name': 'Michelle Nelson', 'address_count': 2}, {'user_id': 95, 'user_name': 'Anthony Mitchell', 'address_count': 2}, {'user_id': 57, 'user_name': 'Mark Sanchez', 'address_count': 2}, {'user_id': 94, 'user_name': 'Kevin Anderson', 'address_count': 2}, {'user_id': 30, 'user_name': 'Amanda Morales', 'address_count': 2}, {'user_id': 47, 'user_name': 'Margaret Clark', 'address_count': 2}, {'user_id': 3, 'user_name': 'Ashley Green', 'address_count': 2}, {'user_id': 17, 'user_name': 'Dennis Kelly', 'address_count': 2}, {'user_id': 37, 'user_name': 'Lisa Kim', 'address_count': 2}, {'user_id': 1, 'user_name': 'Andrew Thomas', 'address_count': 2}, {'user_id': 18, 'user_name': 'Karen Hernandez', 'address_count': 2}, {'user_id': 64, 'user_name': 'Samuel Peterson', 'address_count': 2}]",,MEDIUM
Which coupons were never applied to any order?,"SELECT c.coupon_id,
       c.coupon_code
FROM coupons AS c
LEFT JOIN order_coupons AS oc
    ON oc.order_coupon_coupon_id = c.coupon_id
WHERE oc.order_coupon_id IS NULL;","[{'coupon_id': 39, 'coupon_code': 'COUPON39SAVE'}, {'coupon_id': 12, 'coupon_code': 'COUPON12SAVE'}, {'coupon_id': 18, 'coupon_code': 'COUPON18DEAL'}, {'coupon_id': 13, 'coupon_code': 'COUPON13OFF'}, {'coupon_id': 8, 'coupon_code': 'COUPON8SAVE'}, {'coupon_id': 28, 'coupon_code': 'COUPON28SAVE'}, {'coupon_id': 30, 'coupon_code': 'COUPON30OFF'}, {'coupon_id': 44, 'coupon_code': 'COUPON44SAVE'}, {'coupon_id': 45, 'coupon_code': 'COUPON45SAVE'}, {'coupon_id': 7, 'coupon_code': 'COUPON7SALE'}]",,MEDIUM
Which products have received reviews from more than 3 distinct users?,"SELECT p.product_id,
       p.product_name,
       COUNT(DISTINCT r.review_user_id) AS distinct_reviewers
FROM products AS p
JOIN reviews AS r
    ON r.review_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING COUNT(DISTINCT r.review_user_id) > 3;","[{'product_id': 1, 'product_name': 'Laptop', 'distinct_reviewers': 7}, {'product_id': 11, 'product_name': 'Mouse', 'distinct_reviewers': 4}, {'product_id': 22, 'product_name': 'Textbook', 'distinct_reviewers': 5}, {'product_id': 31, 'product_name': 'Curtains', 'distinct_reviewers': 4}, {'product_id': 35, 'product_name': 'Clock', 'distinct_reviewers': 4}, {'product_id': 40, 'product_name': 'Dumbbell', 'distinct_reviewers': 4}, {'product_id': 56, 'product_name': 'Car Battery', 'distinct_reviewers': 4}, {'product_id': 76, 'product_name': 'Guitar', 'distinct_reviewers': 4}, {'product_id': 97, 'product_name': 'Desk', 'distinct_reviewers': 4}, {'product_id': 116, 'product_name': 'Wallet', 'distinct_reviewers': 5}, {'product_id': 128, 'product_name': 'Safety Vest', 'distinct_reviewers': 4}, {'product_id': 139, 'product_name': 'Screen Protector', 'distinct_reviewers': 5}, {'product_id': 187, 'product_name': 'Product 187', 'distinct_reviewers': 4}, {'product_id': 188, 'product_name': 'Product 188', 'distinct_reviewers': 4}]",,MEDIUM
Which vendors added products that were created before 2023-01-01?,"SELECT DISTINCT v.vendor_id,
       v.vendor_name
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN products AS p
    ON p.product_id = pv.product_vendor_product_id
WHERE p.product_created_at < '2023-01-01';",[],,MEDIUM
Which orders include at least one item with a quantity of 5 or more?,"SELECT DISTINCT o.order_id,
       o.order_user_id
FROM orders AS o
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
WHERE oi.order_item_quantity >= 5;",[],,MEDIUM
Which users wrote reviews for products that also appear in their wishlists?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN reviews AS r
    ON r.review_user_id = u.user_id
JOIN wishlist AS w
    ON w.wishlist_user_id = u.user_id
JOIN wishlist_items AS wi
    ON wi.wishlist_item_wishlist_id = w.wishlist_id
WHERE wi.wishlist_item_product_id = r.review_product_id;","[{'user_id': 47, 'user_name': 'Margaret Clark'}, {'user_id': 54, 'user_name': 'Scott Howard'}, {'user_id': 68, 'user_name': 'Larry Stewart'}, {'user_id': 79, 'user_name': 'Mark Evans'}, {'user_id': 81, 'user_name': 'Jennifer Morales'}]",,HARD
Which users placed orders that were later returned (any return status)?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN returns AS r
    ON r.return_order_id = o.order_id;","[{'user_id': 33, 'user_name': 'Jonathan Chavez'}, {'user_id': 45, 'user_name': 'Brian Martinez'}, {'user_id': 44, 'user_name': 'Lisa Robinson'}, {'user_id': 51, 'user_name': 'Barbara Gonzalez'}, {'user_id': 71, 'user_name': 'Kathleen Baker'}, {'user_id': 78, 'user_name': 'William Reed'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}, {'user_id': 59, 'user_name': 'Amanda Martin'}, {'user_id': 41, 'user_name': 'Donald Hughes'}, {'user_id': 12, 'user_name': 'Sharon Carter'}, {'user_id': 13, 'user_name': 'Melissa Nelson'}, {'user_id': 46, 'user_name': 'Brenda Diaz'}, {'user_id': 27, 'user_name': 'Justin Morgan'}]",,MEDIUM
Which shipments were created on or after 2024-01-01 for orders with totals above $250?,"SELECT s.shipment_id,
       s.shipment_order_id,
       s.shipment_created_at
FROM shipments AS s
JOIN orders AS o
    ON o.order_id = s.shipment_order_id
WHERE s.shipment_created_at >= '2024-01-01'
  AND o.order_total > 250.00;","[{'shipment_id': 1, 'shipment_order_id': 1, 'shipment_created_at': datetime.datetime(2024, 10, 16, 16, 12, 5, 362000)}, {'shipment_id': 5, 'shipment_order_id': 5, 'shipment_created_at': datetime.datetime(2024, 3, 9, 21, 17, 44, 661000)}, {'shipment_id': 6, 'shipment_order_id': 6, 'shipment_created_at': datetime.datetime(2024, 2, 20, 0, 48, 29, 842000)}, {'shipment_id': 10, 'shipment_order_id': 10, 'shipment_created_at': datetime.datetime(2024, 3, 8, 20, 56, 5, 505000)}, {'shipment_id': 14, 'shipment_order_id': 14, 'shipment_created_at': datetime.datetime(2024, 9, 3, 17, 40, 50, 110000)}, {'shipment_id': 15, 'shipment_order_id': 15, 'shipment_created_at': datetime.datetime(2024, 10, 23, 5, 13, 52, 36000)}, {'shipment_id': 16, 'shipment_order_id': 16, 'shipment_created_at': datetime.datetime(2024, 11, 10, 4, 11, 42, 487000)}, {'shipment_id': 20, 'shipment_order_id': 20, 'shipment_created_at': datetime.datetime(2024, 4, 24, 10, 16, 53, 607000)}, {'shipment_id': 21, 'shipment_order_id': 21, 'shipment_created_at': datetime.datetime(2024, 1, 30, 23, 54, 8, 854000)}, {'shipment_id': 22, 'shipment_order_id': 22, 'shipment_created_at': datetime.datetime(2024, 1, 8, 3, 53, 30, 198000)}, {'shipment_id': 24, 'shipment_order_id': 24, 'shipment_created_at': datetime.datetime(2024, 11, 10, 17, 4, 23, 295000)}, {'shipment_id': 25, 'shipment_order_id': 25, 'shipment_created_at': datetime.datetime(2024, 1, 11, 21, 1, 3, 784000)}, {'shipment_id': 26, 'shipment_order_id': 26, 'shipment_created_at': datetime.datetime(2024, 7, 20, 5, 55, 36, 688000)}, {'shipment_id': 27, 'shipment_order_id': 27, 'shipment_created_at': datetime.datetime(2024, 1, 8, 18, 13, 47, 822000)}, {'shipment_id': 28, 'shipment_order_id': 28, 'shipment_created_at': datetime.datetime(2024, 6, 15, 18, 4, 2, 306000)}, {'shipment_id': 29, 'shipment_order_id': 29, 'shipment_created_at': datetime.datetime(2024, 3, 17, 18, 9, 34, 776000)}, {'shipment_id': 30, 'shipment_order_id': 30, 'shipment_created_at': datetime.datetime(2024, 3, 30, 2, 47, 41, 697000)}, {'shipment_id': 32, 'shipment_order_id': 32, 'shipment_created_at': datetime.datetime(2024, 3, 8, 12, 44, 34, 497000)}, {'shipment_id': 33, 'shipment_order_id': 33, 'shipment_created_at': datetime.datetime(2024, 11, 16, 20, 39, 10, 748000)}, {'shipment_id': 34, 'shipment_order_id': 34, 'shipment_created_at': datetime.datetime(2024, 2, 9, 21, 59, 28, 1000)}, {'shipment_id': 36, 'shipment_order_id': 36, 'shipment_created_at': datetime.datetime(2024, 7, 13, 1, 56, 32, 755000)}, {'shipment_id': 39, 'shipment_order_id': 39, 'shipment_created_at': datetime.datetime(2024, 9, 17, 16, 2, 0, 116000)}, {'shipment_id': 40, 'shipment_order_id': 40, 'shipment_created_at': datetime.datetime(2024, 11, 10, 2, 40, 19, 689000)}, {'shipment_id': 42, 'shipment_order_id': 42, 'shipment_created_at': datetime.datetime(2024, 4, 6, 16, 59, 51, 184000)}, {'shipment_id': 43, 'shipment_order_id': 43, 'shipment_created_at': datetime.datetime(2024, 1, 18, 23, 58, 29, 787000)}, {'shipment_id': 44, 'shipment_order_id': 44, 'shipment_created_at': datetime.datetime(2024, 2, 9, 2, 32, 19, 61000)}, {'shipment_id': 45, 'shipment_order_id': 45, 'shipment_created_at': datetime.datetime(2024, 7, 3, 9, 35, 43, 428000)}, {'shipment_id': 46, 'shipment_order_id': 46, 'shipment_created_at': datetime.datetime(2024, 11, 28, 18, 56, 50, 859000)}, {'shipment_id': 47, 'shipment_order_id': 47, 'shipment_created_at': datetime.datetime(2024, 8, 7, 10, 3, 32, 668000)}, {'shipment_id': 48, 'shipment_order_id': 48, 'shipment_created_at': datetime.datetime(2024, 8, 27, 4, 6, 27, 279000)}, {'shipment_id': 49, 'shipment_order_id': 49, 'shipment_created_at': datetime.datetime(2024, 5, 4, 13, 50, 7)}, {'shipment_id': 50, 'shipment_order_id': 50, 'shipment_created_at': datetime.datetime(2024, 2, 7, 1, 12, 35, 739000)}, {'shipment_id': 52, 'shipment_order_id': 52, 'shipment_created_at': datetime.datetime(2024, 3, 17, 9, 33, 54, 906000)}, {'shipment_id': 53, 'shipment_order_id': 53, 'shipment_created_at': datetime.datetime(2024, 10, 17, 9, 26, 35, 77000)}, {'shipment_id': 55, 'shipment_order_id': 55, 'shipment_created_at': datetime.datetime(2024, 1, 24, 19, 59, 58, 471000)}, {'shipment_id': 56, 'shipment_order_id': 56, 'shipment_created_at': datetime.datetime(2024, 4, 5, 2, 22, 53, 935000)}, {'shipment_id': 57, 'shipment_order_id': 57, 'shipment_created_at': datetime.datetime(2024, 8, 8, 4, 5, 26, 274000)}, {'shipment_id': 58, 'shipment_order_id': 58, 'shipment_created_at': datetime.datetime(2024, 8, 11, 6, 49, 44, 105000)}, {'shipment_id': 61, 'shipment_order_id': 61, 'shipment_created_at': datetime.datetime(2024, 1, 11, 16, 56, 8, 367000)}, {'shipment_id': 62, 'shipment_order_id': 62, 'shipment_created_at': datetime.datetime(2024, 10, 4, 8, 37, 16, 672000)}, {'shipment_id': 63, 'shipment_order_id': 63, 'shipment_created_at': datetime.datetime(2024, 3, 21, 0, 56, 36, 105000)}, {'shipment_id': 64, 'shipment_order_id': 64, 'shipment_created_at': datetime.datetime(2024, 6, 24, 0, 58, 12, 704000)}, {'shipment_id': 65, 'shipment_order_id': 65, 'shipment_created_at': datetime.datetime(2024, 4, 22, 6, 42, 24, 761000)}, {'shipment_id': 66, 'shipment_order_id': 66, 'shipment_created_at': datetime.datetime(2024, 8, 27, 8, 37, 43, 79000)}, {'shipment_id': 67, 'shipment_order_id': 67, 'shipment_created_at': datetime.datetime(2024, 8, 20, 21, 53, 52, 393000)}, {'shipment_id': 68, 'shipment_order_id': 68, 'shipment_created_at': datetime.datetime(2024, 3, 13, 0, 21, 1, 299000)}, {'shipment_id': 70, 'shipment_order_id': 70, 'shipment_created_at': datetime.datetime(2024, 10, 21, 19, 27, 18, 564000)}, {'shipment_id': 71, 'shipment_order_id': 71, 'shipment_created_at': datetime.datetime(2024, 4, 23, 21, 35, 7, 897000)}, {'shipment_id': 72, 'shipment_order_id': 72, 'shipment_created_at': datetime.datetime(2024, 2, 14, 9, 15, 9, 287000)}, {'shipment_id': 74, 'shipment_order_id': 74, 'shipment_created_at': datetime.datetime(2024, 7, 20, 5, 6, 12, 658000)}, {'shipment_id': 75, 'shipment_order_id': 75, 'shipment_created_at': datetime.datetime(2024, 6, 30, 9, 56, 23, 374000)}, {'shipment_id': 76, 'shipment_order_id': 76, 'shipment_created_at': datetime.datetime(2024, 3, 21, 17, 13, 12, 984000)}, {'shipment_id': 77, 'shipment_order_id': 77, 'shipment_created_at': datetime.datetime(2024, 8, 21, 0, 54, 41, 715000)}, {'shipment_id': 79, 'shipment_order_id': 79, 'shipment_created_at': datetime.datetime(2024, 4, 12, 3, 44, 55, 502000)}, {'shipment_id': 81, 'shipment_order_id': 81, 'shipment_created_at': datetime.datetime(2024, 5, 16, 16, 7, 50, 590000)}, {'shipment_id': 82, 'shipment_order_id': 82, 'shipment_created_at': datetime.datetime(2024, 4, 23, 11, 55, 53, 365000)}, {'shipment_id': 83, 'shipment_order_id': 83, 'shipment_created_at': datetime.datetime(2024, 2, 18, 12, 8, 41, 972000)}, {'shipment_id': 84, 'shipment_order_id': 84, 'shipment_created_at': datetime.datetime(2024, 5, 6, 10, 10, 20, 457000)}, {'shipment_id': 86, 'shipment_order_id': 86, 'shipment_created_at': datetime.datetime(2024, 6, 16, 1, 36, 34, 895000)}, {'shipment_id': 87, 'shipment_order_id': 87, 'shipment_created_at': datetime.datetime(2024, 2, 4, 18, 55, 35, 17000)}, {'shipment_id': 88, 'shipment_order_id': 88, 'shipment_created_at': datetime.datetime(2024, 9, 20, 11, 16, 51, 225000)}, {'shipment_id': 89, 'shipment_order_id': 89, 'shipment_created_at': datetime.datetime(2024, 8, 27, 21, 10, 4, 383000)}, {'shipment_id': 90, 'shipment_order_id': 90, 'shipment_created_at': datetime.datetime(2024, 8, 17, 18, 22, 13, 363000)}, {'shipment_id': 92, 'shipment_order_id': 92, 'shipment_created_at': datetime.datetime(2024, 8, 15, 4, 0, 13, 885000)}, {'shipment_id': 94, 'shipment_order_id': 94, 'shipment_created_at': datetime.datetime(2024, 5, 12, 12, 38, 36, 722000)}, {'shipment_id': 95, 'shipment_order_id': 95, 'shipment_created_at': datetime.datetime(2024, 11, 22, 15, 45, 33, 813000)}, {'shipment_id': 96, 'shipment_order_id': 96, 'shipment_created_at': datetime.datetime(2024, 11, 16, 2, 57, 44, 561000)}, {'shipment_id': 97, 'shipment_order_id': 97, 'shipment_created_at': datetime.datetime(2024, 9, 15, 18, 56, 22, 629000)}, {'shipment_id': 100, 'shipment_order_id': 100, 'shipment_created_at': datetime.datetime(2024, 5, 4, 13, 59, 49, 323000)}, {'shipment_id': 101, 'shipment_order_id': 101, 'shipment_created_at': datetime.datetime(2024, 9, 30, 14, 50, 19, 821000)}, {'shipment_id': 103, 'shipment_order_id': 103, 'shipment_created_at': datetime.datetime(2024, 5, 27, 10, 9, 38, 740000)}, {'shipment_id': 104, 'shipment_order_id': 104, 'shipment_created_at': datetime.datetime(2024, 3, 9, 2, 57, 53, 470000)}, {'shipment_id': 105, 'shipment_order_id': 105, 'shipment_created_at': datetime.datetime(2024, 8, 3, 8, 25, 42, 955000)}, {'shipment_id': 106, 'shipment_order_id': 106, 'shipment_created_at': datetime.datetime(2024, 7, 17, 9, 17, 22, 432000)}, {'shipment_id': 107, 'shipment_order_id': 107, 'shipment_created_at': datetime.datetime(2024, 5, 31, 10, 18, 29, 313000)}, {'shipment_id': 109, 'shipment_order_id': 109, 'shipment_created_at': datetime.datetime(2024, 10, 11, 0, 32, 30, 953000)}, {'shipment_id': 110, 'shipment_order_id': 110, 'shipment_created_at': datetime.datetime(2024, 1, 18, 1, 36, 57, 789000)}, {'shipment_id': 111, 'shipment_order_id': 111, 'shipment_created_at': datetime.datetime(2024, 9, 9, 2, 54, 49, 211000)}, {'shipment_id': 113, 'shipment_order_id': 113, 'shipment_created_at': datetime.datetime(2024, 5, 17, 3, 40, 59, 88000)}, {'shipment_id': 117, 'shipment_order_id': 117, 'shipment_created_at': datetime.datetime(2024, 9, 3, 1, 34, 5, 582000)}, {'shipment_id': 118, 'shipment_order_id': 118, 'shipment_created_at': datetime.datetime(2024, 5, 6, 14, 50, 3, 738000)}, {'shipment_id': 120, 'shipment_order_id': 120, 'shipment_created_at': datetime.datetime(2024, 3, 27, 10, 38, 24, 183000)}, {'shipment_id': 121, 'shipment_order_id': 121, 'shipment_created_at': datetime.datetime(2024, 8, 21, 9, 10, 49, 486000)}, {'shipment_id': 122, 'shipment_order_id': 122, 'shipment_created_at': datetime.datetime(2024, 9, 28, 12, 58, 50, 366000)}, {'shipment_id': 123, 'shipment_order_id': 123, 'shipment_created_at': datetime.datetime(2024, 11, 12, 18, 59, 20, 598000)}, {'shipment_id': 124, 'shipment_order_id': 124, 'shipment_created_at': datetime.datetime(2024, 1, 19, 10, 21, 53, 117000)}, {'shipment_id': 125, 'shipment_order_id': 125, 'shipment_created_at': datetime.datetime(2024, 7, 20, 0, 42, 14, 122000)}, {'shipment_id': 126, 'shipment_order_id': 126, 'shipment_created_at': datetime.datetime(2024, 7, 12, 9, 35, 58, 260000)}, {'shipment_id': 127, 'shipment_order_id': 127, 'shipment_created_at': datetime.datetime(2024, 3, 1, 3, 14, 41, 378000)}, {'shipment_id': 129, 'shipment_order_id': 129, 'shipment_created_at': datetime.datetime(2024, 5, 14, 9, 50, 0, 871000)}, {'shipment_id': 130, 'shipment_order_id': 130, 'shipment_created_at': datetime.datetime(2024, 4, 1, 13, 30, 6, 31000)}, {'shipment_id': 131, 'shipment_order_id': 131, 'shipment_created_at': datetime.datetime(2024, 9, 4, 23, 13, 52, 89000)}, {'shipment_id': 133, 'shipment_order_id': 133, 'shipment_created_at': datetime.datetime(2024, 2, 19, 16, 27, 28, 961000)}, {'shipment_id': 134, 'shipment_order_id': 134, 'shipment_created_at': datetime.datetime(2024, 10, 5, 19, 59, 40, 254000)}, {'shipment_id': 136, 'shipment_order_id': 136, 'shipment_created_at': datetime.datetime(2024, 1, 14, 18, 31, 46, 554000)}, {'shipment_id': 137, 'shipment_order_id': 137, 'shipment_created_at': datetime.datetime(2024, 1, 4, 10, 58, 45, 111000)}, {'shipment_id': 138, 'shipment_order_id': 138, 'shipment_created_at': datetime.datetime(2024, 6, 26, 18, 32, 27, 116000)}, {'shipment_id': 139, 'shipment_order_id': 139, 'shipment_created_at': datetime.datetime(2024, 8, 6, 11, 16, 36, 328000)}, {'shipment_id': 140, 'shipment_order_id': 140, 'shipment_created_at': datetime.datetime(2024, 10, 2, 16, 20, 47, 501000)}, {'shipment_id': 142, 'shipment_order_id': 142, 'shipment_created_at': datetime.datetime(2024, 11, 24, 19, 19, 43, 477000)}, {'shipment_id': 143, 'shipment_order_id': 143, 'shipment_created_at': datetime.datetime(2024, 9, 6, 13, 53, 56, 37000)}, {'shipment_id': 144, 'shipment_order_id': 144, 'shipment_created_at': datetime.datetime(2024, 9, 24, 4, 51, 38, 577000)}, {'shipment_id': 146, 'shipment_order_id': 146, 'shipment_created_at': datetime.datetime(2024, 11, 25, 7, 28, 2, 143000)}, {'shipment_id': 148, 'shipment_order_id': 148, 'shipment_created_at': datetime.datetime(2024, 10, 17, 14, 48, 4, 105000)}, {'shipment_id': 149, 'shipment_order_id': 149, 'shipment_created_at': datetime.datetime(2024, 10, 25, 17, 39, 37, 695000)}, {'shipment_id': 150, 'shipment_order_id': 150, 'shipment_created_at': datetime.datetime(2024, 1, 13, 14, 35, 27, 562000)}, {'shipment_id': 151, 'shipment_order_id': 151, 'shipment_created_at': datetime.datetime(2024, 4, 9, 18, 50, 32, 365000)}, {'shipment_id': 152, 'shipment_order_id': 152, 'shipment_created_at': datetime.datetime(2024, 7, 20, 21, 56, 30, 187000)}, {'shipment_id': 153, 'shipment_order_id': 153, 'shipment_created_at': datetime.datetime(2024, 6, 13, 21, 52, 46, 966000)}, {'shipment_id': 154, 'shipment_order_id': 154, 'shipment_created_at': datetime.datetime(2024, 5, 29, 5, 30, 18, 584000)}, {'shipment_id': 155, 'shipment_order_id': 155, 'shipment_created_at': datetime.datetime(2024, 1, 15, 11, 46, 18, 454000)}, {'shipment_id': 156, 'shipment_order_id': 156, 'shipment_created_at': datetime.datetime(2024, 7, 4, 18, 7, 14, 636000)}, {'shipment_id': 158, 'shipment_order_id': 158, 'shipment_created_at': datetime.datetime(2024, 3, 25, 12, 14, 52, 137000)}, {'shipment_id': 159, 'shipment_order_id': 159, 'shipment_created_at': datetime.datetime(2024, 1, 15, 12, 20, 13, 200000)}, {'shipment_id': 160, 'shipment_order_id': 160, 'shipment_created_at': datetime.datetime(2024, 7, 28, 21, 32, 31, 640000)}, {'shipment_id': 161, 'shipment_order_id': 161, 'shipment_created_at': datetime.datetime(2024, 3, 16, 6, 10, 7, 789000)}, {'shipment_id': 162, 'shipment_order_id': 162, 'shipment_created_at': datetime.datetime(2024, 7, 28, 9, 2, 42, 208000)}, {'shipment_id': 163, 'shipment_order_id': 163, 'shipment_created_at': datetime.datetime(2024, 10, 23, 17, 52, 6, 504000)}, {'shipment_id': 164, 'shipment_order_id': 164, 'shipment_created_at': datetime.datetime(2024, 10, 13, 14, 10, 4, 363000)}, {'shipment_id': 165, 'shipment_order_id': 165, 'shipment_created_at': datetime.datetime(2024, 6, 13, 22, 28, 23, 913000)}, {'shipment_id': 166, 'shipment_order_id': 166, 'shipment_created_at': datetime.datetime(2024, 4, 23, 8, 9, 12, 527000)}, {'shipment_id': 167, 'shipment_order_id': 167, 'shipment_created_at': datetime.datetime(2024, 2, 8, 4, 47, 0, 158000)}, {'shipment_id': 169, 'shipment_order_id': 169, 'shipment_created_at': datetime.datetime(2024, 5, 11, 19, 41, 26, 867000)}, {'shipment_id': 170, 'shipment_order_id': 170, 'shipment_created_at': datetime.datetime(2024, 5, 3, 19, 57, 53, 820000)}, {'shipment_id': 171, 'shipment_order_id': 171, 'shipment_created_at': datetime.datetime(2024, 3, 11, 15, 47, 29, 96000)}, {'shipment_id': 173, 'shipment_order_id': 173, 'shipment_created_at': datetime.datetime(2024, 7, 22, 19, 59, 23, 691000)}, {'shipment_id': 174, 'shipment_order_id': 174, 'shipment_created_at': datetime.datetime(2024, 4, 24, 6, 33, 41, 130000)}, {'shipment_id': 176, 'shipment_order_id': 176, 'shipment_created_at': datetime.datetime(2024, 3, 15, 7, 29, 58, 839000)}, {'shipment_id': 177, 'shipment_order_id': 177, 'shipment_created_at': datetime.datetime(2024, 7, 24, 8, 3, 19, 556000)}, {'shipment_id': 178, 'shipment_order_id': 178, 'shipment_created_at': datetime.datetime(2024, 4, 24, 18, 44, 45, 380000)}, {'shipment_id': 179, 'shipment_order_id': 179, 'shipment_created_at': datetime.datetime(2024, 9, 27, 22, 0, 12, 905000)}, {'shipment_id': 180, 'shipment_order_id': 180, 'shipment_created_at': datetime.datetime(2024, 2, 26, 13, 27, 37, 91000)}, {'shipment_id': 181, 'shipment_order_id': 181, 'shipment_created_at': datetime.datetime(2024, 10, 22, 17, 11, 22, 699000)}, {'shipment_id': 183, 'shipment_order_id': 183, 'shipment_created_at': datetime.datetime(2024, 1, 13, 10, 40, 37, 633000)}, {'shipment_id': 185, 'shipment_order_id': 185, 'shipment_created_at': datetime.datetime(2024, 11, 8, 11, 14, 48, 167000)}, {'shipment_id': 186, 'shipment_order_id': 186, 'shipment_created_at': datetime.datetime(2024, 2, 28, 9, 51, 17, 950000)}, {'shipment_id': 187, 'shipment_order_id': 187, 'shipment_created_at': datetime.datetime(2024, 1, 16, 0, 10, 27, 874000)}, {'shipment_id': 188, 'shipment_order_id': 188, 'shipment_created_at': datetime.datetime(2024, 9, 29, 9, 13, 1, 145000)}, {'shipment_id': 190, 'shipment_order_id': 190, 'shipment_created_at': datetime.datetime(2024, 4, 26, 8, 19, 50, 60000)}, {'shipment_id': 191, 'shipment_order_id': 191, 'shipment_created_at': datetime.datetime(2024, 11, 30, 20, 19, 33, 133000)}, {'shipment_id': 194, 'shipment_order_id': 194, 'shipment_created_at': datetime.datetime(2024, 3, 2, 18, 2, 30, 70000)}, {'shipment_id': 195, 'shipment_order_id': 195, 'shipment_created_at': datetime.datetime(2024, 4, 28, 18, 43, 49, 741000)}, {'shipment_id': 199, 'shipment_order_id': 199, 'shipment_created_at': datetime.datetime(2024, 1, 25, 5, 42, 40, 840000)}, {'shipment_id': 200, 'shipment_order_id': 200, 'shipment_created_at': datetime.datetime(2024, 10, 16, 18, 29, 21, 591000)}, {'shipment_id': 201, 'shipment_order_id': 201, 'shipment_created_at': datetime.datetime(2024, 11, 12, 2, 32, 43, 600000)}, {'shipment_id': 202, 'shipment_order_id': 202, 'shipment_created_at': datetime.datetime(2024, 3, 26, 0, 51, 35, 923000)}, {'shipment_id': 203, 'shipment_order_id': 203, 'shipment_created_at': datetime.datetime(2024, 9, 7, 18, 37, 59, 255000)}, {'shipment_id': 204, 'shipment_order_id': 204, 'shipment_created_at': datetime.datetime(2024, 1, 20, 15, 37, 26, 373000)}, {'shipment_id': 205, 'shipment_order_id': 205, 'shipment_created_at': datetime.datetime(2024, 5, 24, 13, 51, 50, 446000)}, {'shipment_id': 206, 'shipment_order_id': 206, 'shipment_created_at': datetime.datetime(2024, 7, 4, 21, 9, 42, 197000)}, {'shipment_id': 207, 'shipment_order_id': 207, 'shipment_created_at': datetime.datetime(2024, 2, 12, 13, 30, 24, 179000)}, {'shipment_id': 208, 'shipment_order_id': 208, 'shipment_created_at': datetime.datetime(2024, 9, 18, 11, 34, 20, 531000)}, {'shipment_id': 209, 'shipment_order_id': 209, 'shipment_created_at': datetime.datetime(2024, 7, 12, 17, 18, 56, 362000)}, {'shipment_id': 210, 'shipment_order_id': 210, 'shipment_created_at': datetime.datetime(2024, 6, 8, 13, 47, 46, 118000)}, {'shipment_id': 211, 'shipment_order_id': 211, 'shipment_created_at': datetime.datetime(2024, 3, 4, 13, 14, 56, 533000)}, {'shipment_id': 212, 'shipment_order_id': 212, 'shipment_created_at': datetime.datetime(2024, 5, 9, 17, 15, 58, 264000)}, {'shipment_id': 213, 'shipment_order_id': 213, 'shipment_created_at': datetime.datetime(2024, 8, 23, 15, 5, 20, 836000)}, {'shipment_id': 214, 'shipment_order_id': 214, 'shipment_created_at': datetime.datetime(2024, 9, 12, 7, 19, 5, 500000)}, {'shipment_id': 215, 'shipment_order_id': 215, 'shipment_created_at': datetime.datetime(2024, 11, 25, 2, 10, 7, 248000)}, {'shipment_id': 216, 'shipment_order_id': 216, 'shipment_created_at': datetime.datetime(2024, 10, 3, 14, 8, 28, 781000)}, {'shipment_id': 217, 'shipment_order_id': 217, 'shipment_created_at': datetime.datetime(2024, 2, 8, 5, 10, 41, 574000)}, {'shipment_id': 218, 'shipment_order_id': 218, 'shipment_created_at': datetime.datetime(2024, 11, 10, 14, 5, 47, 877000)}, {'shipment_id': 219, 'shipment_order_id': 219, 'shipment_created_at': datetime.datetime(2024, 4, 14, 5, 57, 52, 825000)}, {'shipment_id': 220, 'shipment_order_id': 220, 'shipment_created_at': datetime.datetime(2024, 11, 9, 8, 57, 23, 481000)}, {'shipment_id': 221, 'shipment_order_id': 221, 'shipment_created_at': datetime.datetime(2024, 6, 10, 12, 17, 2, 342000)}, {'shipment_id': 222, 'shipment_order_id': 222, 'shipment_created_at': datetime.datetime(2024, 5, 29, 13, 38, 29, 925000)}, {'shipment_id': 224, 'shipment_order_id': 224, 'shipment_created_at': datetime.datetime(2024, 7, 12, 10, 45, 33, 693000)}, {'shipment_id': 225, 'shipment_order_id': 225, 'shipment_created_at': datetime.datetime(2024, 6, 4, 7, 41, 29, 684000)}, {'shipment_id': 227, 'shipment_order_id': 227, 'shipment_created_at': datetime.datetime(2024, 8, 4, 17, 3, 52, 84000)}, {'shipment_id': 228, 'shipment_order_id': 228, 'shipment_created_at': datetime.datetime(2024, 9, 12, 12, 21, 9, 521000)}, {'shipment_id': 230, 'shipment_order_id': 230, 'shipment_created_at': datetime.datetime(2024, 8, 13, 0, 6, 29, 898000)}, {'shipment_id': 231, 'shipment_order_id': 231, 'shipment_created_at': datetime.datetime(2024, 5, 12, 11, 54, 36, 410000)}, {'shipment_id': 233, 'shipment_order_id': 233, 'shipment_created_at': datetime.datetime(2024, 4, 14, 11, 58, 11, 557000)}, {'shipment_id': 234, 'shipment_order_id': 234, 'shipment_created_at': datetime.datetime(2024, 9, 10, 20, 25, 26, 543000)}, {'shipment_id': 238, 'shipment_order_id': 238, 'shipment_created_at': datetime.datetime(2024, 1, 25, 0, 16, 58, 863000)}, {'shipment_id': 239, 'shipment_order_id': 239, 'shipment_created_at': datetime.datetime(2024, 11, 8, 10, 47, 31, 644000)}, {'shipment_id': 240, 'shipment_order_id': 240, 'shipment_created_at': datetime.datetime(2024, 2, 11, 18, 0, 55, 278000)}, {'shipment_id': 241, 'shipment_order_id': 241, 'shipment_created_at': datetime.datetime(2024, 10, 21, 6, 40, 41, 150000)}, {'shipment_id': 242, 'shipment_order_id': 242, 'shipment_created_at': datetime.datetime(2024, 6, 21, 21, 29, 17, 896000)}, {'shipment_id': 243, 'shipment_order_id': 243, 'shipment_created_at': datetime.datetime(2024, 10, 26, 1, 46, 34, 477000)}, {'shipment_id': 244, 'shipment_order_id': 244, 'shipment_created_at': datetime.datetime(2024, 8, 28, 4, 45, 41, 102000)}, {'shipment_id': 245, 'shipment_order_id': 245, 'shipment_created_at': datetime.datetime(2024, 7, 17, 5, 33, 27, 468000)}, {'shipment_id': 247, 'shipment_order_id': 247, 'shipment_created_at': datetime.datetime(2024, 7, 29, 9, 38, 13, 221000)}, {'shipment_id': 248, 'shipment_order_id': 248, 'shipment_created_at': datetime.datetime(2024, 8, 19, 15, 39, 57, 668000)}, {'shipment_id': 251, 'shipment_order_id': 251, 'shipment_created_at': datetime.datetime(2024, 4, 15, 13, 17, 53, 789000)}, {'shipment_id': 253, 'shipment_order_id': 253, 'shipment_created_at': datetime.datetime(2024, 6, 17, 22, 51, 44, 816000)}, {'shipment_id': 255, 'shipment_order_id': 255, 'shipment_created_at': datetime.datetime(2024, 8, 26, 0, 0, 16, 258000)}, {'shipment_id': 257, 'shipment_order_id': 257, 'shipment_created_at': datetime.datetime(2024, 3, 20, 22, 5, 51, 426000)}, {'shipment_id': 258, 'shipment_order_id': 258, 'shipment_created_at': datetime.datetime(2024, 1, 29, 21, 0, 14, 718000)}, {'shipment_id': 259, 'shipment_order_id': 259, 'shipment_created_at': datetime.datetime(2024, 7, 5, 14, 31, 10, 441000)}, {'shipment_id': 261, 'shipment_order_id': 261, 'shipment_created_at': datetime.datetime(2024, 5, 26, 10, 58, 42, 602000)}, {'shipment_id': 262, 'shipment_order_id': 262, 'shipment_created_at': datetime.datetime(2024, 4, 21, 7, 0, 6, 750000)}, {'shipment_id': 264, 'shipment_order_id': 264, 'shipment_created_at': datetime.datetime(2024, 7, 25, 6, 0, 59, 852000)}, {'shipment_id': 265, 'shipment_order_id': 265, 'shipment_created_at': datetime.datetime(2024, 3, 15, 9, 38, 38, 170000)}, {'shipment_id': 266, 'shipment_order_id': 266, 'shipment_created_at': datetime.datetime(2024, 7, 24, 6, 17, 22, 837000)}, {'shipment_id': 267, 'shipment_order_id': 267, 'shipment_created_at': datetime.datetime(2024, 5, 15, 22, 50, 6, 452000)}, {'shipment_id': 268, 'shipment_order_id': 268, 'shipment_created_at': datetime.datetime(2024, 10, 14, 12, 49, 48, 811000)}, {'shipment_id': 269, 'shipment_order_id': 269, 'shipment_created_at': datetime.datetime(2024, 2, 11, 15, 54, 49, 644000)}, {'shipment_id': 271, 'shipment_order_id': 271, 'shipment_created_at': datetime.datetime(2024, 10, 18, 3, 37, 49, 358000)}, {'shipment_id': 272, 'shipment_order_id': 272, 'shipment_created_at': datetime.datetime(2024, 4, 20, 6, 11, 13, 796000)}, {'shipment_id': 274, 'shipment_order_id': 274, 'shipment_created_at': datetime.datetime(2024, 7, 16, 4, 27, 5, 731000)}, {'shipment_id': 275, 'shipment_order_id': 275, 'shipment_created_at': datetime.datetime(2024, 8, 22, 12, 34, 16, 489000)}, {'shipment_id': 276, 'shipment_order_id': 276, 'shipment_created_at': datetime.datetime(2024, 8, 5, 21, 33, 30, 141000)}, {'shipment_id': 277, 'shipment_order_id': 277, 'shipment_created_at': datetime.datetime(2024, 9, 20, 5, 3, 44, 692000)}, {'shipment_id': 278, 'shipment_order_id': 278, 'shipment_created_at': datetime.datetime(2024, 8, 16, 7, 9, 4, 742000)}, {'shipment_id': 280, 'shipment_order_id': 280, 'shipment_created_at': datetime.datetime(2024, 10, 28, 20, 51, 47, 740000)}, {'shipment_id': 281, 'shipment_order_id': 281, 'shipment_created_at': datetime.datetime(2024, 10, 19, 10, 55, 6, 61000)}, {'shipment_id': 282, 'shipment_order_id': 282, 'shipment_created_at': datetime.datetime(2024, 3, 6, 19, 43, 18, 59000)}, {'shipment_id': 283, 'shipment_order_id': 283, 'shipment_created_at': datetime.datetime(2024, 10, 15, 17, 30, 41, 458000)}, {'shipment_id': 285, 'shipment_order_id': 285, 'shipment_created_at': datetime.datetime(2024, 1, 17, 19, 44, 43, 419000)}, {'shipment_id': 289, 'shipment_order_id': 289, 'shipment_created_at': datetime.datetime(2024, 4, 25, 14, 16, 53, 534000)}, {'shipment_id': 290, 'shipment_order_id': 290, 'shipment_created_at': datetime.datetime(2024, 10, 28, 23, 55, 22, 456000)}, {'shipment_id': 292, 'shipment_order_id': 292, 'shipment_created_at': datetime.datetime(2024, 1, 1, 21, 12, 57, 392000)}, {'shipment_id': 293, 'shipment_order_id': 293, 'shipment_created_at': datetime.datetime(2024, 10, 17, 4, 5, 14, 438000)}, {'shipment_id': 295, 'shipment_order_id': 295, 'shipment_created_at': datetime.datetime(2024, 10, 8, 17, 34, 58, 795000)}, {'shipment_id': 296, 'shipment_order_id': 296, 'shipment_created_at': datetime.datetime(2024, 7, 22, 8, 22, 1, 813000)}, {'shipment_id': 297, 'shipment_order_id': 297, 'shipment_created_at': datetime.datetime(2024, 7, 23, 22, 56, 16, 939000)}, {'shipment_id': 298, 'shipment_order_id': 298, 'shipment_created_at': datetime.datetime(2024, 6, 24, 12, 21, 36, 378000)}, {'shipment_id': 300, 'shipment_order_id': 300, 'shipment_created_at': datetime.datetime(2024, 2, 14, 7, 31, 42, 999000)}]",,MEDIUM
Which products have been discounted by more than one distinct discount campaign?,"SELECT p.product_id,
       p.product_name,
       COUNT(DISTINCT pd.product_discount_discount_id) AS discount_count
FROM products AS p
JOIN product_discounts AS pd
    ON pd.product_discount_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING COUNT(DISTINCT pd.product_discount_discount_id) > 1;",[],,MEDIUM
Which categories contain products priced above $500?,"SELECT DISTINCT c.category_id,
       c.category_name
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
JOIN products AS p
    ON p.product_id = cp.category_product_product_id
WHERE p.product_price > 500.00;","[{'category_id': 2, 'category_name': 'Clothing'}, {'category_id': 12, 'category_name': 'Health'}, {'category_id': 24, 'category_name': 'Watches'}, {'category_id': 29, 'category_name': 'Phones'}, {'category_id': 30, 'category_name': 'Computers'}]",,MEDIUM
Which users have completed payments using a credit card?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN payments AS p
    ON p.payment_order_id = o.order_id
WHERE p.payment_status = 'completed'
  AND p.payment_method = 'credit_card';","[{'user_id': 15, 'user_name': 'Lisa Lopez'}, {'user_id': 73, 'user_name': 'Richard Reed'}, {'user_id': 26, 'user_name': 'Nicole Anderson'}, {'user_id': 10, 'user_name': 'Jeffrey Torres'}, {'user_id': 33, 'user_name': 'Jonathan Chavez'}, {'user_id': 41, 'user_name': 'Donald Hughes'}, {'user_id': 3, 'user_name': 'Ashley Green'}, {'user_id': 70, 'user_name': 'Scott Brooks'}, {'user_id': 32, 'user_name': 'Jennifer Thompson'}, {'user_id': 77, 'user_name': 'Christine James'}, {'user_id': 45, 'user_name': 'Brian Martinez'}, {'user_id': 5, 'user_name': 'Pamela Patel'}, {'user_id': 13, 'user_name': 'Melissa Nelson'}, {'user_id': 54, 'user_name': 'Scott Howard'}, {'user_id': 67, 'user_name': 'Sandra Harris'}, {'user_id': 17, 'user_name': 'Dennis Kelly'}, {'user_id': 46, 'user_name': 'Brenda Diaz'}, {'user_id': 44, 'user_name': 'Lisa Robinson'}, {'user_id': 51, 'user_name': 'Barbara Gonzalez'}, {'user_id': 27, 'user_name': 'Justin Morgan'}, {'user_id': 83, 'user_name': 'Sarah Foster'}, {'user_id': 53, 'user_name': 'Stephanie Anderson'}, {'user_id': 84, 'user_name': 'Dorothy Richardson'}, {'user_id': 22, 'user_name': 'Frank Martin'}, {'user_id': 30, 'user_name': 'Amanda Morales'}, {'user_id': 61, 'user_name': 'Michael Bailey'}, {'user_id': 71, 'user_name': 'Kathleen Baker'}, {'user_id': 65, 'user_name': 'Ronald Ross'}, {'user_id': 24, 'user_name': 'Emily James'}, {'user_id': 28, 'user_name': 'Anna Thompson'}, {'user_id': 35, 'user_name': 'Carolyn Adams'}, {'user_id': 57, 'user_name': 'Mark Sanchez'}, {'user_id': 64, 'user_name': 'Samuel Peterson'}, {'user_id': 38, 'user_name': 'Rebecca Lopez'}, {'user_id': 18, 'user_name': 'Karen Hernandez'}, {'user_id': 42, 'user_name': 'Emma Allen'}, {'user_id': 68, 'user_name': 'Larry Stewart'}, {'user_id': 81, 'user_name': 'Jennifer Morales'}, {'user_id': 55, 'user_name': 'Christine Hughes'}, {'user_id': 19, 'user_name': 'Andrew Torres'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}, {'user_id': 4, 'user_name': 'Kenneth Castillo'}]",,MEDIUM
Which users have carts containing more than 2 distinct products?,"SELECT u.user_id,
       u.user_name,
       COUNT(DISTINCT ci.cart_item_product_id) AS distinct_products
FROM users AS u
JOIN cart AS c
    ON c.cart_user_id = u.user_id
JOIN cart_items AS ci
    ON ci.cart_item_cart_id = c.cart_id
GROUP BY u.user_id, u.user_name
HAVING COUNT(DISTINCT ci.cart_item_product_id) > 2;","[{'user_id': 5, 'user_name': 'Pamela Patel', 'distinct_products': 6}, {'user_id': 12, 'user_name': 'Sharon Carter', 'distinct_products': 4}, {'user_id': 14, 'user_name': 'Joseph Sanders', 'distinct_products': 9}, {'user_id': 16, 'user_name': 'Raymond Ruiz', 'distinct_products': 5}, {'user_id': 18, 'user_name': 'Karen Hernandez', 'distinct_products': 4}, {'user_id': 25, 'user_name': 'Emily Robinson', 'distinct_products': 3}, {'user_id': 27, 'user_name': 'Justin Morgan', 'distinct_products': 6}, {'user_id': 29, 'user_name': 'Jeffrey Davis', 'distinct_products': 7}, {'user_id': 39, 'user_name': 'Emma Hernandez', 'distinct_products': 4}, {'user_id': 40, 'user_name': 'Sandra Garcia', 'distinct_products': 3}, {'user_id': 45, 'user_name': 'Brian Martinez', 'distinct_products': 4}, {'user_id': 46, 'user_name': 'Brenda Diaz', 'distinct_products': 4}, {'user_id': 47, 'user_name': 'Margaret Clark', 'distinct_products': 4}, {'user_id': 50, 'user_name': 'Stephanie Lopez', 'distinct_products': 7}, {'user_id': 54, 'user_name': 'Scott Howard', 'distinct_products': 4}, {'user_id': 56, 'user_name': 'Jacob Brown', 'distinct_products': 3}, {'user_id': 58, 'user_name': 'Brenda Price', 'distinct_products': 5}, {'user_id': 61, 'user_name': 'Michael Bailey', 'distinct_products': 5}, {'user_id': 63, 'user_name': 'Jeffrey Davis', 'distinct_products': 3}, {'user_id': 67, 'user_name': 'Sandra Harris', 'distinct_products': 3}, {'user_id': 73, 'user_name': 'Richard Reed', 'distinct_products': 4}, {'user_id': 74, 'user_name': 'Scott Ortiz', 'distinct_products': 3}, {'user_id': 76, 'user_name': 'Emma Howard', 'distinct_products': 4}, {'user_id': 77, 'user_name': 'Christine James', 'distinct_products': 3}, {'user_id': 78, 'user_name': 'William Reed', 'distinct_products': 3}, {'user_id': 82, 'user_name': 'Edward Diaz', 'distinct_products': 3}, {'user_id': 86, 'user_name': 'Brenda King', 'distinct_products': 3}, {'user_id': 90, 'user_name': 'John Ward', 'distinct_products': 4}, {'user_id': 94, 'user_name': 'Kevin Anderson', 'distinct_products': 8}, {'user_id': 96, 'user_name': 'Ryan Kim', 'distinct_products': 7}, {'user_id': 99, 'user_name': 'Betty Ross', 'distinct_products': 4}, {'user_id': 100, 'user_name': 'Carolyn Ward', 'distinct_products': 3}]",,HARD
Which products belong to more than one category?,"SELECT p.product_id,
       p.product_name,
       COUNT(cp.category_product_category_id) AS category_count
FROM products AS p
JOIN category_products AS cp
    ON cp.category_product_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING COUNT(cp.category_product_category_id) > 1;","[{'product_id': 58, 'product_name': 'Tire', 'category_count': 2}, {'product_id': 8, 'product_name': 'TV', 'category_count': 2}, {'product_id': 184, 'product_name': 'Product 184', 'category_count': 2}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'category_count': 2}, {'product_id': 71, 'product_name': 'Stapler', 'category_count': 3}, {'product_id': 146, 'product_name': 'Cooling Fan', 'category_count': 3}, {'product_id': 80, 'product_name': 'Blu-ray', 'category_count': 3}, {'product_id': 70, 'product_name': 'Pen Set', 'category_count': 3}, {'product_id': 162, 'product_name': 'Solar Panel', 'category_count': 2}, {'product_id': 132, 'product_name': 'Power Bank', 'category_count': 3}, {'product_id': 170, 'product_name': 'Toolbox', 'category_count': 2}, {'product_id': 192, 'product_name': 'Product 192', 'category_count': 2}, {'product_id': 92, 'product_name': 'Blender', 'category_count': 3}, {'product_id': 101, 'product_name': 'Nightstand', 'category_count': 2}, {'product_id': 115, 'product_name': 'Backpack', 'category_count': 2}, {'product_id': 60, 'product_name': 'Coffee', 'category_count': 3}, {'product_id': 97, 'product_name': 'Desk', 'category_count': 2}, {'product_id': 112, 'product_name': 'Sandals', 'category_count': 2}, {'product_id': 22, 'product_name': 'Textbook', 'category_count': 3}, {'product_id': 156, 'product_name': 'Humidifier', 'category_count': 2}, {'product_id': 197, 'product_name': 'Product 197', 'category_count': 3}, {'product_id': 135, 'product_name': 'Webcam', 'category_count': 2}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'category_count': 2}, {'product_id': 124, 'product_name': 'Balloons', 'category_count': 2}, {'product_id': 98, 'product_name': 'Bookshelf', 'category_count': 2}, {'product_id': 149, 'product_name': 'Monitor Arm', 'category_count': 3}, {'product_id': 200, 'product_name': 'Product 200', 'category_count': 2}, {'product_id': 73, 'product_name': 'Vitamins', 'category_count': 2}, {'product_id': 103, 'product_name': 'Stroller', 'category_count': 3}, {'product_id': 11, 'product_name': 'Mouse', 'category_count': 3}, {'product_id': 42, 'product_name': 'Skateboard', 'category_count': 2}, {'product_id': 189, 'product_name': 'Product 189', 'category_count': 2}, {'product_id': 161, 'product_name': 'Battery Pack', 'category_count': 3}, {'product_id': 121, 'product_name': 'Sculpture', 'category_count': 3}, {'product_id': 117, 'product_name': 'Suitcase', 'category_count': 2}, {'product_id': 82, 'product_name': 'Console', 'category_count': 2}, {'product_id': 188, 'product_name': 'Product 188', 'category_count': 2}, {'product_id': 40, 'product_name': 'Dumbbell', 'category_count': 2}, {'product_id': 153, 'product_name': 'Doorbell', 'category_count': 2}, {'product_id': 43, 'product_name': 'Helmet', 'category_count': 2}, {'product_id': 147, 'product_name': 'Mousepad', 'category_count': 3}, {'product_id': 9, 'product_name': 'Monitor', 'category_count': 2}, {'product_id': 196, 'product_name': 'Product 196', 'category_count': 3}, {'product_id': 120, 'product_name': 'Wall Art', 'category_count': 2}, {'product_id': 15, 'product_name': 'Shoes', 'category_count': 3}, {'product_id': 26, 'product_name': 'Sofa', 'category_count': 2}, {'product_id': 187, 'product_name': 'Product 187', 'category_count': 2}, {'product_id': 85, 'product_name': 'Hammer', 'category_count': 2}, {'product_id': 72, 'product_name': 'Filing Cabinet', 'category_count': 2}, {'product_id': 95, 'product_name': 'Knife Set', 'category_count': 2}, {'product_id': 81, 'product_name': 'Video Game', 'category_count': 2}, {'product_id': 61, 'product_name': 'Tea', 'category_count': 2}, {'product_id': 160, 'product_name': 'Surge Protector', 'category_count': 3}, {'product_id': 77, 'product_name': 'Microphone', 'category_count': 2}, {'product_id': 30, 'product_name': 'Rug', 'category_count': 3}, {'product_id': 131, 'product_name': 'USB Cable', 'category_count': 3}, {'product_id': 3, 'product_name': 'Tablet', 'category_count': 2}, {'product_id': 17, 'product_name': 'Dress', 'category_count': 2}, {'product_id': 37, 'product_name': 'Football', 'category_count': 3}, {'product_id': 28, 'product_name': 'Table', 'category_count': 3}, {'product_id': 104, 'product_name': 'Car Seat', 'category_count': 3}, {'product_id': 5, 'product_name': 'Speaker', 'category_count': 2}, {'product_id': 171, 'product_name': 'Work Gloves', 'category_count': 2}, {'product_id': 165, 'product_name': 'Multi-tool', 'category_count': 2}, {'product_id': 91, 'product_name': 'Backpack', 'category_count': 3}, {'product_id': 74, 'product_name': 'First Aid Kit', 'category_count': 3}, {'product_id': 54, 'product_name': 'Makeup Kit', 'category_count': 2}, {'product_id': 29, 'product_name': 'Lamp', 'category_count': 2}, {'product_id': 4, 'product_name': 'Headphones', 'category_count': 3}, {'product_id': 138, 'product_name': 'Cable Organizer', 'category_count': 3}, {'product_id': 34, 'product_name': 'Mirror', 'category_count': 3}, {'product_id': 96, 'product_name': 'Cookware', 'category_count': 3}, {'product_id': 83, 'product_name': 'Controller', 'category_count': 3}, {'product_id': 67, 'product_name': 'Leash', 'category_count': 2}, {'product_id': 63, 'product_name': 'Pasta', 'category_count': 3}, {'product_id': 90, 'product_name': 'Cooler', 'category_count': 2}, {'product_id': 10, 'product_name': 'Keyboard', 'category_count': 2}, {'product_id': 45, 'product_name': 'Puzzle', 'category_count': 3}, {'product_id': 107, 'product_name': 'Ring', 'category_count': 3}, {'product_id': 86, 'product_name': 'Saw', 'category_count': 2}, {'product_id': 39, 'product_name': 'Yoga Mat', 'category_count': 3}, {'product_id': 163, 'product_name': 'Flashlight', 'category_count': 3}, {'product_id': 93, 'product_name': 'Toaster', 'category_count': 3}, {'product_id': 175, 'product_name': 'Ladder', 'category_count': 3}, {'product_id': 36, 'product_name': 'Basketball', 'category_count': 3}, {'product_id': 50, 'product_name': 'Lipstick', 'category_count': 2}, {'product_id': 102, 'product_name': 'Crib', 'category_count': 3}, {'product_id': 167, 'product_name': 'Level', 'category_count': 3}, {'product_id': 158, 'product_name': 'Heater', 'category_count': 2}, {'product_id': 155, 'product_name': 'Air Purifier', 'category_count': 2}, {'product_id': 133, 'product_name': 'External Hard Drive', 'category_count': 2}, {'product_id': 195, 'product_name': 'Product 195', 'category_count': 3}, {'product_id': 111, 'product_name': 'Boots', 'category_count': 2}, {'product_id': 16, 'product_name': 'Hat', 'category_count': 3}, {'product_id': 199, 'product_name': 'Product 199', 'category_count': 3}, {'product_id': 62, 'product_name': 'Snacks', 'category_count': 2}, {'product_id': 123, 'product_name': 'Paint Set', 'category_count': 3}, {'product_id': 75, 'product_name': 'Thermometer', 'category_count': 3}, {'product_id': 126, 'product_name': 'Wrapping Paper', 'category_count': 2}, {'product_id': 194, 'product_name': 'Product 194', 'category_count': 3}, {'product_id': 99, 'product_name': 'Bed Frame', 'category_count': 2}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'category_count': 3}, {'product_id': 46, 'product_name': 'Board Game', 'category_count': 2}, {'product_id': 157, 'product_name': 'Fan', 'category_count': 3}, {'product_id': 32, 'product_name': 'Plant', 'category_count': 2}, {'product_id': 7, 'product_name': 'Watch', 'category_count': 3}, {'product_id': 183, 'product_name': 'Hinges', 'category_count': 2}, {'product_id': 100, 'product_name': 'Dresser', 'category_count': 2}, {'product_id': 38, 'product_name': 'Tennis Racket', 'category_count': 3}, {'product_id': 150, 'product_name': 'LED Strip', 'category_count': 2}, {'product_id': 139, 'product_name': 'Screen Protector', 'category_count': 3}, {'product_id': 193, 'product_name': 'Product 193', 'category_count': 3}, {'product_id': 12, 'product_name': 'Shirt', 'category_count': 3}, {'product_id': 164, 'product_name': 'Lantern', 'category_count': 3}, {'product_id': 78, 'product_name': 'Drum Set', 'category_count': 2}, {'product_id': 24, 'product_name': 'Comic', 'category_count': 2}, {'product_id': 25, 'product_name': 'Journal', 'category_count': 3}, {'product_id': 186, 'product_name': 'Product 186', 'category_count': 3}, {'product_id': 154, 'product_name': 'Thermostat', 'category_count': 3}, {'product_id': 1, 'product_name': 'Laptop', 'category_count': 2}, {'product_id': 76, 'product_name': 'Guitar', 'category_count': 3}, {'product_id': 185, 'product_name': 'Product 185', 'category_count': 2}, {'product_id': 64, 'product_name': 'Sauce', 'category_count': 2}, {'product_id': 110, 'product_name': 'Sneakers', 'category_count': 3}, {'product_id': 178, 'product_name': 'Sandpaper', 'category_count': 2}, {'product_id': 55, 'product_name': 'Hair Dryer', 'category_count': 3}, {'product_id': 148, 'product_name': 'Desk Mat', 'category_count': 3}, {'product_id': 130, 'product_name': 'Laptop Stand', 'category_count': 3}, {'product_id': 27, 'product_name': 'Chair', 'category_count': 2}, {'product_id': 143, 'product_name': 'Graphics Card', 'category_count': 3}]",,MEDIUM
"Which users placed orders that included products tagged as ""premium""?","SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
JOIN product_tags AS pt
    ON pt.product_tag_product_id = oi.order_item_product_id
JOIN tags AS t
    ON t.tag_id = pt.product_tag_tag_id
WHERE t.tag_name = 'premium';",[],,HARD
Which products were reviewed and also appear in orders that applied a coupon?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN reviews AS r
    ON r.review_product_id = p.product_id
JOIN order_items AS oi
    ON oi.order_item_product_id = p.product_id
JOIN order_coupons AS oc
    ON oc.order_coupon_order_id = oi.order_item_order_id;","[{'product_id': 109, 'product_name': 'Earrings'}, {'product_id': 120, 'product_name': 'Wall Art'}, {'product_id': 159, 'product_name': 'Extension Cord'}, {'product_id': 154, 'product_name': 'Thermostat'}, {'product_id': 118, 'product_name': 'Smartwatch'}, {'product_id': 4, 'product_name': 'Headphones'}, {'product_id': 38, 'product_name': 'Tennis Racket'}, {'product_id': 200, 'product_name': 'Product 200'}, {'product_id': 127, 'product_name': 'Warehouse Shelving'}, {'product_id': 19, 'product_name': 'Jeans'}, {'product_id': 69, 'product_name': 'Notebook'}, {'product_id': 24, 'product_name': 'Comic'}, {'product_id': 78, 'product_name': 'Drum Set'}, {'product_id': 188, 'product_name': 'Product 188'}, {'product_id': 177, 'product_name': 'Paintbrush'}, {'product_id': 18, 'product_name': 'Sweater'}, {'product_id': 136, 'product_name': 'Router'}, {'product_id': 148, 'product_name': 'Desk Mat'}, {'product_id': 161, 'product_name': 'Battery Pack'}, {'product_id': 42, 'product_name': 'Skateboard'}, {'product_id': 55, 'product_name': 'Hair Dryer'}, {'product_id': 28, 'product_name': 'Table'}, {'product_id': 111, 'product_name': 'Boots'}, {'product_id': 89, 'product_name': 'Sleeping Bag'}, {'product_id': 14, 'product_name': 'Jacket'}, {'product_id': 133, 'product_name': 'External Hard Drive'}, {'product_id': 47, 'product_name': 'Doll'}, {'product_id': 6, 'product_name': 'Camera'}, {'product_id': 82, 'product_name': 'Console'}, {'product_id': 87, 'product_name': 'Screwdriver Set'}, {'product_id': 112, 'product_name': 'Sandals'}, {'product_id': 11, 'product_name': 'Mouse'}, {'product_id': 149, 'product_name': 'Monitor Arm'}, {'product_id': 5, 'product_name': 'Speaker'}, {'product_id': 93, 'product_name': 'Toaster'}, {'product_id': 41, 'product_name': 'Bike'}, {'product_id': 43, 'product_name': 'Helmet'}, {'product_id': 84, 'product_name': 'Drill'}, {'product_id': 35, 'product_name': 'Clock'}, {'product_id': 106, 'product_name': 'Necklace'}, {'product_id': 48, 'product_name': 'LEGO Set'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 196, 'product_name': 'Product 196'}, {'product_id': 88, 'product_name': 'Tent'}, {'product_id': 152, 'product_name': 'Security Camera'}, {'product_id': 56, 'product_name': 'Car Battery'}, {'product_id': 13, 'product_name': 'Pants'}, {'product_id': 95, 'product_name': 'Knife Set'}, {'product_id': 73, 'product_name': 'Vitamins'}, {'product_id': 34, 'product_name': 'Mirror'}, {'product_id': 186, 'product_name': 'Product 186'}, {'product_id': 170, 'product_name': 'Toolbox'}, {'product_id': 96, 'product_name': 'Cookware'}, {'product_id': 131, 'product_name': 'USB Cable'}, {'product_id': 192, 'product_name': 'Product 192'}, {'product_id': 57, 'product_name': 'Oil Filter'}, {'product_id': 139, 'product_name': 'Screen Protector'}, {'product_id': 123, 'product_name': 'Paint Set'}, {'product_id': 162, 'product_name': 'Solar Panel'}, {'product_id': 182, 'product_name': 'Anchors'}, {'product_id': 83, 'product_name': 'Controller'}, {'product_id': 145, 'product_name': 'SSD'}, {'product_id': 39, 'product_name': 'Yoga Mat'}, {'product_id': 101, 'product_name': 'Nightstand'}, {'product_id': 10, 'product_name': 'Keyboard'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 21, 'product_name': 'Novel'}, {'product_id': 52, 'product_name': 'Shampoo'}, {'product_id': 116, 'product_name': 'Wallet'}, {'product_id': 25, 'product_name': 'Journal'}, {'product_id': 194, 'product_name': 'Product 194'}, {'product_id': 54, 'product_name': 'Makeup Kit'}, {'product_id': 74, 'product_name': 'First Aid Kit'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 171, 'product_name': 'Work Gloves'}, {'product_id': 199, 'product_name': 'Product 199'}, {'product_id': 174, 'product_name': 'Respirator'}, {'product_id': 33, 'product_name': 'Vase'}, {'product_id': 137, 'product_name': 'Switch'}, {'product_id': 67, 'product_name': 'Leash'}, {'product_id': 91, 'product_name': 'Backpack'}, {'product_id': 23, 'product_name': 'Magazine'}, {'product_id': 140, 'product_name': 'Phone Case'}, {'product_id': 68, 'product_name': 'Pet Bed'}, {'product_id': 1, 'product_name': 'Laptop'}, {'product_id': 114, 'product_name': 'Handbag'}, {'product_id': 66, 'product_name': 'Cat Toy'}, {'product_id': 9, 'product_name': 'Monitor'}, {'product_id': 30, 'product_name': 'Rug'}, {'product_id': 20, 'product_name': 'Socks'}, {'product_id': 183, 'product_name': 'Hinges'}, {'product_id': 92, 'product_name': 'Blender'}, {'product_id': 153, 'product_name': 'Doorbell'}, {'product_id': 75, 'product_name': 'Thermometer'}, {'product_id': 185, 'product_name': 'Product 185'}, {'product_id': 173, 'product_name': 'Ear Protection'}, {'product_id': 31, 'product_name': 'Curtains'}, {'product_id': 179, 'product_name': 'Wood Glue'}, {'product_id': 115, 'product_name': 'Backpack'}, {'product_id': 7, 'product_name': 'Watch'}, {'product_id': 110, 'product_name': 'Sneakers'}, {'product_id': 129, 'product_name': 'Smartphone'}, {'product_id': 155, 'product_name': 'Air Purifier'}, {'product_id': 122, 'product_name': 'Canvas'}, {'product_id': 53, 'product_name': 'Lotion'}, {'product_id': 178, 'product_name': 'Sandpaper'}, {'product_id': 169, 'product_name': 'Pliers'}, {'product_id': 132, 'product_name': 'Power Bank'}, {'product_id': 85, 'product_name': 'Hammer'}, {'product_id': 36, 'product_name': 'Basketball'}, {'product_id': 17, 'product_name': 'Dress'}, {'product_id': 164, 'product_name': 'Lantern'}, {'product_id': 8, 'product_name': 'TV'}, {'product_id': 100, 'product_name': 'Dresser'}, {'product_id': 193, 'product_name': 'Product 193'}, {'product_id': 142, 'product_name': 'Bluetooth Adapter'}, {'product_id': 76, 'product_name': 'Guitar'}, {'product_id': 97, 'product_name': 'Desk'}, {'product_id': 90, 'product_name': 'Cooler'}, {'product_id': 79, 'product_name': 'DVD'}, {'product_id': 50, 'product_name': 'Lipstick'}, {'product_id': 156, 'product_name': 'Humidifier'}, {'product_id': 158, 'product_name': 'Heater'}, {'product_id': 45, 'product_name': 'Puzzle'}, {'product_id': 86, 'product_name': 'Saw'}, {'product_id': 144, 'product_name': 'RAM'}, {'product_id': 128, 'product_name': 'Safety Vest'}, {'product_id': 104, 'product_name': 'Car Seat'}]",,HARD
Which vendors supplied products included in delivered shipments?,"SELECT DISTINCT v.vendor_id,
       v.vendor_name
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN order_items AS oi
    ON oi.order_item_product_id = pv.product_vendor_product_id
JOIN shipments AS s
    ON s.shipment_order_id = oi.order_item_order_id
WHERE s.shipment_status = 'delivered';","[{'vendor_id': 27, 'vendor_name': 'Vendor LLC 27'}, {'vendor_id': 40, 'vendor_name': 'Vendor Group 40'}, {'vendor_id': 46, 'vendor_name': 'Vendor Supply Co 46'}, {'vendor_id': 21, 'vendor_name': 'Vendor LLC 21'}, {'vendor_id': 28, 'vendor_name': 'Vendor Supply Co 28'}, {'vendor_id': 45, 'vendor_name': 'Vendor Industries 45'}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36'}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39'}, {'vendor_id': 41, 'vendor_name': 'Vendor Group 41'}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19'}, {'vendor_id': 35, 'vendor_name': 'Vendor Supply Co 35'}, {'vendor_id': 43, 'vendor_name': 'Vendor Enterprises 43'}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5'}, {'vendor_id': 32, 'vendor_name': 'Vendor Industries 32'}, {'vendor_id': 22, 'vendor_name': 'Vendor Industries 22'}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30'}, {'vendor_id': 20, 'vendor_name': 'Vendor Enterprises 20'}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7'}, {'vendor_id': 25, 'vendor_name': 'Vendor Group 25'}, {'vendor_id': 9, 'vendor_name': 'Vendor Group 9'}, {'vendor_id': 23, 'vendor_name': 'Vendor Enterprises 23'}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50'}, {'vendor_id': 33, 'vendor_name': 'Vendor LLC 33'}, {'vendor_id': 11, 'vendor_name': 'Vendor Supply Co 11'}, {'vendor_id': 13, 'vendor_name': 'Vendor Corp 13'}, {'vendor_id': 6, 'vendor_name': 'Vendor LLC 6'}, {'vendor_id': 4, 'vendor_name': 'Vendor LLC 4'}, {'vendor_id': 34, 'vendor_name': 'Vendor Corp 34'}, {'vendor_id': 10, 'vendor_name': 'Vendor Group 10'}, {'vendor_id': 15, 'vendor_name': 'Vendor LLC 15'}, {'vendor_id': 18, 'vendor_name': 'Vendor Industries 18'}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2'}, {'vendor_id': 16, 'vendor_name': 'Vendor LLC 16'}, {'vendor_id': 14, 'vendor_name': 'Vendor Corp 14'}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12'}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8'}, {'vendor_id': 44, 'vendor_name': 'Vendor Group 44'}, {'vendor_id': 49, 'vendor_name': 'Vendor LLC 49'}, {'vendor_id': 1, 'vendor_name': 'Vendor Corp 1'}, {'vendor_id': 48, 'vendor_name': 'Vendor Supply Co 48'}, {'vendor_id': 29, 'vendor_name': 'Vendor Corp 29'}, {'vendor_id': 26, 'vendor_name': 'Vendor LLC 26'}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3'}, {'vendor_id': 47, 'vendor_name': 'Vendor Supply Co 47'}, {'vendor_id': 42, 'vendor_name': 'Vendor Supply Co 42'}, {'vendor_id': 31, 'vendor_name': 'Vendor Enterprises 31'}, {'vendor_id': 38, 'vendor_name': 'Vendor Corp 38'}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17'}, {'vendor_id': 24, 'vendor_name': 'Vendor LLC 24'}, {'vendor_id': 37, 'vendor_name': 'Vendor LLC 37'}]",,HARD
Which users created wishlists that contain at least one product priced under $20?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN wishlist AS w
    ON w.wishlist_user_id = u.user_id
JOIN wishlist_items AS wi
    ON wi.wishlist_item_wishlist_id = w.wishlist_id
JOIN products AS p
    ON p.product_id = wi.wishlist_item_product_id
WHERE p.product_price < 20.00;","[{'user_id': 44, 'user_name': 'Lisa Robinson'}]",,HARD
Which orders include products that received an average rating above 8?,"SELECT DISTINCT o.order_id,
       o.order_user_id
FROM orders AS o
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
JOIN (
    SELECT r.review_product_id,
           AVG(r.review_rating) AS avg_rating
    FROM reviews AS r
    GROUP BY r.review_product_id
) AS ratings
    ON ratings.review_product_id = oi.order_item_product_id
WHERE ratings.avg_rating > 8;","[{'order_id': 235, 'order_user_id': 73}, {'order_id': 190, 'order_user_id': 33}, {'order_id': 57, 'order_user_id': 7}, {'order_id': 123, 'order_user_id': 66}, {'order_id': 22, 'order_user_id': 46}, {'order_id': 241, 'order_user_id': 3}, {'order_id': 178, 'order_user_id': 73}, {'order_id': 292, 'order_user_id': 60}, {'order_id': 246, 'order_user_id': 14}, {'order_id': 222, 'order_user_id': 66}, {'order_id': 134, 'order_user_id': 45}, {'order_id': 257, 'order_user_id': 52}, {'order_id': 84, 'order_user_id': 33}, {'order_id': 87, 'order_user_id': 51}, {'order_id': 115, 'order_user_id': 22}, {'order_id': 211, 'order_user_id': 6}, {'order_id': 140, 'order_user_id': 21}, {'order_id': 107, 'order_user_id': 45}, {'order_id': 70, 'order_user_id': 37}, {'order_id': 156, 'order_user_id': 83}, {'order_id': 149, 'order_user_id': 68}, {'order_id': 147, 'order_user_id': 37}, {'order_id': 104, 'order_user_id': 21}, {'order_id': 270, 'order_user_id': 75}, {'order_id': 236, 'order_user_id': 54}, {'order_id': 97, 'order_user_id': 12}, {'order_id': 232, 'order_user_id': 51}, {'order_id': 184, 'order_user_id': 61}, {'order_id': 288, 'order_user_id': 11}, {'order_id': 240, 'order_user_id': 4}, {'order_id': 173, 'order_user_id': 83}, {'order_id': 153, 'order_user_id': 73}, {'order_id': 15, 'order_user_id': 19}, {'order_id': 267, 'order_user_id': 51}, {'order_id': 202, 'order_user_id': 43}, {'order_id': 295, 'order_user_id': 40}, {'order_id': 151, 'order_user_id': 34}, {'order_id': 137, 'order_user_id': 88}, {'order_id': 247, 'order_user_id': 89}, {'order_id': 189, 'order_user_id': 20}, {'order_id': 6, 'order_user_id': 19}, {'order_id': 237, 'order_user_id': 64}, {'order_id': 126, 'order_user_id': 5}, {'order_id': 105, 'order_user_id': 15}, {'order_id': 168, 'order_user_id': 88}, {'order_id': 209, 'order_user_id': 53}, {'order_id': 128, 'order_user_id': 44}, {'order_id': 113, 'order_user_id': 67}, {'order_id': 167, 'order_user_id': 29}, {'order_id': 77, 'order_user_id': 57}, {'order_id': 1, 'order_user_id': 21}, {'order_id': 148, 'order_user_id': 11}, {'order_id': 81, 'order_user_id': 8}, {'order_id': 53, 'order_user_id': 10}, {'order_id': 67, 'order_user_id': 33}, {'order_id': 297, 'order_user_id': 13}, {'order_id': 294, 'order_user_id': 18}, {'order_id': 228, 'order_user_id': 23}, {'order_id': 200, 'order_user_id': 34}, {'order_id': 145, 'order_user_id': 78}, {'order_id': 55, 'order_user_id': 38}, {'order_id': 244, 'order_user_id': 26}, {'order_id': 177, 'order_user_id': 22}, {'order_id': 208, 'order_user_id': 35}, {'order_id': 98, 'order_user_id': 4}, {'order_id': 258, 'order_user_id': 57}, {'order_id': 127, 'order_user_id': 6}, {'order_id': 111, 'order_user_id': 63}, {'order_id': 275, 'order_user_id': 26}, {'order_id': 155, 'order_user_id': 11}, {'order_id': 60, 'order_user_id': 65}, {'order_id': 59, 'order_user_id': 14}, {'order_id': 49, 'order_user_id': 88}, {'order_id': 92, 'order_user_id': 45}, {'order_id': 34, 'order_user_id': 61}, {'order_id': 3, 'order_user_id': 55}, {'order_id': 296, 'order_user_id': 55}, {'order_id': 191, 'order_user_id': 28}, {'order_id': 172, 'order_user_id': 48}, {'order_id': 141, 'order_user_id': 15}, {'order_id': 162, 'order_user_id': 42}, {'order_id': 268, 'order_user_id': 27}, {'order_id': 65, 'order_user_id': 37}, {'order_id': 253, 'order_user_id': 64}, {'order_id': 66, 'order_user_id': 57}, {'order_id': 41, 'order_user_id': 4}, {'order_id': 72, 'order_user_id': 17}, {'order_id': 183, 'order_user_id': 18}, {'order_id': 102, 'order_user_id': 49}, {'order_id': 88, 'order_user_id': 78}, {'order_id': 26, 'order_user_id': 6}, {'order_id': 289, 'order_user_id': 30}, {'order_id': 71, 'order_user_id': 9}, {'order_id': 280, 'order_user_id': 47}, {'order_id': 290, 'order_user_id': 65}, {'order_id': 174, 'order_user_id': 71}, {'order_id': 263, 'order_user_id': 35}, {'order_id': 96, 'order_user_id': 71}, {'order_id': 11, 'order_user_id': 41}, {'order_id': 24, 'order_user_id': 37}, {'order_id': 217, 'order_user_id': 38}, {'order_id': 5, 'order_user_id': 46}, {'order_id': 152, 'order_user_id': 50}, {'order_id': 285, 'order_user_id': 81}, {'order_id': 158, 'order_user_id': 36}, {'order_id': 142, 'order_user_id': 47}, {'order_id': 68, 'order_user_id': 62}, {'order_id': 83, 'order_user_id': 35}, {'order_id': 215, 'order_user_id': 83}, {'order_id': 73, 'order_user_id': 47}, {'order_id': 12, 'order_user_id': 14}, {'order_id': 265, 'order_user_id': 56}, {'order_id': 136, 'order_user_id': 77}, {'order_id': 291, 'order_user_id': 70}, {'order_id': 264, 'order_user_id': 33}, {'order_id': 213, 'order_user_id': 26}, {'order_id': 231, 'order_user_id': 15}, {'order_id': 192, 'order_user_id': 20}, {'order_id': 82, 'order_user_id': 26}, {'order_id': 207, 'order_user_id': 61}, {'order_id': 218, 'order_user_id': 13}, {'order_id': 188, 'order_user_id': 62}, {'order_id': 62, 'order_user_id': 13}, {'order_id': 252, 'order_user_id': 64}, {'order_id': 239, 'order_user_id': 69}, {'order_id': 94, 'order_user_id': 27}, {'order_id': 161, 'order_user_id': 77}, {'order_id': 279, 'order_user_id': 10}, {'order_id': 130, 'order_user_id': 59}, {'order_id': 75, 'order_user_id': 61}, {'order_id': 40, 'order_user_id': 27}, {'order_id': 7, 'order_user_id': 54}, {'order_id': 271, 'order_user_id': 37}, {'order_id': 10, 'order_user_id': 35}, {'order_id': 154, 'order_user_id': 76}, {'order_id': 99, 'order_user_id': 72}, {'order_id': 116, 'order_user_id': 86}, {'order_id': 69, 'order_user_id': 50}, {'order_id': 46, 'order_user_id': 43}, {'order_id': 14, 'order_user_id': 40}, {'order_id': 186, 'order_user_id': 73}, {'order_id': 187, 'order_user_id': 37}, {'order_id': 286, 'order_user_id': 42}, {'order_id': 197, 'order_user_id': 11}, {'order_id': 138, 'order_user_id': 81}, {'order_id': 272, 'order_user_id': 64}, {'order_id': 229, 'order_user_id': 60}, {'order_id': 76, 'order_user_id': 50}, {'order_id': 282, 'order_user_id': 49}, {'order_id': 225, 'order_user_id': 67}, {'order_id': 242, 'order_user_id': 8}, {'order_id': 181, 'order_user_id': 67}, {'order_id': 17, 'order_user_id': 70}, {'order_id': 29, 'order_user_id': 83}, {'order_id': 226, 'order_user_id': 27}, {'order_id': 262, 'order_user_id': 82}, {'order_id': 110, 'order_user_id': 44}, {'order_id': 4, 'order_user_id': 26}, {'order_id': 169, 'order_user_id': 66}, {'order_id': 255, 'order_user_id': 48}, {'order_id': 251, 'order_user_id': 16}, {'order_id': 221, 'order_user_id': 38}, {'order_id': 118, 'order_user_id': 83}, {'order_id': 18, 'order_user_id': 65}, {'order_id': 195, 'order_user_id': 24}, {'order_id': 223, 'order_user_id': 70}, {'order_id': 56, 'order_user_id': 41}, {'order_id': 124, 'order_user_id': 81}, {'order_id': 176, 'order_user_id': 64}, {'order_id': 273, 'order_user_id': 30}, {'order_id': 281, 'order_user_id': 67}, {'order_id': 227, 'order_user_id': 84}, {'order_id': 203, 'order_user_id': 52}, {'order_id': 248, 'order_user_id': 78}, {'order_id': 121, 'order_user_id': 67}, {'order_id': 261, 'order_user_id': 41}, {'order_id': 48, 'order_user_id': 35}, {'order_id': 276, 'order_user_id': 22}, {'order_id': 293, 'order_user_id': 37}, {'order_id': 198, 'order_user_id': 21}, {'order_id': 283, 'order_user_id': 20}, {'order_id': 157, 'order_user_id': 41}, {'order_id': 47, 'order_user_id': 51}, {'order_id': 175, 'order_user_id': 9}, {'order_id': 20, 'order_user_id': 15}, {'order_id': 205, 'order_user_id': 71}, {'order_id': 133, 'order_user_id': 20}, {'order_id': 21, 'order_user_id': 22}, {'order_id': 210, 'order_user_id': 25}, {'order_id': 64, 'order_user_id': 72}, {'order_id': 259, 'order_user_id': 47}, {'order_id': 224, 'order_user_id': 50}, {'order_id': 119, 'order_user_id': 89}, {'order_id': 212, 'order_user_id': 3}, {'order_id': 193, 'order_user_id': 86}, {'order_id': 61, 'order_user_id': 41}, {'order_id': 19, 'order_user_id': 60}]",,EXTRA
Which shipments were delivered to users who have written at least one review?,"SELECT DISTINCT s.shipment_id,
       s.shipment_order_id
FROM shipments AS s
JOIN orders AS o
    ON o.order_id = s.shipment_order_id
JOIN users AS u
    ON u.user_id = o.order_user_id
JOIN reviews AS r
    ON r.review_user_id = u.user_id
WHERE s.shipment_status = 'delivered';","[{'shipment_id': 172, 'shipment_order_id': 172}, {'shipment_id': 255, 'shipment_order_id': 255}, {'shipment_id': 289, 'shipment_order_id': 289}, {'shipment_id': 25, 'shipment_order_id': 25}, {'shipment_id': 285, 'shipment_order_id': 285}, {'shipment_id': 55, 'shipment_order_id': 55}, {'shipment_id': 242, 'shipment_order_id': 242}, {'shipment_id': 1, 'shipment_order_id': 1}, {'shipment_id': 123, 'shipment_order_id': 123}, {'shipment_id': 52, 'shipment_order_id': 52}, {'shipment_id': 183, 'shipment_order_id': 183}, {'shipment_id': 22, 'shipment_order_id': 22}, {'shipment_id': 228, 'shipment_order_id': 228}, {'shipment_id': 10, 'shipment_order_id': 10}, {'shipment_id': 160, 'shipment_order_id': 160}, {'shipment_id': 58, 'shipment_order_id': 58}, {'shipment_id': 295, 'shipment_order_id': 295}, {'shipment_id': 109, 'shipment_order_id': 109}, {'shipment_id': 214, 'shipment_order_id': 214}, {'shipment_id': 71, 'shipment_order_id': 71}, {'shipment_id': 66, 'shipment_order_id': 66}, {'shipment_id': 140, 'shipment_order_id': 140}, {'shipment_id': 53, 'shipment_order_id': 53}, {'shipment_id': 111, 'shipment_order_id': 111}, {'shipment_id': 78, 'shipment_order_id': 78}, {'shipment_id': 62, 'shipment_order_id': 62}, {'shipment_id': 265, 'shipment_order_id': 265}, {'shipment_id': 292, 'shipment_order_id': 292}, {'shipment_id': 165, 'shipment_order_id': 165}, {'shipment_id': 177, 'shipment_order_id': 177}, {'shipment_id': 171, 'shipment_order_id': 171}, {'shipment_id': 220, 'shipment_order_id': 220}, {'shipment_id': 99, 'shipment_order_id': 99}, {'shipment_id': 74, 'shipment_order_id': 74}, {'shipment_id': 217, 'shipment_order_id': 217}, {'shipment_id': 42, 'shipment_order_id': 42}, {'shipment_id': 258, 'shipment_order_id': 258}, {'shipment_id': 210, 'shipment_order_id': 210}, {'shipment_id': 145, 'shipment_order_id': 145}, {'shipment_id': 124, 'shipment_order_id': 124}, {'shipment_id': 281, 'shipment_order_id': 281}, {'shipment_id': 152, 'shipment_order_id': 152}, {'shipment_id': 221, 'shipment_order_id': 221}, {'shipment_id': 247, 'shipment_order_id': 247}, {'shipment_id': 199, 'shipment_order_id': 199}, {'shipment_id': 115, 'shipment_order_id': 115}, {'shipment_id': 134, 'shipment_order_id': 134}, {'shipment_id': 238, 'shipment_order_id': 238}, {'shipment_id': 108, 'shipment_order_id': 108}, {'shipment_id': 77, 'shipment_order_id': 77}, {'shipment_id': 86, 'shipment_order_id': 86}, {'shipment_id': 213, 'shipment_order_id': 213}, {'shipment_id': 64, 'shipment_order_id': 64}, {'shipment_id': 24, 'shipment_order_id': 24}, {'shipment_id': 126, 'shipment_order_id': 126}, {'shipment_id': 159, 'shipment_order_id': 159}, {'shipment_id': 293, 'shipment_order_id': 293}, {'shipment_id': 120, 'shipment_order_id': 120}, {'shipment_id': 5, 'shipment_order_id': 5}, {'shipment_id': 212, 'shipment_order_id': 212}, {'shipment_id': 139, 'shipment_order_id': 139}, {'shipment_id': 166, 'shipment_order_id': 166}, {'shipment_id': 245, 'shipment_order_id': 245}, {'shipment_id': 262, 'shipment_order_id': 262}, {'shipment_id': 260, 'shipment_order_id': 260}, {'shipment_id': 218, 'shipment_order_id': 218}, {'shipment_id': 222, 'shipment_order_id': 222}, {'shipment_id': 128, 'shipment_order_id': 128}, {'shipment_id': 125, 'shipment_order_id': 125}, {'shipment_id': 266, 'shipment_order_id': 266}, {'shipment_id': 290, 'shipment_order_id': 290}, {'shipment_id': 26, 'shipment_order_id': 26}, {'shipment_id': 259, 'shipment_order_id': 259}, {'shipment_id': 154, 'shipment_order_id': 154}, {'shipment_id': 137, 'shipment_order_id': 137}, {'shipment_id': 271, 'shipment_order_id': 271}, {'shipment_id': 269, 'shipment_order_id': 269}, {'shipment_id': 110, 'shipment_order_id': 110}, {'shipment_id': 298, 'shipment_order_id': 298}, {'shipment_id': 6, 'shipment_order_id': 6}, {'shipment_id': 149, 'shipment_order_id': 149}, {'shipment_id': 275, 'shipment_order_id': 275}, {'shipment_id': 180, 'shipment_order_id': 180}, {'shipment_id': 76, 'shipment_order_id': 76}]",,HARD
Which products have been discounted during 2024 but never appeared in any wishlist?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN product_discounts AS pd
    ON pd.product_discount_product_id = p.product_id
JOIN discounts AS d
    ON d.discount_id = pd.product_discount_discount_id
LEFT JOIN wishlist_items AS wi
    ON wi.wishlist_item_product_id = p.product_id
WHERE d.discount_start_date < '2025-01-01'
  AND d.discount_end_date >= '2024-01-01'
  AND wi.wishlist_item_id IS NULL;","[{'product_id': 13, 'product_name': 'Pants'}, {'product_id': 24, 'product_name': 'Comic'}, {'product_id': 25, 'product_name': 'Journal'}, {'product_id': 27, 'product_name': 'Chair'}, {'product_id': 43, 'product_name': 'Helmet'}, {'product_id': 54, 'product_name': 'Makeup Kit'}, {'product_id': 56, 'product_name': 'Car Battery'}, {'product_id': 59, 'product_name': 'Wiper Blades'}, {'product_id': 61, 'product_name': 'Tea'}, {'product_id': 67, 'product_name': 'Leash'}, {'product_id': 75, 'product_name': 'Thermometer'}, {'product_id': 79, 'product_name': 'DVD'}, {'product_id': 115, 'product_name': 'Backpack'}, {'product_id': 116, 'product_name': 'Wallet'}, {'product_id': 119, 'product_name': 'Fitness Tracker'}, {'product_id': 128, 'product_name': 'Safety Vest'}, {'product_id': 131, 'product_name': 'USB Cable'}, {'product_id': 137, 'product_name': 'Switch'}, {'product_id': 139, 'product_name': 'Screen Protector'}, {'product_id': 140, 'product_name': 'Phone Case'}, {'product_id': 147, 'product_name': 'Mousepad'}, {'product_id': 149, 'product_name': 'Monitor Arm'}, {'product_id': 155, 'product_name': 'Air Purifier'}, {'product_id': 156, 'product_name': 'Humidifier'}, {'product_id': 177, 'product_name': 'Paintbrush'}, {'product_id': 186, 'product_name': 'Product 186'}, {'product_id': 187, 'product_name': 'Product 187'}, {'product_id': 191, 'product_name': 'Product 191'}, {'product_id': 195, 'product_name': 'Product 195'}, {'product_id': 196, 'product_name': 'Product 196'}, {'product_id': 197, 'product_name': 'Product 197'}, {'product_id': 198, 'product_name': 'Product 198'}]",,HARD
"Which payments used ""paypal"" and correspond to orders with total amounts above $150?","SELECT p.payment_id,
       p.payment_order_id,
       p.payment_status
FROM payments AS p
JOIN orders AS o
    ON o.order_id = p.payment_order_id
WHERE p.payment_method = 'paypal'
  AND o.order_total > 150.00;","[{'payment_id': 1, 'payment_order_id': 1, 'payment_status': 'completed'}, {'payment_id': 7, 'payment_order_id': 7, 'payment_status': 'completed'}, {'payment_id': 15, 'payment_order_id': 15, 'payment_status': 'completed'}, {'payment_id': 16, 'payment_order_id': 16, 'payment_status': 'completed'}, {'payment_id': 25, 'payment_order_id': 25, 'payment_status': 'completed'}, {'payment_id': 26, 'payment_order_id': 26, 'payment_status': 'completed'}, {'payment_id': 28, 'payment_order_id': 28, 'payment_status': 'completed'}, {'payment_id': 34, 'payment_order_id': 34, 'payment_status': 'completed'}, {'payment_id': 39, 'payment_order_id': 39, 'payment_status': 'completed'}, {'payment_id': 40, 'payment_order_id': 40, 'payment_status': 'completed'}, {'payment_id': 42, 'payment_order_id': 42, 'payment_status': 'pending'}, {'payment_id': 44, 'payment_order_id': 44, 'payment_status': 'completed'}, {'payment_id': 49, 'payment_order_id': 49, 'payment_status': 'completed'}, {'payment_id': 53, 'payment_order_id': 53, 'payment_status': 'completed'}, {'payment_id': 57, 'payment_order_id': 57, 'payment_status': 'failed'}, {'payment_id': 63, 'payment_order_id': 63, 'payment_status': 'completed'}, {'payment_id': 67, 'payment_order_id': 67, 'payment_status': 'completed'}, {'payment_id': 70, 'payment_order_id': 70, 'payment_status': 'pending'}, {'payment_id': 83, 'payment_order_id': 83, 'payment_status': 'completed'}, {'payment_id': 84, 'payment_order_id': 84, 'payment_status': 'failed'}, {'payment_id': 97, 'payment_order_id': 97, 'payment_status': 'completed'}, {'payment_id': 107, 'payment_order_id': 107, 'payment_status': 'completed'}, {'payment_id': 112, 'payment_order_id': 112, 'payment_status': 'completed'}, {'payment_id': 116, 'payment_order_id': 116, 'payment_status': 'completed'}, {'payment_id': 120, 'payment_order_id': 120, 'payment_status': 'refunded'}, {'payment_id': 128, 'payment_order_id': 128, 'payment_status': 'completed'}, {'payment_id': 129, 'payment_order_id': 129, 'payment_status': 'completed'}, {'payment_id': 134, 'payment_order_id': 134, 'payment_status': 'completed'}, {'payment_id': 137, 'payment_order_id': 137, 'payment_status': 'completed'}, {'payment_id': 142, 'payment_order_id': 142, 'payment_status': 'completed'}, {'payment_id': 152, 'payment_order_id': 152, 'payment_status': 'completed'}, {'payment_id': 153, 'payment_order_id': 153, 'payment_status': 'pending'}, {'payment_id': 154, 'payment_order_id': 154, 'payment_status': 'completed'}, {'payment_id': 158, 'payment_order_id': 158, 'payment_status': 'completed'}, {'payment_id': 160, 'payment_order_id': 160, 'payment_status': 'completed'}, {'payment_id': 164, 'payment_order_id': 164, 'payment_status': 'failed'}, {'payment_id': 169, 'payment_order_id': 169, 'payment_status': 'completed'}, {'payment_id': 170, 'payment_order_id': 170, 'payment_status': 'failed'}, {'payment_id': 178, 'payment_order_id': 178, 'payment_status': 'completed'}, {'payment_id': 192, 'payment_order_id': 192, 'payment_status': 'completed'}, {'payment_id': 193, 'payment_order_id': 193, 'payment_status': 'completed'}, {'payment_id': 198, 'payment_order_id': 198, 'payment_status': 'completed'}, {'payment_id': 212, 'payment_order_id': 212, 'payment_status': 'completed'}, {'payment_id': 225, 'payment_order_id': 225, 'payment_status': 'completed'}, {'payment_id': 232, 'payment_order_id': 232, 'payment_status': 'completed'}, {'payment_id': 248, 'payment_order_id': 248, 'payment_status': 'pending'}, {'payment_id': 249, 'payment_order_id': 249, 'payment_status': 'completed'}, {'payment_id': 251, 'payment_order_id': 251, 'payment_status': 'completed'}, {'payment_id': 254, 'payment_order_id': 254, 'payment_status': 'completed'}, {'payment_id': 255, 'payment_order_id': 255, 'payment_status': 'completed'}, {'payment_id': 256, 'payment_order_id': 256, 'payment_status': 'completed'}, {'payment_id': 258, 'payment_order_id': 258, 'payment_status': 'completed'}, {'payment_id': 263, 'payment_order_id': 263, 'payment_status': 'refunded'}, {'payment_id': 274, 'payment_order_id': 274, 'payment_status': 'pending'}, {'payment_id': 281, 'payment_order_id': 281, 'payment_status': 'completed'}, {'payment_id': 282, 'payment_order_id': 282, 'payment_status': 'pending'}, {'payment_id': 287, 'payment_order_id': 287, 'payment_status': 'completed'}, {'payment_id': 299, 'payment_order_id': 299, 'payment_status': 'completed'}]",,MEDIUM
Which products have never received any review?,"SELECT p.product_id,
       p.product_name
FROM products AS p
LEFT JOIN reviews AS r
    ON r.review_product_id = p.product_id
WHERE r.review_id IS NULL;","[{'product_id': 151, 'product_name': 'Smart Bulb'}, {'product_id': 119, 'product_name': 'Fitness Tracker'}, {'product_id': 26, 'product_name': 'Sofa'}, {'product_id': 168, 'product_name': 'Wrench Set'}, {'product_id': 27, 'product_name': 'Chair'}, {'product_id': 135, 'product_name': 'Webcam'}, {'product_id': 160, 'product_name': 'Surge Protector'}, {'product_id': 12, 'product_name': 'Shirt'}, {'product_id': 98, 'product_name': 'Bookshelf'}, {'product_id': 167, 'product_name': 'Level'}, {'product_id': 64, 'product_name': 'Sauce'}, {'product_id': 198, 'product_name': 'Product 198'}, {'product_id': 163, 'product_name': 'Flashlight'}, {'product_id': 71, 'product_name': 'Stapler'}, {'product_id': 72, 'product_name': 'Filing Cabinet'}, {'product_id': 15, 'product_name': 'Shoes'}, {'product_id': 189, 'product_name': 'Product 189'}, {'product_id': 165, 'product_name': 'Multi-tool'}, {'product_id': 181, 'product_name': 'Screws'}, {'product_id': 65, 'product_name': 'Dog Food'}, {'product_id': 37, 'product_name': 'Football'}, {'product_id': 32, 'product_name': 'Plant'}, {'product_id': 172, 'product_name': 'Safety Glasses'}, {'product_id': 113, 'product_name': 'Loafers'}, {'product_id': 184, 'product_name': 'Product 184'}, {'product_id': 195, 'product_name': 'Product 195'}, {'product_id': 175, 'product_name': 'Ladder'}, {'product_id': 94, 'product_name': 'Coffee Maker'}, {'product_id': 126, 'product_name': 'Wrapping Paper'}, {'product_id': 81, 'product_name': 'Video Game'}, {'product_id': 134, 'product_name': 'Gaming Mouse'}, {'product_id': 29, 'product_name': 'Lamp'}, {'product_id': 141, 'product_name': 'Charging Dock'}, {'product_id': 138, 'product_name': 'Cable Organizer'}, {'product_id': 103, 'product_name': 'Stroller'}, {'product_id': 44, 'product_name': 'Action Figure'}, {'product_id': 70, 'product_name': 'Pen Set'}, {'product_id': 60, 'product_name': 'Coffee'}, {'product_id': 124, 'product_name': 'Balloons'}, {'product_id': 166, 'product_name': 'Tape Measure'}, {'product_id': 3, 'product_name': 'Tablet'}, {'product_id': 147, 'product_name': 'Mousepad'}, {'product_id': 121, 'product_name': 'Sculpture'}]",,MEDIUM
Which users placed more than 3 orders during 2023?,"SELECT u.user_id,
       u.user_name,
       COUNT(o.order_id) AS order_count
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
WHERE o.order_created_at >= '2023-01-01'
  AND o.order_created_at < '2024-01-01'
GROUP BY u.user_id, u.user_name
HAVING COUNT(o.order_id) > 3;",[],,HARD
Which categories contain products that have received at least one rating of 10?,"SELECT DISTINCT c.category_id,
       c.category_name
FROM categories AS c
JOIN category_products AS cp
    ON cp.category_product_category_id = c.category_id
JOIN reviews AS r
    ON r.review_product_id = cp.category_product_product_id
WHERE r.review_rating = 10;","[{'category_id': 9, 'category_name': 'Food'}, {'category_id': 5, 'category_name': 'Sports'}, {'category_id': 7, 'category_name': 'Beauty'}, {'category_id': 2, 'category_name': 'Clothing'}, {'category_id': 3, 'category_name': 'Books'}, {'category_id': 24, 'category_name': 'Watches'}, {'category_id': 13, 'category_name': 'Music'}, {'category_id': 22, 'category_name': 'Shoes'}, {'category_id': 14, 'category_name': 'Movies'}, {'category_id': 21, 'category_name': 'Jewelry'}, {'category_id': 4, 'category_name': 'Home & Garden'}, {'category_id': 17, 'category_name': 'Outdoor'}, {'category_id': 15, 'category_name': 'Games'}, {'category_id': 20, 'category_name': 'Baby'}, {'category_id': 29, 'category_name': 'Phones'}, {'category_id': 18, 'category_name': 'Kitchen'}, {'category_id': 28, 'category_name': 'Industrial'}, {'category_id': 25, 'category_name': 'Art'}, {'category_id': 19, 'category_name': 'Furniture'}, {'category_id': 6, 'category_name': 'Toys'}, {'category_id': 16, 'category_name': 'Tools'}, {'category_id': 10, 'category_name': 'Pet Supplies'}, {'category_id': 23, 'category_name': 'Bags'}, {'category_id': 27, 'category_name': 'Party Supplies'}, {'category_id': 1, 'category_name': 'Electronics'}, {'category_id': 26, 'category_name': 'Crafts'}, {'category_id': 30, 'category_name': 'Computers'}, {'category_id': 12, 'category_name': 'Health'}]",,MEDIUM
Which products appear in both carts and wishlists?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products AS p
JOIN cart_items AS ci
    ON ci.cart_item_product_id = p.product_id
JOIN wishlist_items AS wi
    ON wi.wishlist_item_product_id = p.product_id;","[{'product_id': 181, 'product_name': 'Screws'}, {'product_id': 120, 'product_name': 'Wall Art'}, {'product_id': 118, 'product_name': 'Smartwatch'}, {'product_id': 38, 'product_name': 'Tennis Racket'}, {'product_id': 19, 'product_name': 'Jeans'}, {'product_id': 166, 'product_name': 'Tape Measure'}, {'product_id': 176, 'product_name': 'Paint Roller'}, {'product_id': 78, 'product_name': 'Drum Set'}, {'product_id': 12, 'product_name': 'Shirt'}, {'product_id': 136, 'product_name': 'Router'}, {'product_id': 44, 'product_name': 'Action Figure'}, {'product_id': 161, 'product_name': 'Battery Pack'}, {'product_id': 42, 'product_name': 'Skateboard'}, {'product_id': 150, 'product_name': 'LED Strip'}, {'product_id': 111, 'product_name': 'Boots'}, {'product_id': 89, 'product_name': 'Sleeping Bag'}, {'product_id': 133, 'product_name': 'External Hard Drive'}, {'product_id': 184, 'product_name': 'Product 184'}, {'product_id': 6, 'product_name': 'Camera'}, {'product_id': 112, 'product_name': 'Sandals'}, {'product_id': 87, 'product_name': 'Screwdriver Set'}, {'product_id': 46, 'product_name': 'Board Game'}, {'product_id': 84, 'product_name': 'Drill'}, {'product_id': 64, 'product_name': 'Sauce'}, {'product_id': 35, 'product_name': 'Clock'}, {'product_id': 2, 'product_name': 'Phone'}, {'product_id': 48, 'product_name': 'LEGO Set'}, {'product_id': 51, 'product_name': 'Perfume'}, {'product_id': 22, 'product_name': 'Textbook'}, {'product_id': 95, 'product_name': 'Knife Set'}, {'product_id': 16, 'product_name': 'Hat'}, {'product_id': 34, 'product_name': 'Mirror'}, {'product_id': 172, 'product_name': 'Safety Glasses'}, {'product_id': 80, 'product_name': 'Blu-ray'}, {'product_id': 170, 'product_name': 'Toolbox'}, {'product_id': 96, 'product_name': 'Cookware'}, {'product_id': 57, 'product_name': 'Oil Filter'}, {'product_id': 108, 'product_name': 'Bracelet'}, {'product_id': 143, 'product_name': 'Graphics Card'}, {'product_id': 40, 'product_name': 'Dumbbell'}, {'product_id': 180, 'product_name': 'Nails'}, {'product_id': 21, 'product_name': 'Novel'}, {'product_id': 52, 'product_name': 'Shampoo'}, {'product_id': 126, 'product_name': 'Wrapping Paper'}, {'product_id': 63, 'product_name': 'Pasta'}, {'product_id': 125, 'product_name': 'Party Decorations'}, {'product_id': 199, 'product_name': 'Product 199'}, {'product_id': 174, 'product_name': 'Respirator'}, {'product_id': 33, 'product_name': 'Vase'}, {'product_id': 32, 'product_name': 'Plant'}, {'product_id': 91, 'product_name': 'Backpack'}, {'product_id': 23, 'product_name': 'Magazine'}, {'product_id': 68, 'product_name': 'Pet Bed'}, {'product_id': 1, 'product_name': 'Laptop'}, {'product_id': 160, 'product_name': 'Surge Protector'}, {'product_id': 20, 'product_name': 'Socks'}, {'product_id': 153, 'product_name': 'Doorbell'}, {'product_id': 124, 'product_name': 'Balloons'}, {'product_id': 110, 'product_name': 'Sneakers'}, {'product_id': 129, 'product_name': 'Smartphone'}, {'product_id': 122, 'product_name': 'Canvas'}, {'product_id': 134, 'product_name': 'Gaming Mouse'}, {'product_id': 53, 'product_name': 'Lotion'}, {'product_id': 168, 'product_name': 'Wrench Set'}, {'product_id': 169, 'product_name': 'Pliers'}, {'product_id': 3, 'product_name': 'Tablet'}, {'product_id': 193, 'product_name': 'Product 193'}, {'product_id': 90, 'product_name': 'Cooler'}, {'product_id': 50, 'product_name': 'Lipstick'}, {'product_id': 158, 'product_name': 'Heater'}, {'product_id': 45, 'product_name': 'Puzzle'}, {'product_id': 70, 'product_name': 'Pen Set'}, {'product_id': 144, 'product_name': 'RAM'}, {'product_id': 65, 'product_name': 'Dog Food'}]",,MEDIUM
Which vendors supply products that have been included in cancelled orders?,"SELECT DISTINCT v.vendor_id,
       v.vendor_name
FROM vendors AS v
JOIN product_vendors AS pv
    ON pv.product_vendor_vendor_id = v.vendor_id
JOIN order_items AS oi
    ON oi.order_item_product_id = pv.product_vendor_product_id
JOIN orders AS o
    ON o.order_id = oi.order_item_order_id
WHERE o.order_status = 'cancelled';","[{'vendor_id': 45, 'vendor_name': 'Vendor Industries 45'}, {'vendor_id': 36, 'vendor_name': 'Vendor Industries 36'}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39'}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19'}, {'vendor_id': 32, 'vendor_name': 'Vendor Industries 32'}, {'vendor_id': 5, 'vendor_name': 'Vendor Industries 5'}, {'vendor_id': 30, 'vendor_name': 'Vendor Supply Co 30'}, {'vendor_id': 20, 'vendor_name': 'Vendor Enterprises 20'}, {'vendor_id': 7, 'vendor_name': 'Vendor Corp 7'}, {'vendor_id': 25, 'vendor_name': 'Vendor Group 25'}, {'vendor_id': 23, 'vendor_name': 'Vendor Enterprises 23'}, {'vendor_id': 50, 'vendor_name': 'Vendor Supply Co 50'}, {'vendor_id': 33, 'vendor_name': 'Vendor LLC 33'}, {'vendor_id': 13, 'vendor_name': 'Vendor Corp 13'}, {'vendor_id': 34, 'vendor_name': 'Vendor Corp 34'}, {'vendor_id': 10, 'vendor_name': 'Vendor Group 10'}, {'vendor_id': 15, 'vendor_name': 'Vendor LLC 15'}, {'vendor_id': 2, 'vendor_name': 'Vendor Industries 2'}, {'vendor_id': 14, 'vendor_name': 'Vendor Corp 14'}, {'vendor_id': 12, 'vendor_name': 'Vendor Group 12'}, {'vendor_id': 8, 'vendor_name': 'Vendor LLC 8'}, {'vendor_id': 44, 'vendor_name': 'Vendor Group 44'}, {'vendor_id': 49, 'vendor_name': 'Vendor LLC 49'}, {'vendor_id': 1, 'vendor_name': 'Vendor Corp 1'}, {'vendor_id': 29, 'vendor_name': 'Vendor Corp 29'}, {'vendor_id': 48, 'vendor_name': 'Vendor Supply Co 48'}, {'vendor_id': 3, 'vendor_name': 'Vendor LLC 3'}, {'vendor_id': 47, 'vendor_name': 'Vendor Supply Co 47'}, {'vendor_id': 42, 'vendor_name': 'Vendor Supply Co 42'}, {'vendor_id': 31, 'vendor_name': 'Vendor Enterprises 31'}, {'vendor_id': 38, 'vendor_name': 'Vendor Corp 38'}, {'vendor_id': 17, 'vendor_name': 'Vendor Supply Co 17'}, {'vendor_id': 24, 'vendor_name': 'Vendor LLC 24'}, {'vendor_id': 40, 'vendor_name': 'Vendor Group 40'}]",,HARD
Which users have pending returns for orders they placed?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN returns AS r
    ON r.return_user_id = u.user_id
WHERE r.return_status = 'pending';","[{'user_id': 71, 'user_name': 'Kathleen Baker'}]",,MEDIUM
Which coupons were applied to orders that also included discounted products?,"SELECT DISTINCT c.coupon_id,
       c.coupon_code
FROM coupons AS c
JOIN order_coupons AS oc
    ON oc.order_coupon_coupon_id = c.coupon_id
JOIN orders AS o
    ON o.order_id = oc.order_coupon_order_id
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
JOIN product_discounts AS pd
    ON pd.product_discount_product_id = oi.order_item_product_id;","[{'coupon_id': 50, 'coupon_code': 'COUPON50SAVE'}, {'coupon_id': 2, 'coupon_code': 'COUPON2DEAL'}, {'coupon_id': 36, 'coupon_code': 'COUPON36DEAL'}, {'coupon_id': 10, 'coupon_code': 'COUPON10SAVE'}, {'coupon_id': 49, 'coupon_code': 'COUPON49SAVE'}, {'coupon_id': 40, 'coupon_code': 'COUPON40OFF'}, {'coupon_id': 1, 'coupon_code': 'COUPON1SALE'}, {'coupon_id': 6, 'coupon_code': 'COUPON6SAVE'}, {'coupon_id': 26, 'coupon_code': 'COUPON26SALE'}, {'coupon_id': 34, 'coupon_code': 'COUPON34OFF'}, {'coupon_id': 31, 'coupon_code': 'COUPON31DEAL'}, {'coupon_id': 14, 'coupon_code': 'COUPON14DEAL'}, {'coupon_id': 38, 'coupon_code': 'COUPON38SAVE'}, {'coupon_id': 22, 'coupon_code': 'COUPON22OFF'}, {'coupon_id': 41, 'coupon_code': 'COUPON41OFF'}, {'coupon_id': 43, 'coupon_code': 'COUPON43SALE'}, {'coupon_id': 19, 'coupon_code': 'COUPON19OFF'}, {'coupon_id': 33, 'coupon_code': 'COUPON33SALE'}, {'coupon_id': 21, 'coupon_code': 'COUPON21DEAL'}, {'coupon_id': 46, 'coupon_code': 'COUPON46SALE'}, {'coupon_id': 32, 'coupon_code': 'COUPON32SAVE'}, {'coupon_id': 25, 'coupon_code': 'COUPON25SAVE'}, {'coupon_id': 24, 'coupon_code': 'COUPON24OFF'}, {'coupon_id': 48, 'coupon_code': 'COUPON48SAVE'}, {'coupon_id': 29, 'coupon_code': 'COUPON29OFF'}, {'coupon_id': 9, 'coupon_code': 'COUPON9SAVE'}, {'coupon_id': 27, 'coupon_code': 'COUPON27SAVE'}, {'coupon_id': 15, 'coupon_code': 'COUPON15DEAL'}, {'coupon_id': 47, 'coupon_code': 'COUPON47SAVE'}, {'coupon_id': 23, 'coupon_code': 'COUPON23OFF'}, {'coupon_id': 42, 'coupon_code': 'COUPON42SALE'}, {'coupon_id': 37, 'coupon_code': 'COUPON37DEAL'}, {'coupon_id': 11, 'coupon_code': 'COUPON11DEAL'}, {'coupon_id': 4, 'coupon_code': 'COUPON4SALE'}]",,EXTRA
Which shipments were sent to addresses in California?,"SELECT s.shipment_id,
       s.shipment_order_id,
       s.shipment_status
FROM shipments AS s
JOIN addresses AS a
    ON a.address_id = s.shipment_address_id
WHERE a.address_state = 'California';","[{'shipment_id': 20, 'shipment_order_id': 20, 'shipment_status': 'preparing'}, {'shipment_id': 105, 'shipment_order_id': 105, 'shipment_status': 'in_transit'}, {'shipment_id': 109, 'shipment_order_id': 109, 'shipment_status': 'delivered'}, {'shipment_id': 141, 'shipment_order_id': 141, 'shipment_status': 'in_transit'}, {'shipment_id': 194, 'shipment_order_id': 194, 'shipment_status': 'in_transit'}, {'shipment_id': 214, 'shipment_order_id': 214, 'shipment_status': 'delivered'}, {'shipment_id': 216, 'shipment_order_id': 216, 'shipment_status': 'preparing'}, {'shipment_id': 230, 'shipment_order_id': 230, 'shipment_status': 'preparing'}, {'shipment_id': 231, 'shipment_order_id': 231, 'shipment_status': 'in_transit'}, {'shipment_id': 237, 'shipment_order_id': 237, 'shipment_status': 'in_transit'}, {'shipment_id': 253, 'shipment_order_id': 253, 'shipment_status': 'in_transit'}, {'shipment_id': 266, 'shipment_order_id': 266, 'shipment_status': 'delivered'}, {'shipment_id': 272, 'shipment_order_id': 272, 'shipment_status': 'in_transit'}]",,MEDIUM
Which users have completed payments for orders that include more than 5 items total?,"SELECT DISTINCT u.user_id,
       u.user_name
FROM users AS u
JOIN orders AS o
    ON o.order_user_id = u.user_id
JOIN payments AS p
    ON p.payment_order_id = o.order_id
JOIN order_items AS oi
    ON oi.order_item_order_id = o.order_id
GROUP BY u.user_id, u.user_name, o.order_id, p.payment_status
HAVING p.payment_status = 'completed'
   AND SUM(oi.order_item_quantity) > 5;","[{'user_id': 40, 'user_name': 'Sandra Garcia'}, {'user_id': 48, 'user_name': 'Elizabeth Richardson'}, {'user_id': 44, 'user_name': 'Lisa Robinson'}, {'user_id': 53, 'user_name': 'Stephanie Anderson'}, {'user_id': 69, 'user_name': 'Gary Kim'}, {'user_id': 66, 'user_name': 'Timothy Wood'}, {'user_id': 24, 'user_name': 'Emily James'}, {'user_id': 60, 'user_name': 'Thomas Kelly'}, {'user_id': 38, 'user_name': 'Rebecca Lopez'}, {'user_id': 68, 'user_name': 'Larry Stewart'}, {'user_id': 20, 'user_name': 'Carolyn Torres'}, {'user_id': 79, 'user_name': 'Mark Evans'}, {'user_id': 6, 'user_name': 'Heather Murphy'}, {'user_id': 3, 'user_name': 'Ashley Green'}, {'user_id': 77, 'user_name': 'Christine James'}, {'user_id': 62, 'user_name': 'Kathleen Wright'}, {'user_id': 42, 'user_name': 'Emma Allen'}, {'user_id': 86, 'user_name': 'Brenda King'}, {'user_id': 73, 'user_name': 'Richard Reed'}, {'user_id': 21, 'user_name': 'Richard Scott'}, {'user_id': 26, 'user_name': 'Nicole Anderson'}, {'user_id': 33, 'user_name': 'Jonathan Chavez'}, {'user_id': 17, 'user_name': 'Dennis Kelly'}, {'user_id': 76, 'user_name': 'Emma Howard'}, {'user_id': 22, 'user_name': 'Frank Martin'}, {'user_id': 50, 'user_name': 'Stephanie Lopez'}, {'user_id': 30, 'user_name': 'Amanda Morales'}, {'user_id': 57, 'user_name': 'Mark Sanchez'}, {'user_id': 64, 'user_name': 'Samuel Peterson'}, {'user_id': 81, 'user_name': 'Jennifer Morales'}, {'user_id': 19, 'user_name': 'Andrew Torres'}, {'user_id': 34, 'user_name': 'Timothy Murphy'}, {'user_id': 70, 'user_name': 'Scott Brooks'}, {'user_id': 12, 'user_name': 'Sharon Carter'}, {'user_id': 67, 'user_name': 'Sandra Harris'}, {'user_id': 89, 'user_name': 'Rebecca Moore'}, {'user_id': 61, 'user_name': 'Michael Bailey'}, {'user_id': 8, 'user_name': 'Anthony Foster'}, {'user_id': 54, 'user_name': 'Scott Howard'}, {'user_id': 47, 'user_name': 'Margaret Clark'}, {'user_id': 71, 'user_name': 'Kathleen Baker'}, {'user_id': 65, 'user_name': 'Ronald Ross'}, {'user_id': 59, 'user_name': 'Amanda Martin'}, {'user_id': 41, 'user_name': 'Donald Hughes'}, {'user_id': 13, 'user_name': 'Melissa Nelson'}, {'user_id': 43, 'user_name': 'Donna White'}, {'user_id': 83, 'user_name': 'Sarah Foster'}, {'user_id': 84, 'user_name': 'Dorothy Richardson'}, {'user_id': 72, 'user_name': 'Michelle Nelson'}, {'user_id': 37, 'user_name': 'Lisa Kim'}, {'user_id': 55, 'user_name': 'Christine Hughes'}, {'user_id': 15, 'user_name': 'Lisa Lopez'}, {'user_id': 45, 'user_name': 'Brian Martinez'}, {'user_id': 51, 'user_name': 'Barbara Gonzalez'}, {'user_id': 85, 'user_name': 'Dennis Kim'}, {'user_id': 36, 'user_name': 'Michael Cooper'}, {'user_id': 88, 'user_name': 'Emily Sanders'}, {'user_id': 18, 'user_name': 'Karen Hernandez'}, {'user_id': 16, 'user_name': 'Raymond Ruiz'}, {'user_id': 14, 'user_name': 'Joseph Sanders'}, {'user_id': 46, 'user_name': 'Brenda Diaz'}, {'user_id': 27, 'user_name': 'Justin Morgan'}, {'user_id': 82, 'user_name': 'Edward Diaz'}, {'user_id': 9, 'user_name': 'Andrew Reyes'}, {'user_id': 35, 'user_name': 'Carolyn Adams'}, {'user_id': 29, 'user_name': 'Jeffrey Davis'}]",,EXTRA
"Which products have the largest increase in average review rating between the first half of 2023 and the second half of 2023?
(Only include products reviewed in both periods.)","WITH ratings AS (
    SELECT
        r.review_product_id,
        CASE 
            WHEN r.review_created_at < '2023-07-01' THEN 'H1'
            ELSE 'H2'
        END AS half_year,
        AVG(r.review_rating) AS avg_rating
    FROM reviews AS r
    WHERE r.review_created_at >= '2023-01-01'
      AND r.review_created_at < '2024-01-01'
    GROUP BY r.review_product_id, half_year
),
pivot AS (
    SELECT
        r1.review_product_id,
        r1.avg_rating AS h1_rating,
        r2.avg_rating AS h2_rating,
        (r2.avg_rating - r1.avg_rating) AS diff
    FROM ratings r1
    JOIN ratings r2
        ON r1.review_product_id = r2.review_product_id
       AND r1.half_year = 'H1'
       AND r2.half_year = 'H2'
)
SELECT p.product_id, p.product_name, diff
FROM pivot
JOIN products p ON p.product_id = pivot.review_product_id
ORDER BY diff DESC;",[],,EXTRA
"For each user, find the highest-priced product they ever purchased, using DISTINCT ON and window ordering.","SELECT DISTINCT ON (u.user_id)
    u.user_id,
    u.user_name,
    p.product_id,
    p.product_name,
    oi.order_item_price
FROM users u
JOIN orders o ON o.order_user_id = u.user_id
JOIN order_items oi ON oi.order_item_order_id = o.order_id
JOIN products p ON p.product_id = oi.order_item_product_id
ORDER BY u.user_id, oi.order_item_price DESC;","[{'user_id': 1, 'user_name': 'Andrew Thomas', 'product_id': 5, 'product_name': 'Speaker', 'order_item_price': Decimal('411.50')}, {'user_id': 2, 'user_name': 'Joseph Gutierrez', 'product_id': 79, 'product_name': 'DVD', 'order_item_price': Decimal('23.96')}, {'user_id': 3, 'user_name': 'Ashley Green', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 4, 'user_name': 'Kenneth Castillo', 'product_id': 135, 'product_name': 'Webcam', 'order_item_price': Decimal('507.33')}, {'user_id': 5, 'user_name': 'Pamela Patel', 'product_id': 100, 'product_name': 'Dresser', 'order_item_price': Decimal('189.25')}, {'user_id': 6, 'user_name': 'Heather Murphy', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 7, 'user_name': 'Elizabeth Bailey', 'product_id': 40, 'product_name': 'Dumbbell', 'order_item_price': Decimal('430.18')}, {'user_id': 8, 'user_name': 'Anthony Foster', 'product_id': 46, 'product_name': 'Board Game', 'order_item_price': Decimal('384.06')}, {'user_id': 9, 'user_name': 'Andrew Reyes', 'product_id': 76, 'product_name': 'Guitar', 'order_item_price': Decimal('380.75')}, {'user_id': 10, 'user_name': 'Jeffrey Torres', 'product_id': 186, 'product_name': 'Product 186', 'order_item_price': Decimal('396.49')}, {'user_id': 11, 'user_name': 'William Green', 'product_id': 88, 'product_name': 'Tent', 'order_item_price': Decimal('474.28')}, {'user_id': 12, 'user_name': 'Sharon Carter', 'product_id': 31, 'product_name': 'Curtains', 'order_item_price': Decimal('458.21')}, {'user_id': 13, 'user_name': 'Melissa Nelson', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 14, 'user_name': 'Joseph Sanders', 'product_id': 99, 'product_name': 'Bed Frame', 'order_item_price': Decimal('472.46')}, {'user_id': 15, 'user_name': 'Lisa Lopez', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 16, 'user_name': 'Raymond Ruiz', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 17, 'user_name': 'Dennis Kelly', 'product_id': 171, 'product_name': 'Work Gloves', 'order_item_price': Decimal('325.48')}, {'user_id': 18, 'user_name': 'Karen Hernandez', 'product_id': 1, 'product_name': 'Laptop', 'order_item_price': Decimal('245.71')}, {'user_id': 19, 'user_name': 'Andrew Torres', 'product_id': 66, 'product_name': 'Cat Toy', 'order_item_price': Decimal('461.43')}, {'user_id': 20, 'user_name': 'Carolyn Torres', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 21, 'user_name': 'Richard Scott', 'product_id': 170, 'product_name': 'Toolbox', 'order_item_price': Decimal('478.33')}, {'user_id': 22, 'user_name': 'Frank Martin', 'product_id': 69, 'product_name': 'Notebook', 'order_item_price': Decimal('485.00')}, {'user_id': 23, 'user_name': 'Matthew Brown', 'product_id': 136, 'product_name': 'Router', 'order_item_price': Decimal('364.87')}, {'user_id': 24, 'user_name': 'Emily James', 'product_id': 39, 'product_name': 'Yoga Mat', 'order_item_price': Decimal('416.09')}, {'user_id': 25, 'user_name': 'Emily Robinson', 'product_id': 117, 'product_name': 'Suitcase', 'order_item_price': Decimal('421.18')}, {'user_id': 26, 'user_name': 'Nicole Anderson', 'product_id': 183, 'product_name': 'Hinges', 'order_item_price': Decimal('484.41')}, {'user_id': 27, 'user_name': 'Justin Morgan', 'product_id': 156, 'product_name': 'Humidifier', 'order_item_price': Decimal('275.74')}, {'user_id': 28, 'user_name': 'Anna Thompson', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 29, 'user_name': 'Jeffrey Davis', 'product_id': 48, 'product_name': 'LEGO Set', 'order_item_price': Decimal('487.53')}, {'user_id': 30, 'user_name': 'Amanda Morales', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 32, 'user_name': 'Jennifer Thompson', 'product_id': 120, 'product_name': 'Wall Art', 'order_item_price': Decimal('343.25')}, {'user_id': 33, 'user_name': 'Jonathan Chavez', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 34, 'user_name': 'Timothy Murphy', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 35, 'user_name': 'Carolyn Adams', 'product_id': 69, 'product_name': 'Notebook', 'order_item_price': Decimal('485.00')}, {'user_id': 36, 'user_name': 'Michael Cooper', 'product_id': 21, 'product_name': 'Novel', 'order_item_price': Decimal('346.38')}, {'user_id': 37, 'user_name': 'Lisa Kim', 'product_id': 135, 'product_name': 'Webcam', 'order_item_price': Decimal('507.33')}, {'user_id': 38, 'user_name': 'Rebecca Lopez', 'product_id': 159, 'product_name': 'Extension Cord', 'order_item_price': Decimal('483.89')}, {'user_id': 39, 'user_name': 'Emma Hernandez', 'product_id': 176, 'product_name': 'Paint Roller', 'order_item_price': Decimal('467.61')}, {'user_id': 40, 'user_name': 'Sandra Garcia', 'product_id': 23, 'product_name': 'Magazine', 'order_item_price': Decimal('471.65')}, {'user_id': 41, 'user_name': 'Donald Hughes', 'product_id': 48, 'product_name': 'LEGO Set', 'order_item_price': Decimal('487.53')}, {'user_id': 42, 'user_name': 'Emma Allen', 'product_id': 69, 'product_name': 'Notebook', 'order_item_price': Decimal('485.00')}, {'user_id': 43, 'user_name': 'Donna White', 'product_id': 182, 'product_name': 'Anchors', 'order_item_price': Decimal('240.18')}, {'user_id': 44, 'user_name': 'Lisa Robinson', 'product_id': 170, 'product_name': 'Toolbox', 'order_item_price': Decimal('478.33')}, {'user_id': 45, 'user_name': 'Brian Martinez', 'product_id': 62, 'product_name': 'Snacks', 'order_item_price': Decimal('352.35')}, {'user_id': 46, 'user_name': 'Brenda Diaz', 'product_id': 165, 'product_name': 'Multi-tool', 'order_item_price': Decimal('506.66')}, {'user_id': 47, 'user_name': 'Margaret Clark', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 48, 'user_name': 'Elizabeth Richardson', 'product_id': 94, 'product_name': 'Coffee Maker', 'order_item_price': Decimal('360.94')}, {'user_id': 49, 'user_name': 'Jason Hill', 'product_id': 34, 'product_name': 'Mirror', 'order_item_price': Decimal('395.97')}, {'user_id': 50, 'user_name': 'Stephanie Lopez', 'product_id': 5, 'product_name': 'Speaker', 'order_item_price': Decimal('411.50')}, {'user_id': 51, 'user_name': 'Barbara Gonzalez', 'product_id': 176, 'product_name': 'Paint Roller', 'order_item_price': Decimal('467.61')}, {'user_id': 52, 'user_name': 'David Young', 'product_id': 31, 'product_name': 'Curtains', 'order_item_price': Decimal('458.21')}, {'user_id': 53, 'user_name': 'Stephanie Anderson', 'product_id': 20, 'product_name': 'Socks', 'order_item_price': Decimal('261.56')}, {'user_id': 54, 'user_name': 'Scott Howard', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 55, 'user_name': 'Christine Hughes', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 56, 'user_name': 'Jacob Brown', 'product_id': 76, 'product_name': 'Guitar', 'order_item_price': Decimal('380.75')}, {'user_id': 57, 'user_name': 'Mark Sanchez', 'product_id': 186, 'product_name': 'Product 186', 'order_item_price': Decimal('396.49')}, {'user_id': 59, 'user_name': 'Amanda Martin', 'product_id': 14, 'product_name': 'Jacket', 'order_item_price': Decimal('284.91')}, {'user_id': 60, 'user_name': 'Thomas Kelly', 'product_id': 159, 'product_name': 'Extension Cord', 'order_item_price': Decimal('483.89')}, {'user_id': 61, 'user_name': 'Michael Bailey', 'product_id': 88, 'product_name': 'Tent', 'order_item_price': Decimal('474.28')}, {'user_id': 62, 'user_name': 'Kathleen Wright', 'product_id': 170, 'product_name': 'Toolbox', 'order_item_price': Decimal('478.33')}, {'user_id': 63, 'user_name': 'Jeffrey Davis', 'product_id': 113, 'product_name': 'Loafers', 'order_item_price': Decimal('461.83')}, {'user_id': 64, 'user_name': 'Samuel Peterson', 'product_id': 169, 'product_name': 'Pliers', 'order_item_price': Decimal('508.52')}, {'user_id': 65, 'user_name': 'Ronald Ross', 'product_id': 183, 'product_name': 'Hinges', 'order_item_price': Decimal('484.41')}, {'user_id': 66, 'user_name': 'Timothy Wood', 'product_id': 78, 'product_name': 'Drum Set', 'order_item_price': Decimal('495.80')}, {'user_id': 67, 'user_name': 'Sandra Harris', 'product_id': 56, 'product_name': 'Car Battery', 'order_item_price': Decimal('398.15')}, {'user_id': 68, 'user_name': 'Larry Stewart', 'product_id': 183, 'product_name': 'Hinges', 'order_item_price': Decimal('484.41')}, {'user_id': 69, 'user_name': 'Gary Kim', 'product_id': 113, 'product_name': 'Loafers', 'order_item_price': Decimal('461.83')}, {'user_id': 70, 'user_name': 'Scott Brooks', 'product_id': 39, 'product_name': 'Yoga Mat', 'order_item_price': Decimal('416.09')}, {'user_id': 71, 'user_name': 'Kathleen Baker', 'product_id': 58, 'product_name': 'Tire', 'order_item_price': Decimal('471.01')}, {'user_id': 72, 'user_name': 'Michelle Nelson', 'product_id': 93, 'product_name': 'Toaster', 'order_item_price': Decimal('412.74')}, {'user_id': 73, 'user_name': 'Richard Reed', 'product_id': 78, 'product_name': 'Drum Set', 'order_item_price': Decimal('495.80')}, {'user_id': 74, 'user_name': 'Scott Ortiz', 'product_id': 139, 'product_name': 'Screen Protector', 'order_item_price': Decimal('157.30')}, {'user_id': 75, 'user_name': 'Joseph Allen', 'product_id': 116, 'product_name': 'Wallet', 'order_item_price': Decimal('254.17')}, {'user_id': 76, 'user_name': 'Emma Howard', 'product_id': 142, 'product_name': 'Bluetooth Adapter', 'order_item_price': Decimal('273.96')}, {'user_id': 77, 'user_name': 'Christine James', 'product_id': 34, 'product_name': 'Mirror', 'order_item_price': Decimal('395.97')}, {'user_id': 78, 'user_name': 'William Reed', 'product_id': 23, 'product_name': 'Magazine', 'order_item_price': Decimal('471.65')}, {'user_id': 79, 'user_name': 'Mark Evans', 'product_id': 135, 'product_name': 'Webcam', 'order_item_price': Decimal('507.33')}, {'user_id': 80, 'user_name': 'Angela Collins', 'product_id': 188, 'product_name': 'Product 188', 'order_item_price': Decimal('315.93')}, {'user_id': 81, 'user_name': 'Jennifer Morales', 'product_id': 33, 'product_name': 'Vase', 'order_item_price': Decimal('493.99')}, {'user_id': 82, 'user_name': 'Edward Diaz', 'product_id': 99, 'product_name': 'Bed Frame', 'order_item_price': Decimal('472.46')}, {'user_id': 83, 'user_name': 'Sarah Foster', 'product_id': 48, 'product_name': 'LEGO Set', 'order_item_price': Decimal('487.53')}, {'user_id': 84, 'user_name': 'Dorothy Richardson', 'product_id': 90, 'product_name': 'Cooler', 'order_item_price': Decimal('295.79')}, {'user_id': 85, 'user_name': 'Dennis Kim', 'product_id': 40, 'product_name': 'Dumbbell', 'order_item_price': Decimal('430.18')}, {'user_id': 86, 'user_name': 'Brenda King', 'product_id': 93, 'product_name': 'Toaster', 'order_item_price': Decimal('412.74')}, {'user_id': 88, 'user_name': 'Emily Sanders', 'product_id': 31, 'product_name': 'Curtains', 'order_item_price': Decimal('458.21')}, {'user_id': 89, 'user_name': 'Rebecca Moore', 'product_id': 88, 'product_name': 'Tent', 'order_item_price': Decimal('474.28')}]",,HARD
"Find the top 5 vendors whose supplied products generated the highest total ordered revenue, including quantity  price calculations, using window functions.","WITH vendor_revenue AS (
    SELECT
        v.vendor_id,
        v.vendor_name,
        SUM(oi.order_item_quantity * oi.order_item_price) AS total_revenue
    FROM vendors v
    JOIN product_vendors pv ON pv.product_vendor_vendor_id = v.vendor_id
    JOIN order_items oi ON oi.order_item_product_id = pv.product_vendor_product_id
    GROUP BY v.vendor_id, v.vendor_name
)
SELECT *
FROM vendor_revenue
ORDER BY total_revenue DESC
LIMIT 5;","[{'vendor_id': 12, 'vendor_name': 'Vendor Group 12', 'total_revenue': Decimal('23002.34')}, {'vendor_id': 19, 'vendor_name': 'Vendor Group 19', 'total_revenue': Decimal('21435.73')}, {'vendor_id': 45, 'vendor_name': 'Vendor Industries 45', 'total_revenue': Decimal('20162.50')}, {'vendor_id': 15, 'vendor_name': 'Vendor LLC 15', 'total_revenue': Decimal('18993.97')}, {'vendor_id': 39, 'vendor_name': 'Vendor Group 39', 'total_revenue': Decimal('18755.68')}]",,HARD
"Find the average product price per category, but only include categories where at least one product has been ordered more than 50 times in total.","WITH order_totals AS (
    SELECT 
        oi.order_item_product_id AS product_id,
        SUM(oi.order_item_quantity) AS total_qty
    FROM order_items oi
    GROUP BY oi.order_item_product_id
),
qualified_categories AS (
    SELECT DISTINCT cp.category_product_category_id AS category_id
    FROM category_products cp
    JOIN order_totals ot ON ot.product_id = cp.category_product_product_id
    WHERE ot.total_qty > 50
)
SELECT 
    c.category_id,
    c.category_name,
    AVG(p.product_price) AS avg_price
FROM qualified_categories qc
JOIN categories c ON c.category_id = qc.category_id
JOIN category_products cp ON cp.category_product_category_id = c.category_id
JOIN products p ON p.product_id = cp.category_product_product_id
GROUP BY c.category_id, c.category_name;",[],,HARD
"Which users have made at least one completed payment and also have a pending return, using correlated subqueries?","SELECT u.user_id, u.user_name
FROM users u
WHERE EXISTS (
    SELECT 1
    FROM orders o
    JOIN payments p ON p.payment_order_id = o.order_id
    WHERE o.order_user_id = u.user_id
      AND p.payment_status = 'completed'
)
AND EXISTS (
    SELECT 1
    FROM returns r
    WHERE r.return_user_id = u.user_id
      AND r.return_status = 'pending'
);","[{'user_id': 71, 'user_name': 'Kathleen Baker'}]",,EXTRA
"Find products ordered by users who also reviewed those same products, and compute the correlation between order quantity and review rating per product. (Uses corr() aggregate.)","SELECT
    p.product_id,
    p.product_name,
    corr(oi.order_item_quantity, r.review_rating) AS quantity_rating_corr
FROM products p
JOIN order_items oi ON oi.order_item_product_id = p.product_id
JOIN orders o ON o.order_id = oi.order_item_order_id
JOIN reviews r 
    ON r.review_product_id = p.product_id
   AND r.review_user_id = o.order_user_id
GROUP BY p.product_id, p.product_name;","[{'product_id': 1, 'product_name': 'Laptop', 'quantity_rating_corr': -0.37341524325392694}, {'product_id': 2, 'product_name': 'Phone', 'quantity_rating_corr': None}, {'product_id': 4, 'product_name': 'Headphones', 'quantity_rating_corr': -0.8660254037844387}, {'product_id': 5, 'product_name': 'Speaker', 'quantity_rating_corr': -0.7559289460184545}, {'product_id': 6, 'product_name': 'Camera', 'quantity_rating_corr': -0.3973597071195132}, {'product_id': 7, 'product_name': 'Watch', 'quantity_rating_corr': None}, {'product_id': 8, 'product_name': 'TV', 'quantity_rating_corr': None}, {'product_id': 9, 'product_name': 'Monitor', 'quantity_rating_corr': -1.0}, {'product_id': 10, 'product_name': 'Keyboard', 'quantity_rating_corr': 0.970725343394151}, {'product_id': 11, 'product_name': 'Mouse', 'quantity_rating_corr': -0.09759000729485333}, {'product_id': 13, 'product_name': 'Pants', 'quantity_rating_corr': None}, {'product_id': 14, 'product_name': 'Jacket', 'quantity_rating_corr': -0.11470786693528087}, {'product_id': 16, 'product_name': 'Hat', 'quantity_rating_corr': None}, {'product_id': 17, 'product_name': 'Dress', 'quantity_rating_corr': None}, {'product_id': 18, 'product_name': 'Sweater', 'quantity_rating_corr': -1.0}, {'product_id': 19, 'product_name': 'Jeans', 'quantity_rating_corr': None}, {'product_id': 20, 'product_name': 'Socks', 'quantity_rating_corr': -1.0}, {'product_id': 21, 'product_name': 'Novel', 'quantity_rating_corr': None}, {'product_id': 22, 'product_name': 'Textbook', 'quantity_rating_corr': -0.41695392396839687}, {'product_id': 23, 'product_name': 'Magazine', 'quantity_rating_corr': None}, {'product_id': 24, 'product_name': 'Comic', 'quantity_rating_corr': None}, {'product_id': 25, 'product_name': 'Journal', 'quantity_rating_corr': None}, {'product_id': 28, 'product_name': 'Table', 'quantity_rating_corr': None}, {'product_id': 30, 'product_name': 'Rug', 'quantity_rating_corr': None}, {'product_id': 31, 'product_name': 'Curtains', 'quantity_rating_corr': -0.8574929257125441}, {'product_id': 33, 'product_name': 'Vase', 'quantity_rating_corr': None}, {'product_id': 34, 'product_name': 'Mirror', 'quantity_rating_corr': -0.8660254037844387}, {'product_id': 35, 'product_name': 'Clock', 'quantity_rating_corr': -0.29277002188455997}, {'product_id': 36, 'product_name': 'Basketball', 'quantity_rating_corr': None}, {'product_id': 38, 'product_name': 'Tennis Racket', 'quantity_rating_corr': None}, {'product_id': 39, 'product_name': 'Yoga Mat', 'quantity_rating_corr': -1.0}, {'product_id': 40, 'product_name': 'Dumbbell', 'quantity_rating_corr': 0.6246950475544243}, {'product_id': 41, 'product_name': 'Bike', 'quantity_rating_corr': 1.0}, {'product_id': 42, 'product_name': 'Skateboard', 'quantity_rating_corr': None}, {'product_id': 43, 'product_name': 'Helmet', 'quantity_rating_corr': None}, {'product_id': 45, 'product_name': 'Puzzle', 'quantity_rating_corr': None}, {'product_id': 46, 'product_name': 'Board Game', 'quantity_rating_corr': -1.0}, {'product_id': 47, 'product_name': 'Doll', 'quantity_rating_corr': 0.9176629354822472}, {'product_id': 48, 'product_name': 'LEGO Set', 'quantity_rating_corr': 0.4082482904638631}, {'product_id': 49, 'product_name': 'RC Car', 'quantity_rating_corr': None}, {'product_id': 50, 'product_name': 'Lipstick', 'quantity_rating_corr': 0.32732683535398854}, {'product_id': 51, 'product_name': 'Perfume', 'quantity_rating_corr': None}, {'product_id': 52, 'product_name': 'Shampoo', 'quantity_rating_corr': None}, {'product_id': 53, 'product_name': 'Lotion', 'quantity_rating_corr': None}, {'product_id': 54, 'product_name': 'Makeup Kit', 'quantity_rating_corr': None}, {'product_id': 55, 'product_name': 'Hair Dryer', 'quantity_rating_corr': None}, {'product_id': 56, 'product_name': 'Car Battery', 'quantity_rating_corr': -0.9045340337332909}, {'product_id': 57, 'product_name': 'Oil Filter', 'quantity_rating_corr': 1.0}, {'product_id': 58, 'product_name': 'Tire', 'quantity_rating_corr': None}, {'product_id': 59, 'product_name': 'Wiper Blades', 'quantity_rating_corr': None}, {'product_id': 61, 'product_name': 'Tea', 'quantity_rating_corr': 0.5960395606792698}, {'product_id': 62, 'product_name': 'Snacks', 'quantity_rating_corr': None}, {'product_id': 63, 'product_name': 'Pasta', 'quantity_rating_corr': -1.0}, {'product_id': 66, 'product_name': 'Cat Toy', 'quantity_rating_corr': 1.0}, {'product_id': 67, 'product_name': 'Leash', 'quantity_rating_corr': 1.0}, {'product_id': 68, 'product_name': 'Pet Bed', 'quantity_rating_corr': -1.0}, {'product_id': 69, 'product_name': 'Notebook', 'quantity_rating_corr': None}, {'product_id': 73, 'product_name': 'Vitamins', 'quantity_rating_corr': -1.0}, {'product_id': 74, 'product_name': 'First Aid Kit', 'quantity_rating_corr': None}, {'product_id': 75, 'product_name': 'Thermometer', 'quantity_rating_corr': None}, {'product_id': 76, 'product_name': 'Guitar', 'quantity_rating_corr': 0.45454545454545453}, {'product_id': 77, 'product_name': 'Microphone', 'quantity_rating_corr': None}, {'product_id': 78, 'product_name': 'Drum Set', 'quantity_rating_corr': None}, {'product_id': 79, 'product_name': 'DVD', 'quantity_rating_corr': -1.0}, {'product_id': 80, 'product_name': 'Blu-ray', 'quantity_rating_corr': 1.0}, {'product_id': 82, 'product_name': 'Console', 'quantity_rating_corr': None}, {'product_id': 83, 'product_name': 'Controller', 'quantity_rating_corr': 1.0}, {'product_id': 84, 'product_name': 'Drill', 'quantity_rating_corr': 1.0}, {'product_id': 85, 'product_name': 'Hammer', 'quantity_rating_corr': None}, {'product_id': 86, 'product_name': 'Saw', 'quantity_rating_corr': -1.0}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'quantity_rating_corr': None}, {'product_id': 88, 'product_name': 'Tent', 'quantity_rating_corr': -1.0}, {'product_id': 89, 'product_name': 'Sleeping Bag', 'quantity_rating_corr': None}, {'product_id': 90, 'product_name': 'Cooler', 'quantity_rating_corr': None}, {'product_id': 91, 'product_name': 'Backpack', 'quantity_rating_corr': None}, {'product_id': 92, 'product_name': 'Blender', 'quantity_rating_corr': None}, {'product_id': 93, 'product_name': 'Toaster', 'quantity_rating_corr': None}, {'product_id': 95, 'product_name': 'Knife Set', 'quantity_rating_corr': -0.7559289460184545}, {'product_id': 96, 'product_name': 'Cookware', 'quantity_rating_corr': -1.0}, {'product_id': 97, 'product_name': 'Desk', 'quantity_rating_corr': -0.3939393939393939}, {'product_id': 99, 'product_name': 'Bed Frame', 'quantity_rating_corr': -1.0}, {'product_id': 100, 'product_name': 'Dresser', 'quantity_rating_corr': 0.8660254037844387}, {'product_id': 101, 'product_name': 'Nightstand', 'quantity_rating_corr': 0.0}, {'product_id': 102, 'product_name': 'Crib', 'quantity_rating_corr': None}, {'product_id': 104, 'product_name': 'Car Seat', 'quantity_rating_corr': 0.0}, {'product_id': 105, 'product_name': 'Baby Monitor', 'quantity_rating_corr': None}, {'product_id': 106, 'product_name': 'Necklace', 'quantity_rating_corr': None}, {'product_id': 107, 'product_name': 'Ring', 'quantity_rating_corr': 0.1889822365046136}, {'product_id': 108, 'product_name': 'Bracelet', 'quantity_rating_corr': None}, {'product_id': 109, 'product_name': 'Earrings', 'quantity_rating_corr': None}, {'product_id': 110, 'product_name': 'Sneakers', 'quantity_rating_corr': -1.0}, {'product_id': 111, 'product_name': 'Boots', 'quantity_rating_corr': None}, {'product_id': 112, 'product_name': 'Sandals', 'quantity_rating_corr': None}, {'product_id': 114, 'product_name': 'Handbag', 'quantity_rating_corr': None}, {'product_id': 115, 'product_name': 'Backpack', 'quantity_rating_corr': -0.32732683535398854}, {'product_id': 116, 'product_name': 'Wallet', 'quantity_rating_corr': 0.40625}, {'product_id': 117, 'product_name': 'Suitcase', 'quantity_rating_corr': 0.0}, {'product_id': 118, 'product_name': 'Smartwatch', 'quantity_rating_corr': -1.1331166295920988e-17}, {'product_id': 120, 'product_name': 'Wall Art', 'quantity_rating_corr': 0.6933752452815365}, {'product_id': 122, 'product_name': 'Canvas', 'quantity_rating_corr': None}, {'product_id': 123, 'product_name': 'Paint Set', 'quantity_rating_corr': 1.0}, {'product_id': 125, 'product_name': 'Party Decorations', 'quantity_rating_corr': None}, {'product_id': 127, 'product_name': 'Warehouse Shelving', 'quantity_rating_corr': None}, {'product_id': 128, 'product_name': 'Safety Vest', 'quantity_rating_corr': -0.09090909090909093}, {'product_id': 129, 'product_name': 'Smartphone', 'quantity_rating_corr': None}, {'product_id': 130, 'product_name': 'Laptop Stand', 'quantity_rating_corr': None}, {'product_id': 131, 'product_name': 'USB Cable', 'quantity_rating_corr': None}, {'product_id': 132, 'product_name': 'Power Bank', 'quantity_rating_corr': None}, {'product_id': 133, 'product_name': 'External Hard Drive', 'quantity_rating_corr': None}, {'product_id': 136, 'product_name': 'Router', 'quantity_rating_corr': None}, {'product_id': 137, 'product_name': 'Switch', 'quantity_rating_corr': -0.3333333333333333}, {'product_id': 139, 'product_name': 'Screen Protector', 'quantity_rating_corr': 0.4490887131390718}, {'product_id': 140, 'product_name': 'Phone Case', 'quantity_rating_corr': None}, {'product_id': 142, 'product_name': 'Bluetooth Adapter', 'quantity_rating_corr': -1.0}, {'product_id': 143, 'product_name': 'Graphics Card', 'quantity_rating_corr': None}, {'product_id': 144, 'product_name': 'RAM', 'quantity_rating_corr': None}, {'product_id': 145, 'product_name': 'SSD', 'quantity_rating_corr': None}, {'product_id': 146, 'product_name': 'Cooling Fan', 'quantity_rating_corr': None}, {'product_id': 148, 'product_name': 'Desk Mat', 'quantity_rating_corr': 1.0}, {'product_id': 149, 'product_name': 'Monitor Arm', 'quantity_rating_corr': 0.5}, {'product_id': 150, 'product_name': 'LED Strip', 'quantity_rating_corr': None}, {'product_id': 152, 'product_name': 'Security Camera', 'quantity_rating_corr': -1.0}, {'product_id': 153, 'product_name': 'Doorbell', 'quantity_rating_corr': None}, {'product_id': 154, 'product_name': 'Thermostat', 'quantity_rating_corr': None}, {'product_id': 155, 'product_name': 'Air Purifier', 'quantity_rating_corr': -0.8703882797784892}, {'product_id': 156, 'product_name': 'Humidifier', 'quantity_rating_corr': None}, {'product_id': 157, 'product_name': 'Fan', 'quantity_rating_corr': 1.0}, {'product_id': 158, 'product_name': 'Heater', 'quantity_rating_corr': -1.0}, {'product_id': 159, 'product_name': 'Extension Cord', 'quantity_rating_corr': 1.0}, {'product_id': 161, 'product_name': 'Battery Pack', 'quantity_rating_corr': None}, {'product_id': 162, 'product_name': 'Solar Panel', 'quantity_rating_corr': None}, {'product_id': 164, 'product_name': 'Lantern', 'quantity_rating_corr': None}, {'product_id': 169, 'product_name': 'Pliers', 'quantity_rating_corr': None}, {'product_id': 170, 'product_name': 'Toolbox', 'quantity_rating_corr': 1.0}, {'product_id': 171, 'product_name': 'Work Gloves', 'quantity_rating_corr': None}, {'product_id': 173, 'product_name': 'Ear Protection', 'quantity_rating_corr': -1.0}, {'product_id': 174, 'product_name': 'Respirator', 'quantity_rating_corr': None}, {'product_id': 176, 'product_name': 'Paint Roller', 'quantity_rating_corr': 0.05616559563017302}, {'product_id': 177, 'product_name': 'Paintbrush', 'quantity_rating_corr': None}, {'product_id': 178, 'product_name': 'Sandpaper', 'quantity_rating_corr': -0.7857142857142858}, {'product_id': 179, 'product_name': 'Wood Glue', 'quantity_rating_corr': -1.0}, {'product_id': 180, 'product_name': 'Nails', 'quantity_rating_corr': 1.0}, {'product_id': 182, 'product_name': 'Anchors', 'quantity_rating_corr': None}, {'product_id': 183, 'product_name': 'Hinges', 'quantity_rating_corr': None}, {'product_id': 185, 'product_name': 'Product 185', 'quantity_rating_corr': None}, {'product_id': 186, 'product_name': 'Product 186', 'quantity_rating_corr': -0.5000000000000001}, {'product_id': 187, 'product_name': 'Product 187', 'quantity_rating_corr': -0.6557632539969138}, {'product_id': 188, 'product_name': 'Product 188', 'quantity_rating_corr': 0.17407765595569788}, {'product_id': 190, 'product_name': 'Product 190', 'quantity_rating_corr': None}, {'product_id': 191, 'product_name': 'Product 191', 'quantity_rating_corr': 1.0}, {'product_id': 192, 'product_name': 'Product 192', 'quantity_rating_corr': None}, {'product_id': 193, 'product_name': 'Product 193', 'quantity_rating_corr': None}, {'product_id': 194, 'product_name': 'Product 194', 'quantity_rating_corr': -0.9041944301794652}, {'product_id': 196, 'product_name': 'Product 196', 'quantity_rating_corr': -0.1147078669352809}, {'product_id': 197, 'product_name': 'Product 197', 'quantity_rating_corr': None}, {'product_id': 199, 'product_name': 'Product 199', 'quantity_rating_corr': None}, {'product_id': 200, 'product_name': 'Product 200', 'quantity_rating_corr': None}]",,HARD
"Determine the lifetime revenue generated per user, ranking users by revenue using a window ranking function, counting only orders with at least one shipped shipment.","WITH shipped_orders AS (
    SELECT DISTINCT o.order_id
    FROM orders o
    JOIN shipments s ON s.shipment_order_id = o.order_id
    WHERE s.shipment_status = 'delivered'
),
user_revenue AS (
    SELECT 
        u.user_id,
        u.user_name,
        SUM(o.order_total) AS revenue
    FROM users u
    JOIN orders o ON o.order_user_id = u.user_id
    WHERE o.order_id IN (SELECT order_id FROM shipped_orders)
    GROUP BY u.user_id, u.user_name
)
SELECT
    user_id,
    user_name,
    revenue,
    RANK() OVER (ORDER BY revenue DESC) AS revenue_rank
FROM user_revenue
ORDER BY revenue_rank;","[{'user_id': 81, 'user_name': 'Jennifer Morales', 'revenue': Decimal('6661.55'), 'revenue_rank': 1}, {'user_id': 13, 'user_name': 'Melissa Nelson', 'revenue': Decimal('6080.96'), 'revenue_rank': 2}, {'user_id': 37, 'user_name': 'Lisa Kim', 'revenue': Decimal('5444.26'), 'revenue_rank': 3}, {'user_id': 46, 'user_name': 'Brenda Diaz', 'revenue': Decimal('4597.60'), 'revenue_rank': 4}, {'user_id': 21, 'user_name': 'Richard Scott', 'revenue': Decimal('4467.11'), 'revenue_rank': 5}, {'user_id': 38, 'user_name': 'Rebecca Lopez', 'revenue': Decimal('3856.56'), 'revenue_rank': 6}, {'user_id': 57, 'user_name': 'Mark Sanchez', 'revenue': Decimal('3225.11'), 'revenue_rank': 7}, {'user_id': 50, 'user_name': 'Stephanie Lopez', 'revenue': Decimal('3212.18'), 'revenue_rank': 8}, {'user_id': 82, 'user_name': 'Edward Diaz', 'revenue': Decimal('3078.48'), 'revenue_rank': 9}, {'user_id': 3, 'user_name': 'Ashley Green', 'revenue': Decimal('3066.51'), 'revenue_rank': 10}, {'user_id': 66, 'user_name': 'Timothy Wood', 'revenue': Decimal('2691.05'), 'revenue_rank': 11}, {'user_id': 36, 'user_name': 'Michael Cooper', 'revenue': Decimal('2646.22'), 'revenue_rank': 12}, {'user_id': 72, 'user_name': 'Michelle Nelson', 'revenue': Decimal('2583.90'), 'revenue_rank': 13}, {'user_id': 77, 'user_name': 'Christine James', 'revenue': Decimal('2551.13'), 'revenue_rank': 14}, {'user_id': 22, 'user_name': 'Frank Martin', 'revenue': Decimal('2515.52'), 'revenue_rank': 15}, {'user_id': 40, 'user_name': 'Sandra Garcia', 'revenue': Decimal('2426.65'), 'revenue_rank': 16}, {'user_id': 78, 'user_name': 'William Reed', 'revenue': Decimal('2381.25'), 'revenue_rank': 17}, {'user_id': 6, 'user_name': 'Heather Murphy', 'revenue': Decimal('2204.57'), 'revenue_rank': 18}, {'user_id': 76, 'user_name': 'Emma Howard', 'revenue': Decimal('2152.87'), 'revenue_rank': 19}, {'user_id': 89, 'user_name': 'Rebecca Moore', 'revenue': Decimal('2146.45'), 'revenue_rank': 20}, {'user_id': 30, 'user_name': 'Amanda Morales', 'revenue': Decimal('2141.65'), 'revenue_rank': 21}, {'user_id': 35, 'user_name': 'Carolyn Adams', 'revenue': Decimal('2064.48'), 'revenue_rank': 22}, {'user_id': 79, 'user_name': 'Mark Evans', 'revenue': Decimal('2027.83'), 'revenue_rank': 23}, {'user_id': 69, 'user_name': 'Gary Kim', 'revenue': Decimal('2022.68'), 'revenue_rank': 24}, {'user_id': 48, 'user_name': 'Elizabeth Richardson', 'revenue': Decimal('1943.64'), 'revenue_rank': 25}, {'user_id': 45, 'user_name': 'Brian Martinez', 'revenue': Decimal('1876.24'), 'revenue_rank': 26}, {'user_id': 8, 'user_name': 'Anthony Foster', 'revenue': Decimal('1862.46'), 'revenue_rank': 27}, {'user_id': 63, 'user_name': 'Jeffrey Davis', 'revenue': Decimal('1853.81'), 'revenue_rank': 28}, {'user_id': 64, 'user_name': 'Samuel Peterson', 'revenue': Decimal('1785.15'), 'revenue_rank': 29}, {'user_id': 67, 'user_name': 'Sandra Harris', 'revenue': Decimal('1768.59'), 'revenue_rank': 30}, {'user_id': 56, 'user_name': 'Jacob Brown', 'revenue': Decimal('1668.85'), 'revenue_rank': 31}, {'user_id': 18, 'user_name': 'Karen Hernandez', 'revenue': Decimal('1647.01'), 'revenue_rank': 32}, {'user_id': 19, 'user_name': 'Andrew Torres', 'revenue': Decimal('1645.28'), 'revenue_rank': 33}, {'user_id': 88, 'user_name': 'Emily Sanders', 'revenue': Decimal('1644.35'), 'revenue_rank': 34}, {'user_id': 25, 'user_name': 'Emily Robinson', 'revenue': Decimal('1519.50'), 'revenue_rank': 35}, {'user_id': 68, 'user_name': 'Larry Stewart', 'revenue': Decimal('1407.55'), 'revenue_rank': 36}, {'user_id': 44, 'user_name': 'Lisa Robinson', 'revenue': Decimal('1159.91'), 'revenue_rank': 37}, {'user_id': 60, 'user_name': 'Thomas Kelly', 'revenue': Decimal('1104.43'), 'revenue_rank': 38}, {'user_id': 47, 'user_name': 'Margaret Clark', 'revenue': Decimal('1104.12'), 'revenue_rank': 39}, {'user_id': 26, 'user_name': 'Nicole Anderson', 'revenue': Decimal('1021.05'), 'revenue_rank': 40}, {'user_id': 73, 'user_name': 'Richard Reed', 'revenue': Decimal('1002.37'), 'revenue_rank': 41}, {'user_id': 65, 'user_name': 'Ronald Ross', 'revenue': Decimal('928.57'), 'revenue_rank': 42}, {'user_id': 86, 'user_name': 'Brenda King', 'revenue': Decimal('896.86'), 'revenue_rank': 43}, {'user_id': 15, 'user_name': 'Lisa Lopez', 'revenue': Decimal('879.03'), 'revenue_rank': 44}, {'user_id': 71, 'user_name': 'Kathleen Baker', 'revenue': Decimal('849.60'), 'revenue_rank': 45}, {'user_id': 4, 'user_name': 'Kenneth Castillo', 'revenue': Decimal('784.30'), 'revenue_rank': 46}, {'user_id': 42, 'user_name': 'Emma Allen', 'revenue': Decimal('699.22'), 'revenue_rank': 47}, {'user_id': 9, 'user_name': 'Andrew Reyes', 'revenue': Decimal('559.03'), 'revenue_rank': 48}, {'user_id': 33, 'user_name': 'Jonathan Chavez', 'revenue': Decimal('508.52'), 'revenue_rank': 49}, {'user_id': 84, 'user_name': 'Dorothy Richardson', 'revenue': Decimal('462.18'), 'revenue_rank': 50}, {'user_id': 5, 'user_name': 'Pamela Patel', 'revenue': Decimal('378.50'), 'revenue_rank': 51}, {'user_id': 23, 'user_name': 'Matthew Brown', 'revenue': Decimal('291.90'), 'revenue_rank': 52}, {'user_id': 10, 'user_name': 'Jeffrey Torres', 'revenue': Decimal('287.26'), 'revenue_rank': 53}, {'user_id': 85, 'user_name': 'Dennis Kim', 'revenue': Decimal('116.79'), 'revenue_rank': 54}]",,EXTRA
Identify all products whose current price is above the average discounted price they had during any active discount period (computing discounted price inside SQL).,"WITH discounted_prices AS (
    SELECT
        p.product_id,
        p.product_price * (1 - d.discount_percentage / 100.0) AS discounted_price
    FROM products p
    JOIN product_discounts pd ON pd.product_discount_product_id = p.product_id
    JOIN discounts d ON d.discount_id = pd.product_discount_discount_id
)
SELECT 
    p.product_id,
    p.product_name,
    p.product_price
FROM products p
JOIN discounted_prices dp ON dp.product_id = p.product_id
GROUP BY p.product_id, p.product_name, p.product_price
HAVING p.product_price > AVG(dp.discounted_price);","[{'product_id': 116, 'product_name': 'Wallet', 'product_price': Decimal('423.61')}, {'product_id': 87, 'product_name': 'Screwdriver Set', 'product_price': Decimal('151.99')}, {'product_id': 54, 'product_name': 'Makeup Kit', 'product_price': Decimal('127.27')}, {'product_id': 4, 'product_name': 'Headphones', 'product_price': Decimal('101.45')}, {'product_id': 181, 'product_name': 'Screws', 'product_price': Decimal('394.34')}, {'product_id': 80, 'product_name': 'Blu-ray', 'product_price': Decimal('51.97')}, {'product_id': 70, 'product_name': 'Pen Set', 'product_price': Decimal('318.31')}, {'product_id': 83, 'product_name': 'Controller', 'product_price': Decimal('41.48')}, {'product_id': 67, 'product_name': 'Leash', 'product_price': Decimal('447.15')}, {'product_id': 63, 'product_name': 'Pasta', 'product_price': Decimal('329.90')}, {'product_id': 105, 'product_name': 'Baby Monitor', 'product_price': Decimal('209.03')}, {'product_id': 35, 'product_name': 'Clock', 'product_price': Decimal('329.87')}, {'product_id': 6, 'product_name': 'Camera', 'product_price': Decimal('489.29')}, {'product_id': 86, 'product_name': 'Saw', 'product_price': Decimal('300.90')}, {'product_id': 39, 'product_name': 'Yoga Mat', 'product_price': Decimal('489.52')}, {'product_id': 101, 'product_name': 'Nightstand', 'product_price': Decimal('155.43')}, {'product_id': 89, 'product_name': 'Sleeping Bag', 'product_price': Decimal('58.21')}, {'product_id': 180, 'product_name': 'Nails', 'product_price': Decimal('308.90')}, {'product_id': 115, 'product_name': 'Backpack', 'product_price': Decimal('402.02')}, {'product_id': 50, 'product_name': 'Lipstick', 'product_price': Decimal('171.18')}, {'product_id': 167, 'product_name': 'Level', 'product_price': Decimal('425.68')}, {'product_id': 97, 'product_name': 'Desk', 'product_price': Decimal('300.23')}, {'product_id': 14, 'product_name': 'Jacket', 'product_price': Decimal('379.88')}, {'product_id': 112, 'product_name': 'Sandals', 'product_price': Decimal('329.61')}, {'product_id': 109, 'product_name': 'Earrings', 'product_price': Decimal('301.18')}, {'product_id': 158, 'product_name': 'Heater', 'product_price': Decimal('99.70')}, {'product_id': 22, 'product_name': 'Textbook', 'product_price': Decimal('395.20')}, {'product_id': 156, 'product_name': 'Humidifier', 'product_price': Decimal('367.65')}, {'product_id': 59, 'product_name': 'Wiper Blades', 'product_price': Decimal('351.97')}, {'product_id': 197, 'product_name': 'Product 197', 'product_price': Decimal('73.11')}, {'product_id': 155, 'product_name': 'Air Purifier', 'product_price': Decimal('269.25')}, {'product_id': 13, 'product_name': 'Pants', 'product_price': Decimal('472.32')}, {'product_id': 118, 'product_name': 'Smartwatch', 'product_price': Decimal('74.73')}, {'product_id': 195, 'product_name': 'Product 195', 'product_price': Decimal('62.73')}, {'product_id': 2, 'product_name': 'Phone', 'product_price': Decimal('50.36')}, {'product_id': 124, 'product_name': 'Balloons', 'product_price': Decimal('240.00')}, {'product_id': 16, 'product_name': 'Hat', 'product_price': Decimal('241.05')}, {'product_id': 75, 'product_name': 'Thermometer', 'product_price': Decimal('103.29')}, {'product_id': 128, 'product_name': 'Safety Vest', 'product_price': Decimal('412.45')}, {'product_id': 149, 'product_name': 'Monitor Arm', 'product_price': Decimal('255.97')}, {'product_id': 200, 'product_name': 'Product 200', 'product_price': Decimal('324.87')}, {'product_id': 73, 'product_name': 'Vitamins', 'product_price': Decimal('266.51')}, {'product_id': 161, 'product_name': 'Battery Pack', 'product_price': Decimal('191.89')}, {'product_id': 188, 'product_name': 'Product 188', 'product_price': Decimal('371.68')}, {'product_id': 125, 'product_name': 'Party Decorations', 'product_price': Decimal('251.09')}, {'product_id': 119, 'product_name': 'Fitness Tracker', 'product_price': Decimal('110.46')}, {'product_id': 46, 'product_name': 'Board Game', 'product_price': Decimal('451.83')}, {'product_id': 40, 'product_name': 'Dumbbell', 'product_price': Decimal('477.98')}, {'product_id': 43, 'product_name': 'Helmet', 'product_price': Decimal('464.87')}, {'product_id': 147, 'product_name': 'Mousepad', 'product_price': Decimal('63.91')}, {'product_id': 196, 'product_name': 'Product 196', 'product_price': Decimal('247.08')}, {'product_id': 15, 'product_name': 'Shoes', 'product_price': Decimal('130.22')}, {'product_id': 140, 'product_name': 'Phone Case', 'product_price': Decimal('171.91')}, {'product_id': 139, 'product_name': 'Screen Protector', 'product_price': Decimal('262.16')}, {'product_id': 79, 'product_name': 'DVD', 'product_price': Decimal('39.94')}, {'product_id': 193, 'product_name': 'Product 193', 'product_price': Decimal('67.08')}, {'product_id': 187, 'product_name': 'Product 187', 'product_price': Decimal('439.57')}, {'product_id': 164, 'product_name': 'Lantern', 'product_price': Decimal('368.56')}, {'product_id': 137, 'product_name': 'Switch', 'product_price': Decimal('34.95')}, {'product_id': 24, 'product_name': 'Comic', 'product_price': Decimal('443.77')}, {'product_id': 191, 'product_name': 'Product 191', 'product_price': Decimal('313.81')}, {'product_id': 81, 'product_name': 'Video Game', 'product_price': Decimal('93.29')}, {'product_id': 61, 'product_name': 'Tea', 'product_price': Decimal('104.78')}, {'product_id': 25, 'product_name': 'Journal', 'product_price': Decimal('356.92')}, {'product_id': 172, 'product_name': 'Safety Glasses', 'product_price': Decimal('113.94')}, {'product_id': 94, 'product_name': 'Coffee Maker', 'product_price': Decimal('424.64')}, {'product_id': 186, 'product_name': 'Product 186', 'product_price': Decimal('495.61')}, {'product_id': 49, 'product_name': 'RC Car', 'product_price': Decimal('305.93')}, {'product_id': 131, 'product_name': 'USB Cable', 'product_price': Decimal('192.38')}, {'product_id': 3, 'product_name': 'Tablet', 'product_price': Decimal('318.34')}, {'product_id': 198, 'product_name': 'Product 198', 'product_price': Decimal('51.97')}, {'product_id': 177, 'product_name': 'Paintbrush', 'product_price': Decimal('89.50')}, {'product_id': 28, 'product_name': 'Table', 'product_price': Decimal('416.36')}, {'product_id': 1, 'product_name': 'Laptop', 'product_price': Decimal('409.51')}, {'product_id': 106, 'product_name': 'Necklace', 'product_price': Decimal('398.56')}, {'product_id': 185, 'product_name': 'Product 185', 'product_price': Decimal('74.80')}, {'product_id': 27, 'product_name': 'Chair', 'product_price': Decimal('394.93')}, {'product_id': 143, 'product_name': 'Graphics Card', 'product_price': Decimal('76.99')}, {'product_id': 56, 'product_name': 'Car Battery', 'product_price': Decimal('497.69')}, {'product_id': 91, 'product_name': 'Backpack', 'product_price': Decimal('458.06')}]",,HARD
Can you list all products that cost more than $100?,"SELECT product_id,
       product_name,
       product_price
FROM products
WHERE product_price > 100.00;",,,EASY
Show me all orders that are currently marked as pending.,"SELECT order_id,
       order_user_id,
       order_total,
       order_created_at
FROM orders
WHERE order_status = 'pending';",,,EASY
"Which coupons were valid on December 1st, 2024?","SELECT coupon_id,
       coupon_code,
       coupon_discount_percentage
FROM coupons
WHERE '2024-12-01' BETWEEN coupon_start_date AND coupon_end_date;",,,EASY
Which shipments are still in the preparing status?,"SELECT shipment_id,
       shipment_order_id,
       shipment_created_at
FROM shipments
WHERE shipment_status = 'preparing';",,,EASY
I want to see all products created before 2023can you list them?,"SELECT product_id,
       product_name,
       product_created_at
FROM products
WHERE product_created_at < '2023-01-01';",,,EASY
"Which vendors signed up after June 1st, 2024?","SELECT vendor_id,
       vendor_name,
       vendor_created_at
FROM vendors
WHERE vendor_created_at > '2024-06-01';",,,EASY
Show every review that has a rating of 3 or below.,"SELECT review_id,
       review_product_id,
       review_user_id,
       review_rating,
       review_created_at
FROM reviews
WHERE review_rating <= 3;",,,EASY
"Which discounts end before January 1st, 2025?","SELECT discount_id,
       discount_name,
       discount_end_date
FROM discounts
WHERE discount_end_date < '2025-01-01';",,,EASY
"For each product, can you show how many reviews it has and the average rating, sorted by the rating from highest to lowest?","SELECT p.product_id,
       p.product_name,
       COUNT(r.review_id) AS review_count,
       AVG(r.review_rating) AS avg_rating
FROM products p
LEFT JOIN reviews r
  ON r.review_product_id = p.product_id
GROUP BY p.product_id, p.product_name
ORDER BY avg_rating DESC NULLS LAST;",,,MEDIUM
What are the top 5 most-ordered products by total quantity sold?,"SELECT p.product_id,
       p.product_name,
       SUM(oi.order_item_quantity) AS total_ordered
FROM products p
JOIN order_items oi
  ON oi.order_item_product_id = p.product_id
GROUP BY p.product_id, p.product_name
ORDER BY total_ordered DESC
LIMIT 5;",,,MEDIUM
Which vendors supply products that appear in more than three different categories?,"SELECT v.vendor_id,
       v.vendor_name,
       COUNT(DISTINCT cp.category_product_category_id) AS category_count
FROM vendors v
JOIN product_vendors pv
  ON pv.product_vendor_vendor_id = v.vendor_id
JOIN category_products cp
  ON cp.category_product_product_id = pv.product_vendor_product_id
GROUP BY v.vendor_id, v.vendor_name
HAVING COUNT(DISTINCT cp.category_product_category_id) > 3;",,,MEDIUM
"Which users spent over $1,000 total in 2024?","SELECT u.user_id,
       u.user_name,
       SUM(o.order_total) AS total_spent_2024
FROM users u
JOIN orders o
  ON o.order_user_id = u.user_id
WHERE o.order_created_at >= '2024-01-01'
  AND o.order_created_at < '2025-01-01'
GROUP BY u.user_id, u.user_name
HAVING SUM(o.order_total) > 1000.00
ORDER BY total_spent_2024 DESC;",,,MEDIUM
"For each category, show how many products it contains and what the average price is, but only if it has at least 10 products.","SELECT c.category_id,
       c.category_name,
       COUNT(cp.category_product_product_id) AS product_count,
       AVG(p.product_price) AS avg_price
FROM categories c
JOIN category_products cp
  ON cp.category_product_category_id = c.category_id
JOIN products p
  ON p.product_id = cp.category_product_product_id
GROUP BY c.category_id, c.category_name
HAVING COUNT(cp.category_product_product_id) >= 10;",,,MEDIUM
"What are the 10 most recent reviews, including product names?","SELECT r.review_id,
       r.review_product_id,
       p.product_name,
       r.review_rating,
       r.review_created_at
FROM reviews r
JOIN products p
  ON p.product_id = r.review_product_id
ORDER BY r.review_created_at DESC
LIMIT 10;",,,MEDIUM
"For each product, show how many different vendors supply it, sorted from most vendors to fewest.","SELECT p.product_id,
       p.product_name,
       COUNT(DISTINCT pv.product_vendor_vendor_id) AS vendor_count
FROM products p
LEFT JOIN product_vendors pv
  ON pv.product_vendor_product_id = p.product_id
GROUP BY p.product_id, p.product_name
ORDER BY vendor_count DESC;",,,MEDIUM
"Which orders used at least one coupon, and how many coupons were applied to each one?","SELECT o.order_id,
       o.order_user_id,
       COUNT(DISTINCT oc.order_coupon_coupon_id) AS coupon_count
FROM orders o
JOIN order_coupons oc
  ON oc.order_coupon_order_id = o.order_id
GROUP BY o.order_id, o.order_user_id
HAVING COUNT(DISTINCT oc.order_coupon_coupon_id) >= 1;",,,MEDIUM
"Which products had an active discount on November 15th, 2024, and what was the discounted price?","SELECT DISTINCT p.product_id,
       p.product_name,
       p.product_price,
       d.discount_percentage,
       (p.product_price * (1 - d.discount_percentage / 100.0))::numeric(10,2) AS discounted_price
FROM products p
JOIN product_discounts pd
  ON pd.product_discount_product_id = p.product_id
JOIN discounts d
  ON d.discount_id = pd.product_discount_discount_id
WHERE '2024-11-15' BETWEEN d.discount_start_date AND d.discount_end_date;",,,MEDIUM
"For each user, show their highest-value order and the date it was placed.","SELECT DISTINCT ON (u.user_id)
       u.user_id,
       u.user_name,
       o.order_id,
       o.order_total,
       o.order_created_at
FROM users u
JOIN orders o
  ON o.order_user_id = u.user_id
ORDER BY u.user_id, o.order_total DESC;",,,MEDIUM
Which products are priced above $200 and also have an average review rating below 5?,"SELECT p.product_id,
       p.product_name,
       p.product_price,
       AVG(r.review_rating) AS avg_rating
FROM products p
JOIN reviews r
  ON r.review_product_id = p.product_id
GROUP BY p.product_id, p.product_name, p.product_price
HAVING AVG(r.review_rating) < 5
   AND p.product_price > 200.00;",,,HARD
Which vendors generated the most revenue from the products they supply? Show the top 5.,"SELECT v.vendor_id,
       v.vendor_name,
       SUM(oi.order_item_price * oi.order_item_quantity) AS vendor_revenue
FROM vendors v
JOIN product_vendors pv
  ON pv.product_vendor_vendor_id = v.vendor_id
JOIN order_items oi
  ON oi.order_item_product_id = pv.product_vendor_product_id
GROUP BY v.vendor_id, v.vendor_name
ORDER BY vendor_revenue DESC
LIMIT 5;",,,HARD
Which products had their average review rating increase by at least 2 points when comparing pre-2024 reviews with 2024 reviews?,"WITH before_after AS (
    SELECT
        r.review_product_id,
        CASE WHEN r.review_created_at < '2024-01-01' THEN 'before' ELSE 'after' END AS period,
        AVG(r.review_rating) AS avg_rating
    FROM reviews r
    WHERE r.review_created_at < '2025-01-01'
    GROUP BY r.review_product_id, period
)
SELECT p.product_id,
       p.product_name,
       ba_before.avg_rating AS avg_before,
       ba_after.avg_rating AS avg_after,
       (ba_after.avg_rating - ba_before.avg_rating) AS rating_diff
FROM (
    SELECT review_product_id,
           MAX(CASE WHEN period = 'before' THEN avg_rating END) AS avg_rating,
           period
    FROM before_after
    GROUP BY review_product_id, period
) ba
JOIN (
    SELECT review_product_id,
           MAX(CASE WHEN period = 'before' THEN avg_rating END) AS avg_rating
    FROM before_after
    GROUP BY review_product_id
) ba_before ON ba_before.review_product_id = ba.review_product_id
JOIN (
    SELECT review_product_id,
           MAX(CASE WHEN period = 'before' THEN avg_rating END) AS avg_before,
           MAX(CASE WHEN period = 'after' THEN avg_rating END) AS avg_after
    FROM before_after
    GROUP BY review_product_id
) ba_pair ON ba_pair.review_product_id = ba.review_product_id
JOIN products p ON p.product_id = ba_pair.review_product_id
WHERE ba_pair.avg_before IS NOT NULL
  AND ba_pair.avg_after IS NOT NULL
  AND (ba_pair.avg_after - ba_pair.avg_before) >= 2.0;",,,HARD
"For each user, list how many distinct products they ordered and how many they wishlisted. Only include users for whom both numbers are available.","WITH user_orders AS (
    SELECT o.order_user_id AS user_id,
           COUNT(DISTINCT oi.order_item_product_id) AS distinct_ordered
    FROM orders o
    JOIN order_items oi ON oi.order_item_order_id = o.order_id
    GROUP BY o.order_user_id
),
user_wishlist AS (
    SELECT w.wishlist_user_id AS user_id,
           COUNT(DISTINCT wi.wishlist_item_product_id) AS distinct_wishlisted
    FROM wishlist w
    JOIN wishlist_items wi ON wi.wishlist_item_wishlist_id = w.wishlist_id
    GROUP BY w.wishlist_user_id
)
SELECT u.user_id,
       u.user_name,
       COALESCE(uo.distinct_ordered,0) AS distinct_ordered,
       COALESCE(uw.distinct_wishlisted,0) AS distinct_wishlisted
FROM users u
LEFT JOIN user_orders uo ON uo.user_id = u.user_id
LEFT JOIN user_wishlist uw ON uw.user_id = u.user_id
WHERE COALESCE(uo.distinct_ordered,0) > 0
  AND COALESCE(uw.distinct_wishlisted,0) > 0;",,,HARD
Which products fall within the top 10% of pricing in their category?,"WITH cat_stats AS (
    SELECT
        p.product_id,
        p.product_name,
        cp.category_product_category_id AS category_id,
        p.product_price,
        percentile_cont(0.9) WITHIN GROUP (ORDER BY p.product_price)
            OVER (PARTITION BY cp.category_product_category_id) AS p90
    FROM products p
    JOIN category_products cp ON cp.category_product_product_id = p.product_id
)
SELECT product_id,
       product_name,
       category_id,
       product_price
FROM cat_stats
WHERE product_price >= p90;",,,HARD
"For the last 3 months, show the month-over-month change in quantity sold for every product.","WITH monthly AS (
    SELECT
        oi.order_item_product_id AS product_id,
        date_trunc('month', o.order_created_at) AS month,
        SUM(oi.order_item_quantity) AS total_qty
    FROM order_items oi
    JOIN orders o ON o.order_id = oi.order_item_order_id
    GROUP BY oi.order_item_product_id, date_trunc('month', o.order_created_at)
),
ranked AS (
    SELECT product_id,
           month,
           total_qty,
           LAG(total_qty) OVER (PARTITION BY product_id ORDER BY month) AS prev_month_qty
    FROM monthly
)
SELECT product_id,
       month,
       total_qty,
       prev_month_qty,
       (total_qty - COALESCE(prev_month_qty,0)) AS qty_change
FROM ranked
ORDER BY product_id, month DESC
LIMIT 100;",,,HARD
Which users have delivery times in the top 5% when looking at their average shipment duration?,"WITH user_durations AS (
    SELECT o.order_user_id AS user_id,
           AVG(EXTRACT(EPOCH FROM (s.shipment_updated_at - s.shipment_created_at))) AS avg_seconds
    FROM shipments s
    JOIN orders o ON o.order_id = s.shipment_order_id
    WHERE s.shipment_status = 'delivered'
    GROUP BY o.order_user_id
),
threshold AS (
    SELECT percentile_cont(0.95) WITHIN GROUP (ORDER BY avg_seconds) AS p95
    FROM user_durations
)
SELECT u.user_id,
       u.user_name,
       ud.avg_seconds
FROM user_durations ud
JOIN threshold t ON ud.avg_seconds >= t.p95
JOIN users u ON u.user_id = ud.user_id;",,,HARD
Rank users by the total revenue generated from their delivered orders.,"WITH user_durations AS (
    SELECT o.order_user_id AS user_id,
           AVG(EXTRACT(EPOCH FROM (s.shipment_updated_at - s.shipment_created_at))) AS avg_seconds
    FROM shipments s
    JOIN orders o ON o.order_id = s.shipment_order_id
    WHERE s.shipment_status = 'delivered'
    GROUP BY o.order_user_id
),
threshold AS (
    SELECT percentile_cont(0.95) WITHIN GROUP (ORDER BY avg_seconds) AS p95
    FROM user_durations
)
SELECT u.user_id,
       u.user_name,
       ud.avg_seconds
FROM user_durations ud
JOIN threshold t ON ud.avg_seconds >= t.p95
JOIN users u ON u.user_id = ud.user_id;",,,HARD
Which products are currently priced higher than their historical average discounted price?,"WITH discounted AS (
    SELECT p.product_id,
           (p.product_price * (1 - d.discount_percentage / 100.0)) AS discounted_price
    FROM products p
    JOIN product_discounts pd ON pd.product_discount_product_id = p.product_id
    JOIN discounts d ON d.discount_id = pd.product_discount_discount_id
)
SELECT p.product_id,
       p.product_name,
       p.product_price,
       AVG(d.discounted_price) AS avg_historical_discounted_price
FROM products p
JOIN discounted d ON d.product_id = p.product_id
GROUP BY p.product_id, p.product_name, p.product_price
HAVING p.product_price > AVG(d.discounted_price);",,,HARD
"Using a recursive CTE, list each product and how many categories it is associated with.","WITH RECURSIVE prod_cat AS (
    SELECT cp.category_product_product_id AS product_id,
           cp.category_product_category_id AS category_id
    FROM category_products cp
  UNION
    SELECT pc.product_id,
           cp.category_product_category_id
    FROM prod_cat pc
    JOIN category_products cp
      ON cp.category_product_product_id = pc.product_id
)
SELECT product_id,
       COUNT(DISTINCT category_id) AS distinct_category_count
FROM prod_cat
GROUP BY product_id;",,,HARD
What is the correlation between the quantity ordered and the rating received for customers who reviewed the same products they bought?,"SELECT p.product_id,
       p.product_name,
       corr(oi.order_item_quantity, r.review_rating) AS qty_rating_corr
FROM products p
JOIN order_items oi
  ON oi.order_item_product_id = p.product_id
JOIN orders o
  ON o.order_id = oi.order_item_order_id
JOIN reviews r
  ON r.review_product_id = p.product_id
 AND r.review_user_id = o.order_user_id
GROUP BY p.product_id, p.product_name;",,,EXTRA
Which orders have a mismatch between the stored order_total and the total price calculated from the items?,"SELECT o.order_id,
       o.order_total AS recorded_total,
       SUM(oi.order_item_price * oi.order_item_quantity) AS computed_total
FROM orders o
JOIN order_items oi
  ON oi.order_item_order_id = o.order_id
GROUP BY o.order_id, o.order_total
HAVING SUM(oi.order_item_price * oi.order_item_quantity) <> o.order_total;",,,EXTRA
Which users have at least one completed payment and also at least one failed transaction?,"SELECT u.user_id,
       u.user_name
FROM users u
WHERE EXISTS (
    SELECT 1
    FROM orders o
    JOIN payments p ON p.payment_order_id = o.order_id
    WHERE o.order_user_id = u.user_id
      AND p.payment_status = 'completed'
)
AND EXISTS (
    SELECT 1
    FROM orders o2
    JOIN transactions t ON t.transaction_order_id = o2.order_id
    WHERE o2.order_user_id = u.user_id
      AND t.transaction_status = 'failed'
);",,,EXTRA
"For each order, show the most expensive item using a LATERAL join.","SELECT o.order_id,
       o.order_user_id,
       hi.product_id,
       hi.product_name,
       hi.max_price
FROM orders o
CROSS JOIN LATERAL (
    SELECT oi.order_item_product_id AS product_id,
           p.product_name,
           oi.order_item_price AS max_price
    FROM order_items oi
    JOIN products p ON p.product_id = oi.order_item_product_id
    WHERE oi.order_item_order_id = o.order_id
    ORDER BY oi.order_item_price DESC
    LIMIT 1
) hi;",,,EXTRA
"Which products have never been ordered but appear in at least one wishlist, and how many wishlists include each one?","SELECT p.product_id,
       p.product_name,
       COUNT(DISTINCT wi.wishlist_item_wishlist_id) AS wishlist_count
FROM products p
LEFT JOIN order_items oi
  ON oi.order_item_product_id = p.product_id
JOIN wishlist_items wi
  ON wi.wishlist_item_product_id = p.product_id
WHERE oi.order_item_id IS NULL
GROUP BY p.product_id, p.product_name;",,,EXTRA
"For each vendor, what is the median order item price across all the products they supply?","SELECT v.vendor_id,
       v.vendor_name,
       percentile_cont(0.5) WITHIN GROUP (ORDER BY oi.order_item_price) AS median_price
FROM vendors v
JOIN product_vendors pv
  ON pv.product_vendor_vendor_id = v.vendor_id
JOIN order_items oi
  ON oi.order_item_product_id = pv.product_vendor_product_id
GROUP BY v.vendor_id, v.vendor_name;",,,EXTRA
"Over the last six months, which categories had any month where revenue exceeded $10,000?","WITH recent_orders AS (
    SELECT oi.*
    FROM order_items oi
    JOIN orders o ON o.order_id = oi.order_item_order_id
    WHERE o.order_created_at >= (date_trunc('month', CURRENT_DATE) - INTERVAL '6 months')
),
product_category AS (
    SELECT cp.category_product_product_id AS product_id,
           cp.category_product_category_id AS category_id
    FROM category_products cp
),
monthly_rev AS (
    SELECT pc.category_id,
           date_trunc('month', o.order_created_at) AS month,
           SUM(oi.order_item_price * oi.order_item_quantity) AS revenue
    FROM recent_orders oi
    JOIN orders o ON o.order_id = oi.order_item_order_id
    JOIN product_category pc ON pc.product_id = oi.order_item_product_id
    GROUP BY pc.category_id, date_trunc('month', o.order_created_at)
)
SELECT mr.category_id,
       mr.month,
       mr.revenue
FROM monthly_rev mr
WHERE mr.revenue > 10000.00;",,,EXTRA
Which users reviewed a product and later returned that same product?,"SELECT DISTINCT u.user_id,
       u.user_name,
       r.review_id,
       r.review_created_at AS review_date,
       rt.return_id,
       rt.return_created_at AS return_date
FROM reviews r
JOIN orders o
  ON o.order_user_id = r.review_user_id
JOIN order_items oi
  ON oi.order_item_order_id = o.order_id
 AND oi.order_item_product_id = r.review_product_id
JOIN returns rt
  ON rt.return_order_id = o.order_id
JOIN users u
  ON u.user_id = r.review_user_id;",,,EXTRA
Which products have had two or more overlapping discounts at any time?,"SELECT DISTINCT p.product_id,
       p.product_name
FROM products p
JOIN product_discounts pd1 ON pd1.product_discount_product_id = p.product_id
JOIN discounts d1 ON d1.discount_id = pd1.product_discount_discount_id
JOIN product_discounts pd2 ON pd2.product_discount_product_id = p.product_id
JOIN discounts d2 ON d2.discount_id = pd2.product_discount_discount_id
WHERE d1.discount_id <> d2.discount_id
  AND d1.discount_start_date <= d2.discount_end_date
  AND d2.discount_start_date <= d1.discount_end_date;",,,EXTRA
"Which pairs of users have wishlisted at least one of the same products, and how many products do they have in common?","WITH user_sets AS (
    SELECT w.wishlist_user_id AS user_id,
           ARRAY_AGG(DISTINCT wi.wishlist_item_product_id ORDER BY wi.wishlist_item_product_id) AS product_array
    FROM wishlist w
    JOIN wishlist_items wi ON wi.wishlist_item_wishlist_id = w.wishlist_id
    GROUP BY w.wishlist_user_id
)
SELECT u1.user_id AS user_a,
       u2.user_id AS user_b,
       CARDINALITY(ARRAY(
           SELECT UNNEST(u1.product_array)
           INTERSECT
           SELECT UNNEST(u2.product_array)
       )) AS shared_count
FROM user_sets u1
JOIN user_sets u2 ON u1.user_id < u2.user_id
WHERE CARDINALITY(ARRAY(
           SELECT UNNEST(u1.product_array)
           INTERSECT
           SELECT UNNEST(u2.product_array)
       )) > 0;",,,EXTRA
Which products cost more than $50?,"SELECT product_id, product_name, product_price
FROM products
WHERE product_price > 50;",,,EASY
"Which products were created after January 1, 2024?","SELECT product_id, product_name, product_created_at
FROM products
WHERE product_created_at > '2024-01-01';",,,EASY
Show all vendors created before 2023.,"SELECT vendor_id, vendor_name, vendor_created_at
FROM vendors
WHERE vendor_created_at < '2023-01-01';",,,EASY
Which products have a price equal to $19.99?,"SELECT product_id, product_name
FROM products
WHERE product_price = 19.99;",,,EASY
List all reviews with a rating of 9 or higher.,"SELECT review_id, review_product_id, review_rating
FROM reviews
WHERE review_rating >= 9;",,,EASY
"Which coupons expire after June 1, 2024?","SELECT coupon_id, coupon_code, coupon_end_date
FROM coupons
WHERE coupon_end_date > '2024-06-01';",,,EASY
Show all orders with a total over $100.,"SELECT order_id, order_total
FROM orders
WHERE order_total > 100;",,,EASY
Which discounts have a percentage of at least 20%?,"SELECT discount_id, discount_name, discount_percentage
FROM discounts
WHERE discount_percentage >= 20;",,,EASY
List all shipments marked as 'in_transit'.,"SELECT shipment_id, shipment_order_id
FROM shipments
WHERE shipment_status = 'in_transit';",,,EASY
"Which products were updated before July 1, 2023?","SELECT product_id, product_name
FROM products
WHERE product_updated_at < '2023-07-01';",,,EASY
Which orders are currently marked as 'pending'?,"SELECT order_id, order_total
FROM orders
WHERE order_status = 'pending';",,,EASY
Find all payments that failed.,"SELECT payment_id, payment_order_id
FROM payments
WHERE payment_status = 'failed';",,,EASY
ist all transactions marked as completed.,"SELECT transaction_id, transaction_order_id
FROM transactions
WHERE transaction_status = 'completed';",,,EASY
Which products contain the word 'premium' in their description?,"SELECT product_id, product_name
FROM products
WHERE product_description ILIKE '%premium%';",,,EASY
List all reviews created in 2024.,"SELECT review_id, review_product_id
FROM reviews
WHERE review_created_at >= '2024-01-01'
  AND review_created_at < '2025-01-01';",,,EASY
Show all products priced under $10.,"SELECT product_id, product_name, product_price
FROM products
WHERE product_price < 10;",,,EASY
List all returns currently marked as 'approved'.,"SELECT return_id, return_order_id
FROM returns
WHERE return_status = 'approved';",,,EASY
Which coupons were created to start before March 2024?,"SELECT coupon_id, coupon_code
FROM coupons
WHERE coupon_start_date < '2024-03-01';",,,EASY
Show all payments made with Apple Pay.,"SELECT payment_id, payment_order_id
FROM payments
WHERE payment_method = 'apple_pay';",,,EASY
List all tags whose name starts with 'eco'.,"SELECT tag_id, tag_name
FROM tags
WHERE tag_name ILIKE 'eco%';",,,EASY
Show all cart items priced above $20.,"SELECT cart_item_id, cart_item_cart_id, cart_item_price
FROM cart_items
WHERE cart_item_price > 20;",,,EASY
Which products have at least one review with a rating below 5?,"SELECT DISTINCT p.product_id, p.product_name
FROM products p
JOIN reviews r ON r.review_product_id = p.product_id
WHERE r.review_rating < 5;",,,MEDIUM
Show all vendors that supply at least one product priced over $100.,"SELECT DISTINCT v.vendor_id, v.vendor_name
FROM vendors v
JOIN product_vendors pv ON pv.product_vendor_vendor_id = v.vendor_id
JOIN products p ON p.product_id = pv.product_vendor_product_id
WHERE p.product_price > 100;",,,MEDIUM
List all categories along with how many products belong to each one.,"SELECT c.category_id, c.category_name, COUNT(cp.category_product_id) AS product_count
FROM categories c
LEFT JOIN category_products cp ON cp.category_product_category_id = c.category_id
GROUP BY c.category_id, c.category_name;",,,MEDIUM
Which users have added at least one product to their cart?,"SELECT DISTINCT u.user_id, u.user_name
FROM users u
JOIN cart c ON c.cart_user_id = u.user_id
JOIN cart_items ci ON ci.cart_item_cart_id = c.cart_id;",,,MEDIUM
Find all orders that include more than 3 total items across all order lines.,"SELECT o.order_id, SUM(oi.order_item_quantity) AS total_items
FROM orders o
JOIN order_items oi ON oi.order_item_order_id = o.order_id
GROUP BY o.order_id
HAVING SUM(oi.order_item_quantity) > 3;",,,MEDIUM
Show each product along with the number of times it appears in wishlists.,"SELECT p.product_id, p.product_name, COUNT(wi.wishlist_item_id) AS wishlist_count
FROM products p
LEFT JOIN wishlist_items wi ON wi.wishlist_item_product_id = p.product_id
GROUP BY p.product_id, p.product_name;",,,MEDIUM
"For each vendor, show their vendor_id and the number of distinct products they supply.","SELECT v.vendor_id, COUNT(DISTINCT pv.product_vendor_product_id) AS product_count
FROM vendors v
LEFT JOIN product_vendors pv ON pv.product_vendor_vendor_id = v.vendor_id
GROUP BY v.vendor_id;",,,MEDIUM
Which products are supplied by more than one vendor and also have an average review rating above 8?,"SELECT p.product_id, p.product_name
FROM products p
JOIN product_vendors pv ON pv.product_vendor_product_id = p.product_id
JOIN reviews r ON r.review_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING COUNT(DISTINCT pv.product_vendor_vendor_id) > 1
   AND AVG(r.review_rating) > 8;",,,EXTRA
Find all products that have been ordered more than 100 times but appear in fewer than 5 wishlists.,"SELECT p.product_id, p.product_name
FROM products p
JOIN order_items oi ON oi.order_item_product_id = p.product_id
LEFT JOIN wishlist_items wi ON wi.wishlist_item_product_id = p.product_id
GROUP BY p.product_id, p.product_name
HAVING SUM(oi.order_item_quantity) > 100
   AND COUNT(wi.wishlist_item_id) < 5;",,,EXTRA
List vendors who supply products that belong to at least 3 different categories.,"SELECT v.vendor_id, v.vendor_name
FROM vendors v
JOIN product_vendors pv ON pv.product_vendor_vendor_id = v.vendor_id
JOIN category_products cp ON cp.category_product_product_id = pv.product_vendor_product_id
GROUP BY v.vendor_id, v.vendor_name
HAVING COUNT(DISTINCT cp.category_product_category_id) >= 3;",,,EXTRA
Show all users whose shipped orders include products rated below 4.,"SELECT DISTINCT u.user_id, u.user_name
FROM users u
JOIN orders o ON o.order_user_id = u.user_id
JOIN shipments s ON s.shipment_order_id = o.order_id
JOIN order_items oi ON oi.order_item_order_id = o.order_id
JOIN reviews r ON r.review_product_id = oi.order_item_product_id
WHERE s.shipment_status = 'delivered'
  AND r.review_rating < 4;",,,EXTRA
Find all orders that used more than one coupon and also contain products from more than one vendor.,"SELECT o.order_id
FROM orders o
JOIN order_coupons oc ON oc.order_coupon_order_id = o.order_id
JOIN order_items oi ON oi.order_item_order_id = o.order_id
JOIN product_vendors pv ON pv.product_vendor_product_id = oi.order_item_product_id
GROUP BY o.order_id
HAVING COUNT(DISTINCT oc.order_coupon_id) > 1
   AND COUNT(DISTINCT pv.product_vendor_vendor_id) > 1;",,,EXTRA
List the top 5 products with the highest ratio of wishlist saves to total review count.,"SELECT p.product_id, p.product_name,
       (COUNT(wi.wishlist_item_id)::decimal / NULLIF(COUNT(DISTINCT r.review_id), 0)) AS ratio
FROM products p
LEFT JOIN wishlist_items wi ON wi.wishlist_item_product_id = p.product_id
LEFT JOIN reviews r ON r.review_product_id = p.product_id
GROUP BY p.product_id, p.product_name
ORDER BY ratio DESC NULLS LAST
LIMIT 5;",,,EXTRA
Show all users who have a completed payment but whose order is still not delivered.,"SELECT DISTINCT u.user_id, u.user_name
FROM users u
JOIN orders o ON o.order_user_id = u.user_id
JOIN payments p ON p.payment_order_id = o.order_id
LEFT JOIN shipments s ON s.shipment_order_id = o.order_id
WHERE p.payment_status = 'completed'
  AND (s.shipment_status IS NULL OR s.shipment_status != 'delivered');",,,EXTRA
Identify categories where every product has been reviewed at least once.,"SELECT c.category_id, c.category_name
FROM categories c
JOIN category_products cp ON cp.category_product_category_id = c.category_id
GROUP BY c.category_id, c.category_name
HAVING COUNT(cp.category_product_id) =
(
    SELECT COUNT(*)
    FROM category_products cp2
    JOIN reviews r ON r.review_product_id = cp2.category_product_product_id
    WHERE cp2.category_product_category_id = c.category_id
);",,,EXTRA
Which users have both returned an order and also placed an order that used at least one coupon?,"SELECT DISTINCT u.user_id, u.user_name
FROM users u
WHERE EXISTS (
    SELECT 1 FROM returns r WHERE r.return_user_id = u.user_id
)
AND EXISTS (
    SELECT 1
    FROM orders o
    JOIN order_coupons oc ON oc.order_coupon_order_id = o.order_id
    WHERE o.order_user_id = u.user_id
);",,,EXTRA
Show vendors whose supplied products have never received any rating under 7.,"SELECT v.vendor_id, v.vendor_name
FROM vendors v
WHERE NOT EXISTS (
    SELECT 1
    FROM product_vendors pv
    JOIN reviews r ON r.review_product_id = pv.product_vendor_product_id
    WHERE pv.product_vendor_vendor_id = v.vendor_id
      AND r.review_rating < 7
);",,,EXTRA
Show the average order total for users who have at least two completed payments.,"SELECT u.user_id, u.user_name, AVG(o.order_total) AS avg_order_total
FROM users u
JOIN orders o ON o.order_user_id = u.user_id
WHERE u.user_id IN (
    SELECT p.payment_order_id
    FROM payments p
    WHERE p.payment_status = 'completed'
    GROUP BY p.payment_order_id
    HAVING COUNT(*) >= 2
)
GROUP BY u.user_id, u.user_name;",,,EXTRA
List categories that include products that were ordered but never reviewed.,"SELECT DISTINCT c.category_id, c.category_name
FROM categories c
JOIN category_products cp ON cp.category_product_category_id = c.category_id
JOIN order_items oi ON oi.order_item_product_id = cp.category_product_product_id
WHERE NOT EXISTS (
    SELECT 1 FROM reviews r WHERE r.review_product_id = cp.category_product_product_id
);",,,EXTRA
Identify vendors that supply products currently under an active discount.,"SELECT DISTINCT v.vendor_id, v.vendor_name
FROM vendors v
JOIN product_vendors pv ON pv.product_vendor_vendor_id = v.vendor_id
JOIN product_discounts pd ON pd.product_discount_product_id = pv.product_vendor_product_id
JOIN discounts d ON d.discount_id = pd.product_discount_discount_id
WHERE NOW() BETWEEN d.discount_start_date AND d.discount_end_date;",,,EXTRA
List users whose carts contain products from more than 3 different categories.,"SELECT DISTINCT u.user_id, u.user_name
FROM users u
JOIN cart c ON c.cart_user_id = u.user_id
JOIN cart_items ci ON ci.cart_item_cart_id = c.cart_id
JOIN category_products cp ON cp.category_product_product_id = ci.cart_item_product_id
GROUP BY u.user_id, u.user_name, c.cart_id
HAVING COUNT(DISTINCT cp.category_product_category_id) > 3;",,,EXTRA
Find orders that used coupons but still have a payment status of failed.,"SELECT DISTINCT o.order_id
FROM orders o
JOIN order_coupons oc ON oc.order_coupon_order_id = o.order_id
JOIN payments p ON p.payment_order_id = o.order_id
WHERE p.payment_status = 'failed';",,,EXTRA
Show shipments delivered to users who have at least 3 saved wishlist items.,"SELECT s.shipment_id, s.shipment_order_id
FROM shipments s
JOIN orders o ON o.order_id = s.shipment_order_id
JOIN users u ON u.user_id = o.order_user_id
WHERE s.shipment_status = 'delivered'
  AND (
      SELECT COUNT(*)
      FROM wishlist w
      JOIN wishlist_items wi ON wi.wishlist_item_wishlist_id = w.wishlist_id
      WHERE w.wishlist_user_id = u.user_id
  ) >= 3;",,,EXTRA
List products appearing in both active carts and pending orders.,"SELECT DISTINCT p.product_id, p.product_name
FROM products p
JOIN cart_items ci ON ci.cart_item_product_id = p.product_id
JOIN cart c ON c.cart_id = ci.cart_item_cart_id AND c.cart_status = 'active'
INTERSECT
SELECT DISTINCT p.product_id, p.product_name
FROM products p
JOIN order_items oi ON oi.order_item_product_id = p.product_id
JOIN orders o ON o.order_id = oi.order_item_order_id AND o.order_status = 'pending';",,,EXTRA
Find all users who placed at least one order that includes a product they themselves reviewed.,"SELECT DISTINCT u.user_id, u.user_name
FROM users u
JOIN orders o ON o.order_user_id = u.user_id
JOIN order_items oi ON oi.order_item_order_id = o.order_id
JOIN reviews r ON r.review_product_id = oi.order_item_product_id
WHERE r.review_user_id = u.user_id;",,,EXTRA
Show vendors who supply products in categories that have never had a product added to any wishlist.,"SELECT DISTINCT v.vendor_id, v.vendor_name
FROM vendors v
JOIN product_vendors pv ON pv.product_vendor_vendor_id = v.vendor_id
JOIN category_products cp ON cp.category_product_product_id = pv.product_vendor_product_id
WHERE NOT EXISTS (
    SELECT 1
    FROM category_products cp2
    JOIN wishlist_items wi ON wi.wishlist_item_product_id = cp2.category_product_product_id
    WHERE cp2.category_product_category_id = cp.category_product_category_id
);",,,EXTRA
Identify products that have discounts applied but have never been purchased.,"SELECT DISTINCT p.product_id, p.product_name
FROM products p
JOIN product_discounts pd ON pd.product_discount_product_id = p.product_id
WHERE NOT EXISTS (
    SELECT 1 FROM order_items oi WHERE oi.order_item_product_id = p.product_id
);",,,EXTRA
List orders that contain products supplied by vendors who also have at least one product with a rating below 5.,"SELECT DISTINCT o.order_id
FROM orders o
JOIN order_items oi ON oi.order_item_order_id = o.order_id
JOIN product_vendors pv ON pv.product_vendor_product_id = oi.order_item_product_id
WHERE pv.product_vendor_vendor_id IN (
    SELECT pv2.product_vendor_vendor_id
    FROM product_vendors pv2
    JOIN reviews r ON r.review_product_id = pv2.product_vendor_product_id
    WHERE r.review_rating < 5
);",,,EXTRA
Show categories where the average price of their products exceeds the overall average product price.,"SELECT c.category_id, c.category_name
FROM categories c
JOIN category_products cp ON cp.category_product_category_id = c.category_id
JOIN products p ON p.product_id = cp.category_product_product_id
GROUP BY c.category_id, c.category_name
HAVING AVG(p.product_price) > (
    SELECT AVG(product_price) FROM products
);",,,EXTRA
Identify users whose orders include products from every vendor in the system.,"SELECT u.user_id, u.user_name
FROM users u
WHERE NOT EXISTS (
    SELECT v.vendor_id
    FROM vendors v
    WHERE v.vendor_id NOT IN (
        SELECT DISTINCT pv.product_vendor_vendor_id
        FROM orders o
        JOIN order_items oi ON oi.order_item_order_id = o.order_id
        JOIN product_vendors pv ON pv.product_vendor_product_id = oi.order_item_product_id
        WHERE o.order_user_id = u.user_id
    )
);",,,EXTRA
"Find all products that have been reviewed, purchased, tagged, and assigned to a category.","SELECT DISTINCT p.product_id, p.product_name
FROM products p
WHERE EXISTS (SELECT 1 FROM reviews r WHERE r.review_product_id = p.product_id)
  AND EXISTS (SELECT 1 FROM order_items oi WHERE oi.order_item_product_id = p.product_id)
  AND EXISTS (SELECT 1 FROM product_tags pt WHERE pt.product_tag_product_id = p.product_id)
  AND EXISTS (SELECT 1 FROM category_products cp WHERE cp.category_product_product_id = p.product_id);",,,EXTRA
